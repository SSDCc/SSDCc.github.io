(()=>{var ur={93540:(x,P,t)=>{"use strict";t.d(P,{wb:()=>a,qE:()=>ie,OI:()=>Te,EW:()=>st,v$:()=>Me,a3:()=>lt,y$:()=>wt,JO:()=>ut,Ee:()=>Oe,PJ:()=>Xe,Po:()=>Dn,_D:()=>be.createFastifyFormSchema,Yy:()=>G,_6:()=>be.fieldSchema,Yk:()=>we,YE:()=>Kn,aG:()=>be.useFastifyFormContext});var o=t(52983),l=t(80686);const a=o.memo(i=>{const{showFullText:M="More",backgroundColor:v="white"}=i,[H,oe]=(0,o.useState)(!1),[ne,_]=(0,o.useState)(!1),ge=(0,o.useRef)(null);(0,o.useEffect)(()=>{if(!ge.current)return;const rt=new window.ResizeObserver(_e=>{if(_e[0]){const{height:Tt}=_e[0].contentRect;Tt>he&&(_(!1),oe(!0),rt.disconnect())}});return rt.observe(ge.current),()=>{rt.disconnect()}},[]);const he=(0,o.useMemo)(()=>ne?"none":i.maxHeight,[ne,i.maxHeight]),ce=(0,l.Z)(()=>{oe(!1),_(!0)});return o.createElement("div",{style:{maxHeight:he,overflow:"hidden",position:"relative"}},o.createElement("div",{ref:ge},i.children),H&&o.createElement("div",{style:{position:"absolute",left:0,right:0,bottom:0,textAlign:"center",cursor:"pointer",backgroundImage:`linear-gradient(rgba(0,0,0,0), ${v})`,padding:"4px 0"},onClick:ce},M))});a.displayName="AutoFolder";var c=t(27037),C=t(68e3),y=t(95718),N=t.n(y),L=t(18445),j=t.n(L),W=t(14698),B=t.n(W),E=t(29787),S=t.n(E),O=t(3224),z=t.n(O),A=t(73352),T=t.n(A),h=t(76705),p=t.n(h),g=t(35880),Y=t.n(g);const F=["#333333","#2c3e50","#8e44ad","#2980b9","#27ae60","#16a085","#f39c12","#d35400","#c0392b","#3498db","#9b59b6","#2ecc71","#1abc9c","#f1c40f","#e74c3c","#e67e22"];function G(i){if(!i||!p()(i))return"#ffffff";const M=Y()(i);return F[M%F.length]}function U(i){return i*(1/16)+"rem"}function J(i){return typeof i=="string"&&i!==""}var k=t(81715),se=Object.defineProperty,Ie=Object.defineProperties,je=Object.getOwnPropertyDescriptors,ee=Object.getOwnPropertySymbols,De=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable,Le=(i,M,v)=>M in i?se(i,M,{enumerable:!0,configurable:!0,writable:!0,value:v}):i[M]=v,Je=(i,M)=>{for(var v in M||(M={}))De.call(M,v)&&Le(i,v,M[v]);if(ee)for(var v of ee(M))Ae.call(M,v)&&Le(i,v,M[v]);return i},Pe=(i,M)=>Ie(i,je(M));let xe=i=>i;const ye="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBddr//5/DGRjYNRkY/l7////39v///y4Dmn+LgeHANwDrkl1AuO+pmgAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAwqADAAQAAAABAAAAwwAAAAD9b/HnAAAHlklEQVR4Ae3dP3PTWBSGcbGzM6GCKqlIBRV0dHRJFarQ0eUT8LH4BnRU0NHR0UEFVdIlFRV7TzRksomPY8uykTk/zewQfKw/9znv4yvJynLv4uLiV2dBoDiBf4qP3/ARuCRABEFAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghgg0Aj8i0JO4OzsrPv69Wv+hi2qPHr0qNvf39+iI97soRIh4f3z58/u7du3SXX7Xt7Z2enevHmzfQe+oSN2apSAPj09TSrb+XKI/f379+08+A0cNRE2ANkupk+ACNPvkSPcAAEibACyXUyfABGm3yNHuAECRNgAZLuYPgEirKlHu7u7XdyytGwHAd8jjNyng4OD7vnz51dbPT8/7z58+NB9+/bt6jU/TI+AGWHEnrx48eJ/EsSmHzx40L18+fLyzxF3ZVMjEyDCiEDjMYZZS5wiPXnyZFbJaxMhQIQRGzHvWR7XCyOCXsOmiDAi1HmPMMQjDpbpEiDCiL358eNHurW/5SnWdIBbXiDCiA38/Pnzrce2YyZ4//59F3ePLNMl4PbpiL2J0L979+7yDtHDhw8vtzzvdGnEXdvUigSIsCLAWavHp/+qM0BcXMd/q25n1vF57TYBp0a3mUzilePj4+7k5KSLb6gt6ydAhPUzXnoPR0dHl79WGTNCfBnn1uvSCJdegQhLI1vvCk+fPu2ePXt2tZOYEV6/fn31dz+shwAR1sP1cqvLntbEN9MxA9xcYjsxS1jWR4AIa2Ibzx0tc44fYX/16lV6NDFLXH+YL32jwiACRBiEbf5KcXoTIsQSpzXx4N28Ja4BQoK7rgXiydbHjx/P25TaQAJEGAguWy0+2Q8PD6/Ki4R8EVl+bzBOnZY95fq9rj9zAkTI2SxdidBHqG9+skdw43borCXO/ZcJdraPWdv22uIEiLA4q7nvvCug8WTqzQveOH26fodo7g6uFe/a17W3+nFBAkRYENRdb1vkkz1CH9cPsVy/jrhr27PqMYvENYNlHAIesRiBYwRy0V+8iXP8+/fvX11Mr7L7ECueb/r48eMqm7FuI2BGWDEG8cm+7G3NEOfmdcTQw4h9/55lhm7DekRYKQPZF2ArbXTAyu4kDYB2YxUzwg0gi/41ztHnfQG26HbGel/crVrm7tNY+/1btkOEAZ2M05r4FB7r9GbAIdxaZYrHdOsgJ/wCEQY0J74TmOKnbxxT9n3FgGGWWsVdowHtjt9Nnvf7yQM2aZU/TIAIAxrw6dOnAWtZZcoEnBpNuTuObWMEiLAx1HY0ZQJEmHJ3HNvGCBBhY6jtaMoEiJB0Z29vL6ls58vxPcO8/zfrdo5qvKO+d3Fx8Wu8zf1dW4p/cPzLly/dtv9Ts/EbcvGAHhHyfBIhZ6NSiIBTo0LNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiEC/wGgKKC4YMA4TAAAAABJRU5ErkJggg==",Oe=o.memo(i=>o.createElement(k.Z,Pe(Je({fallback:ye,preview:!1,loading:"lazy"},i),{src:i.src?xe(i.src):void 0})));Oe.displayName="Image";function we(i){xe=i}var Q=Object.defineProperty,b=Object.defineProperties,V=Object.getOwnPropertyDescriptors,me=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable,K=(i,M,v)=>M in i?Q(i,M,{enumerable:!0,configurable:!0,writable:!0,value:v}):i[M]=v,$=(i,M)=>{for(var v in M||(M={}))d.call(M,v)&&K(i,v,M[v]);if(me)for(var v of me(M))R.call(M,v)&&K(i,v,M[v]);return i},q=(i,M)=>b(i,V(M)),ae=(i,M)=>{var v={};for(var H in i)d.call(i,H)&&M.indexOf(H)<0&&(v[H]=i[H]);if(i!=null&&me)for(var H of me(i))M.indexOf(H)<0&&R.call(i,H)&&(v[H]=i[H]);return v};const fe=o.memo(i=>{const M=i,{isOnline:v}=M,H=ae(M,["isOnline"]),oe=J(H.src)?xe(H.src):void 0,ne=(0,o.useMemo)(()=>j()(N()(H.name)),[H.name]),_=(0,o.useMemo)(()=>S()(oe)&&B()(H.icon)?G(H.name):void 0,[oe,H.icon,H.name]),ge=(0,o.useMemo)(()=>{const ce=q($({userSelect:"none"},H.style),{backgroundColor:_,display:"flex",justifyContent:"center",alignItems:"center"});return z()(H.size)&&(ce.width||(ce.width=U(H.size)),ce.height||(ce.height=U(H.size)),typeof ce.fontSize=="undefined"&&(ce.fontSize=U(H.size*.4))),ce},[H.style,H.size,_]),he=o.createElement(c.C,q($({draggable:!1},T()(H,["size"])),{src:oe,style:ge}),ne);if(typeof v=="boolean"){const ce={bottom:0,top:"auto"};return v===!0?o.createElement(C.Z,{dot:!0,color:"green",style:ce},he):o.createElement(C.Z,{dot:!0,color:"#999",style:ce},he)}return he});fe.displayName="Avatar";const ie=fe;ie.Group=c.C.Group;var Z=Object.defineProperty,te=Object.getOwnPropertySymbols,le=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable,Qe=(i,M,v)=>M in i?Z(i,M,{enumerable:!0,configurable:!0,writable:!0,value:v}):i[M]=v,He=(i,M)=>{for(var v in M||(M={}))le.call(M,v)&&Qe(i,v,M[v]);if(te)for(var v of te(M))Re.call(M,v)&&Qe(i,v,M[v]);return i};const Te=o.memo(i=>{const[M,v]=(0,o.useState)(!1),H=typeof i.src=="string";return o.createElement(o.Fragment,null,o.createElement("div",{style:{cursor:H?"pointer":"auto"},onClick:()=>v(!M)},o.createElement(ie,He({},i))),H&&o.createElement("div",{style:{display:"none"}},o.createElement(Oe,{preview:{visible:M,src:xe(String(i.src)),onVisibleChange:oe=>{v(oe)}}})))});Te.displayName="AvatarWithPreview";var Se=t(75283);const Me=o.memo(i=>{var M;return o.createElement(Se.Z.Text,{className:i.className,style:i.style,copyable:(M=i.config)!=null?M:!0},i.children)});Me.displayName="CopyableText";var ze=t(89022),et=t.n(ze),Ut=Object.defineProperty,ot=Object.getOwnPropertySymbols,Ft=Object.prototype.hasOwnProperty,At=Object.prototype.propertyIsEnumerable,Mt=(i,M,v)=>M in i?Ut(i,M,{enumerable:!0,configurable:!0,writable:!0,value:v}):i[M]=v,It=(i,M)=>{for(var v in M||(M={}))Ft.call(M,v)&&Mt(i,v,M[v]);if(ot)for(var v of ot(M))At.call(M,v)&&Mt(i,v,M[v]);return i};const st=o.memo(i=>{const{size:M=32,shape:v="circle"}=i,H=et()(i.items,4),oe=H.length,ne=_=>{if(oe===1)return{};if(oe===2){if(_===0)return{width:"50%",overflow:"hidden",position:"absolute",left:0};if(_===1)return{width:"50%",overflow:"hidden",position:"absolute",right:0}}if(oe===3){if(_===0)return{width:"50%",overflow:"hidden",position:"absolute",left:0};if(_===1)return{transform:"scale(50%)",transformOrigin:"100% 0 0"};if(_===2)return{transform:"scale(50%)",transformOrigin:"100% 100% 0"}}if(oe===4){if(_===0)return{transform:"scale(50%)",transformOrigin:"0 0 0"};if(_===1)return{transform:"scale(50%)",transformOrigin:"100% 0 0"};if(_===2)return{transform:"scale(50%)",transformOrigin:"0 100% 0"};if(_===3)return{transform:"scale(50%)",transformOrigin:"100% 100% 0"}}return{}};return o.createElement("div",{className:`td-combined-avatar td-combined-avatar-${oe}`,style:{width:U(M),height:U(M),borderRadius:v==="circle"?"50%":3}},H.map((_,ge)=>o.createElement(ie,It({key:ge,className:"td-combined-avatar__item",style:ne(ge),size:M},_))),H.length>=2&&o.createElement("div",{className:"line1"}),H.length>=3&&o.createElement("div",{className:"line2"}))});st.displayName="CombinedAvatar";var Rt=t(95268),at=Object.defineProperty,gt=Object.getOwnPropertySymbols,Bt=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,pe=(i,M,v)=>M in i?at(i,M,{enumerable:!0,configurable:!0,writable:!0,value:v}):i[M]=v,Ne=(i,M)=>{for(var v in M||(M={}))Bt.call(M,v)&&pe(i,v,M[v]);if(gt)for(var v of gt(M))ue.call(M,v)&&pe(i,v,M[v]);return i};const lt=o.memo(i=>o.createElement(Rt.Z,Ne({mouseEnterDelay:1},i),i.children));lt.displayName="DelayTip";const Jt={highLight:"_-packages-design-components-Highlight-index-module__highLight--esAq-"},wt=o.memo(i=>o.createElement("span",{className:Jt.highLight},i.children));wt.displayName="Highlight";var mt=t(79555),On=Object.defineProperty,Cn=Object.defineProperties,jn=Object.getOwnPropertyDescriptors,Zt=Object.getOwnPropertySymbols,Ht=Object.prototype.hasOwnProperty,Tn=Object.prototype.propertyIsEnumerable,Vt=(i,M,v)=>M in i?On(i,M,{enumerable:!0,configurable:!0,writable:!0,value:v}):i[M]=v,$t=(i,M)=>{for(var v in M||(M={}))Ht.call(M,v)&&Vt(i,v,M[v]);if(Zt)for(var v of Zt(M))Tn.call(M,v)&&Vt(i,v,M[v]);return i},Sn=(i,M)=>Cn(i,jn(M));const Ln={width:"1em",height:"1em"},ct=o.memo(i=>{const[M,v]=(0,o.useState)(!1);return o.createElement(o.Fragment,null,o.createElement(mt.JO,Sn($t({},i),{onLoad:()=>v(!0)})),!M&&o.createElement("span",{style:Ln}))});ct.displayName="Icon";const ut=ct;ut.addIcon=mt.Ug,ut.addCollection=mt.Hc;const Xe=o.memo(i=>{const{className:M,text:v}=i,[H,oe]=(0,o.useState)(!1);return o.createElement("div",{className:M,style:{display:"flex",alignItems:"center"}},H?v:Nt(v),o.createElement(ut,{style:{cursor:"pointer",marginLeft:4},icon:H?"mdi:eye-off-outline":"mdi:eye-outline",onClick:()=>oe(ne=>!ne)}))});Xe.displayName="SensitiveText";function Nt(i){const M=i.length;return M>2?`${i[0]}****${i[M-1]}`:M===2?`${i[0]}*`:"**"}const pt=o.memo(i=>{const M=(0,o.useRef)(null),v=(0,l.Z)(H=>{i.onResize&&i.onResize(H)});return(0,o.useEffect)(()=>{if(!M.current)return;const H=new ResizeObserver(oe=>{oe.forEach(ne=>{const{target:_,contentRect:ge}=ne;!_.parentElement||v({width:Math.round(ge.width),height:Math.round(ge.height)})})});return H.observe(M.current),()=>{H&&M.current&&(H.unobserve(M.current),H.disconnect())}},[]),o.createElement("div",{style:i.wrapperStyle,ref:M},i.children)});pt.displayName="ResizeWatcher";var Qt=t(7744),kt=t(37459),Xt=t(14517),zn=Object.defineProperty,_t=Object.defineProperties,qt=Object.getOwnPropertyDescriptors,en=Object.getOwnPropertySymbols,dt=Object.prototype.hasOwnProperty,xn=Object.prototype.propertyIsEnumerable,Pt=(i,M,v)=>M in i?zn(i,M,{enumerable:!0,configurable:!0,writable:!0,value:v}):i[M]=v,tn=(i,M)=>{for(var v in M||(M={}))dt.call(M,v)&&Pt(i,v,M[v]);if(en)for(var v of en(M))xn.call(M,v)&&Pt(i,v,M[v]);return i},Wt=(i,M)=>_t(i,qt(M));const tt={x:0,y:0},nn=o.forwardRef((i,M)=>{var v,H;const{scrollBehavior:oe="auto"}=i,ne=(0,o.useRef)(null),_=(0,o.useRef)(null),ge=(0,o.useMemo)(()=>{var Ge;return((Ge=i.isLock)!=null?Ge:!1)?Wt(tn({},i.style),{overflow:"hidden"}):Wt(tn({},i.style),{overflow:"auto"})},[i.isLock]),he=(0,l.Z)(()=>ne.current?{x:ne.current.scrollLeft,y:ne.current.scrollTop}:tt),ce=(0,l.Z)(()=>ne.current?{x:ne.current.clientWidth,y:ne.current.clientHeight}:tt);(0,o.useImperativeHandle)(M,()=>({scrollTo:Ge=>{var it;(it=ne.current)==null||it.scrollTo({left:Ge.x,top:Ge.y,behavior:oe})},scrollToBottom:()=>{var Ge;(Ge=ne.current)==null||Ge.scrollTo({left:he().x,top:ne.current.scrollHeight-ce().y,behavior:oe})}}));const[rt,_e]=(0,o.useState)(!1),[Tt,An]=(0,o.useState)(!1),{run:Jn}=(0,Qt.Z)(Ge=>{_e(Ge)},{leading:!1,trailing:!0,wait:300}),{run:Zn}=(0,Qt.Z)(()=>{_e(!1),i.onScrollEnd&&i.onScrollEnd(he())},{leading:!1,trailing:!0,wait:300}),Hn=(0,l.Z)(()=>{_e(!0),Jn(!1)}),Vn=(0,l.Z)(()=>{An(!0)}),In=(0,l.Z)(()=>{An(!1)}),St=(v=(0,kt.Z)(he()))!=null?v:tt,Nn=(0,l.Z)(()=>{const Ge=rt||Tt,it=he(),kn={x:it.x>St.x,y:it.y>St.y};_e(!0),Zn(),i.onScroll&&i.onScroll(it,{forward:kn,isUserScrolling:Ge,isMouseDown:Tt})}),$n=(0,l.Z)(()=>{i.onContainerResize&&i.onContainerResize({containerSize:ce(),position:he()})});return o.createElement(pt,{wrapperStyle:{height:"100%"},onResize:$n},o.createElement("div",{key:"scroller",className:(0,Xt.Z)(i.className,"scroller",{[(H=i.scrollingClassName)!=null?H:"scrolling"]:rt}),style:ge,ref:ne,onWheel:Hn,onMouseDown:Vn,onMouseUp:In,onScroll:Nn},o.createElement("div",{className:"scroller-inner",key:"scroller-inner",style:i.innerStyle,ref:_},i.children)))});nn.displayName="Scroller";var Un=t(52486),rn=Object.defineProperty,on=Object.getOwnPropertySymbols,sn=Object.prototype.hasOwnProperty,Fn=Object.prototype.propertyIsEnumerable,an=(i,M,v)=>M in i?rn(i,M,{enumerable:!0,configurable:!0,writable:!0,value:v}):i[M]=v,Ot=(i,M)=>{for(var v in M||(M={}))sn.call(M,v)&&an(i,v,M[v]);if(on)for(var v of on(M))Fn.call(M,v)&&an(i,v,M[v]);return i};const un={overflow:"hidden"},Rn={height:"100%"},Bn={height:"100%"},ln=i=>{const M=(0,o.useRef)(null),v=(0,o.useMemo)(()=>new Map,[]),H=(0,Un.Z)(),oe=(0,o.useMemo)(()=>Ot(Ot({},un),i.style),[i.style]),ne=(0,o.useMemo)(()=>Ot(Ot({},Rn),i.innerStyle),[i.innerStyle]);return(0,o.useEffect)(()=>{var _;(_=M.current)==null||_.scrollToBottom()},[]),o.createElement("div",{className:"virtual-chat-list",style:oe},o.createElement(nn,{ref:M,style:Bn,innerStyle:ne},i.items.map((_,ge)=>o.createElement("div",{key:i.getItemKey?i.getItemKey(_):ge,className:"virtual-chat-list__item",style:{height:v.get(_)}},o.createElement(pt,{onResize:he=>{v.set(_,he.height),H()}},i.itemContent(_,ge))))))},vt=o.memo(ln);vt.displayName="VirtualChatList";var be=t(80768),We=t(579),de=t(75526),bt=t(79546);function Ct(i){return i===void 0||i===""?"":"error"}const cn=o.memo(i=>{const{name:M,label:v,value:H,onChange:oe,onBlur:ne,error:_,maxLength:ge,placeholder:he}=i;return o.createElement(We.Z.Item,{label:v,validateStatus:Ct(_),help:_},o.createElement(bt.Z,{name:M,size:"large",maxLength:ge,placeholder:he,value:H,onChange:ce=>oe(ce.target.value),onBlur:ne}))});cn.displayName="FastifyFormText";const dn=o.memo(i=>{const{name:M,label:v,value:H,onChange:oe,onBlur:ne,error:_,maxLength:ge,placeholder:he}=i;return o.createElement(We.Z.Item,{label:v,validateStatus:Ct(_),help:_},o.createElement(bt.Z.TextArea,{name:M,rows:4,maxLength:ge,placeholder:he,value:H,onChange:ce=>oe(ce.target.value),onBlur:ne}))});dn.displayName="FastifyFormTextArea";const Gt=o.memo(i=>{const{name:M,label:v,value:H,onChange:oe,onBlur:ne,error:_,maxLength:ge,placeholder:he}=i;return o.createElement(We.Z.Item,{label:v,validateStatus:Ct(_),help:_},o.createElement(bt.Z.Password,{name:M,type:"password",size:"large",maxLength:ge,placeholder:he,value:H,onChange:ce=>oe(ce.target.value),onBlur:ne}))});Gt.displayName="FastifyFormPassword";var fn=t(73246),wn=t(13546),Mn=t.n(wn);const nt=fn.Z.Option,yt=o.memo(i=>{const{name:M,label:v,value:H,onChange:oe,onBlur:ne,options:_}=i;return(0,o.useEffect)(()=>{(B()(H)||H==="")&&oe(Mn()(_,[0,"value"]))},[]),o.createElement(We.Z.Item,{label:v},o.createElement(fn.Z,{size:"large",value:H,onChange:ge=>oe(ge),onBlur:ne},_.map((ge,he)=>o.createElement(nt,{key:`${ge.value}${he}`,value:ge.value},ge.label))))});yt.displayName="FastifyFormSelect";var Qn=t(66990);const Yt=o.memo(i=>{const{name:M,label:v,value:H,onChange:oe,error:ne}=i;return o.createElement(We.Z.Item,{label:v,validateStatus:Ct(ne),help:ne},o.createElement(Qn.Z,{name:M,checked:Boolean(H),onChange:_=>oe(_.target.checked)},v))});Yt.displayName="FastifyFormCheckbox";var Et=Object.defineProperty,gn=Object.getOwnPropertySymbols,Wn=Object.prototype.hasOwnProperty,mn=Object.prototype.propertyIsEnumerable,pn=(i,M,v)=>M in i?Et(i,M,{enumerable:!0,configurable:!0,writable:!0,value:v}):i[M]=v,bn=(i,M)=>{for(var v in M||(M={}))Wn.call(M,v)&&pn(i,v,M[v]);if(gn)for(var v of gn(M))mn.call(M,v)&&pn(i,v,M[v]);return i};const vn=o.memo(i=>{const{label:M}=i;return o.createElement(We.Z.Item,{label:M},o.createElement(be.CustomField,bn({},i)))});vn.displayName="FastifyFormCustom";var yn=Object.defineProperty,jt=Object.getOwnPropertySymbols,Gn=Object.prototype.hasOwnProperty,Yn=Object.prototype.propertyIsEnumerable,Ee=(i,M,v)=>M in i?yn(i,M,{enumerable:!0,configurable:!0,writable:!0,value:v}):i[M]=v,En=(i,M)=>{for(var v in M||(M={}))Gn.call(M,v)&&Ee(i,v,M[v]);if(jt)for(var v of jt(M))Yn.call(M,v)&&Ee(i,v,M[v]);return i};(0,be.regField)("text",cn),(0,be.regField)("textarea",dn),(0,be.regField)("password",Gt),(0,be.regField)("select",yt),(0,be.regField)("checkbox",Yt),(0,be.regField)("custom",vn);let ft={submitLabel:"Submit"};function Kn(i){ft=En(En({},ft),i)}const hn=o.memo(i=>{var M;const v=i.layout,H=(M=i.extraProps)==null?void 0:M.suffixElement,oe=(0,o.useMemo)(()=>{var ne;return o.createElement(We.Z.Item,{wrapperCol:v==="vertical"?{xs:24}:{sm:24,md:{span:16,offset:8}}},o.createElement(de.Z,{loading:i.loading,type:"primary",size:"large",htmlType:"button",style:{width:"100%"},onClick:()=>i.handleSubmit(),disabled:i.canSubmit===!1},(ne=i.submitLabel)!=null?ne:ft.submitLabel))},[i.loading,i.handleSubmit,i.canSubmit,i.submitLabel,v]);return o.createElement(We.Z,{layout:v,labelCol:v==="vertical"?{xs:24}:{sm:24,md:8},wrapperCol:v==="vertical"?{xs:24}:{sm:24,md:16}},i.children,H,oe)});hn.displayName="WebFastifyFormContainer",(0,be.regFormContainer)(hn);const Dn=be.FastifyForm;Dn.displayName="WebMetaForm"},72163:(x,P,t)=>{"use strict";t.d(P,{W:()=>S});var o=t(95326),l=t.n(o),a=t(13546),c=t.n(a),C=t(45563),y=t.n(C),N=t(19692),L=t(71205),j=t(49076),W=(O,z,A)=>new Promise((T,h)=>{var p=F=>{try{Y(A.next(F))}catch(G){h(G)}},g=F=>{try{Y(A.throw(F))}catch(G){h(G)}},Y=F=>F.done?T(F.value):Promise.resolve(F.value).then(p,g);Y((A=A.apply(O,z)).next())});class B extends Error{}function E(){const O=l().create({baseURL:(0,j.qQ)()});return(0,j.A6)(z=>{O.defaults.baseURL=z()}),O.interceptors.request.use(z=>W(this,null,function*(){return["post","get"].includes(String(z.method).toLowerCase())&&!z.headers["X-Token"]&&(z.headers["X-Token"]=yield(0,L.mx)()),z})),O.interceptors.response.use(z=>(z.data=c()(z.data,"data",z.data),z),z=>{var A;const T=(A=c()(z,"response.data"))!=null?A:{};let h=T.message;const p=T.code;if(T.type==="VALIDATION_ERROR"&&(h=(0,N.t)("\u8BF7\u6C42\u53C2\u6570\u6821\u9A8C\u5931\u8D25"),Array.isArray(T.data))){console.error(JSON.stringify(T.data));try{h+=`: ${T.data.map(g=>g.field).join(", ")}`}catch(g){}}if(y()(L.Jd)&&(0,L.Jd)(z)===!1)return{data:{result:!1,msg:h,code:p}};throw new B(h??z.message)}),O}const S=E()},62789:(x,P,t)=>{"use strict";t.d(P,{D6:()=>g,Ml:()=>F,U$:()=>G,ct:()=>Y,pG:()=>h,r5:()=>p,r7:()=>T});var o=t(22149),l=t(19478),a=t(75135),c=t(77100),C=t(58787),y=t(31672),N=Object.defineProperty,L=Object.defineProperties,j=Object.getOwnPropertyDescriptors,W=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable,S=(U,J,k)=>J in U?N(U,J,{enumerable:!0,configurable:!0,writable:!0,value:k}):U[J]=k,O=(U,J)=>{for(var k in J||(J={}))B.call(J,k)&&S(U,k,J[k]);if(W)for(var k of W(J))E.call(J,k)&&S(U,k,J[k]);return U},z=(U,J)=>L(U,j(J)),A=(U,J,k)=>new Promise((se,Ie)=>{var je=Ae=>{try{De(k.next(Ae))}catch(Le){Ie(Le)}},ee=Ae=>{try{De(k.throw(Ae))}catch(Le){Ie(Le)}},De=Ae=>Ae.done?se(Ae.value):Promise.resolve(Ae.value).then(je,ee);De((k=k.apply(U,J)).next())}),T=(U=>(U.user="user",U.converse="converse",U.baseGroupInfo="baseGroupInfo",U.groupInvite="groupInvite",U.pluginRegistry="pluginRegistry",U.userSettings="userSettings",U))(T||{});function h(U,J=!1){return A(this,null,function*(){return yield y.E.fetchQuery(["user",U],()=>(0,c.fetchUserInfo)(U),{staleTime:J?0:2*60*60*1e3})})}function p(U){return A(this,null,function*(){return yield y.E.fetchQuery(["converse",U],()=>(0,o.jW)(U))})}function g(U){return A(this,null,function*(){return yield y.E.fetchQuery(["baseGroupInfo",U],()=>(0,l.getGroupBasicInfo)(U))})}function Y(U){return A(this,null,function*(){return yield y.E.fetchQuery(["groupInvite",U],()=>(0,l.findGroupInviteByCode)(U))})}function F(){return A(this,null,function*(){return yield y.E.fetchQuery(["pluginRegistry"],()=>Promise.all([(0,a.c0)().catch(()=>[]),(0,a.g3)().then(J=>J.map(k=>{const se=z(O({},k),{url:(0,C.A)(k.url)});return k.icon&&(se.icon=(0,C.A)(k.icon)),k.documentUrl&&(se.documentUrl=(0,C.A)(k.documentUrl)),se})).catch(()=>[]),(0,a.zd)().catch(()=>[])]).then(([J,k,se])=>[...J,...k,...se]),{staleTime:2*60*60*1e3})})}function G(){return A(this,null,function*(){return yield y.E.fetchQuery(["userSettings"],()=>(0,c.getUserSettings)(),{staleTime:10*60*1e3})})}},31672:(x,P,t)=>{"use strict";t.d(P,{E:()=>c,L:()=>C});var o=t(56523),l=t(52500),a=t(54284);const c=new o.S({defaultOptions:{queries:{staleTime:10*1e3}}}),C=(0,l.S)({storage:{getItem:y=>(0,a.cF)().get(y),setItem:(y,N)=>(0,a.cF)().set(y,N),removeItem:y=>(0,a.cF)().remove(y)}})},96393:(x,P,t)=>{"use strict";t.d(P,{w:()=>l});var o=t(31672);function l(a,c,C){const y=(...j)=>o.E.fetchQuery([a,JSON.stringify(j)],()=>c(...j),C),N=()=>o.E.refetchQueries([a]),L=()=>{o.E.removeQueries([a])};return y.refetch=N,y.clearCache=L,y}},99852:(x,P,t)=>{"use strict";t.d(P,{A:()=>y,J:()=>N});var o=t(52983),l=t(40160),a=t(66932),c=t.n(a);const C=new a.EventEmitter,y={on(L,j){C.on(L,j)},off(L,j){C.off(L,j)},emit(L,...j){C.emit(L,...j)}};function N(L,j){const W=(0,l.y)(j);(0,o.useEffect)(()=>{const B=(...E)=>{W.current(...E)};return y.on(L,B),()=>{y.off(L,B)}},[])}},96228:(x,P,t)=>{"use strict";t.d(P,{No:()=>A,S8:()=>T,tx:()=>z});var o=t(98281),l=t(62789),a=t(19692),c=t(77100),C=Object.defineProperty,y=Object.defineProperties,N=Object.getOwnPropertyDescriptors,L=Object.getOwnPropertySymbols,j=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,B=(h,p,g)=>p in h?C(h,p,{enumerable:!0,configurable:!0,writable:!0,value:g}):h[p]=g,E=(h,p)=>{for(var g in p||(p={}))j.call(p,g)&&B(h,g,p[g]);if(L)for(var g of L(p))W.call(p,g)&&B(h,g,p[g]);return h},S=(h,p)=>y(h,N(p)),O=(h,p,g)=>new Promise((Y,F)=>{var G=k=>{try{J(g.next(k))}catch(se){F(se)}},U=k=>{try{J(g.throw(k))}catch(se){F(se)}},J=k=>k.done?Y(k.value):Promise.resolve(k.value).then(G,U);J((g=g.apply(h,p)).next())});function z(h,p){return O(this,null,function*(){const g=yield(0,l.r5)(h);if(g===null)throw new Error((0,a.t)("\u627E\u4E0D\u5230\u79C1\u4FE1\u4F1A\u8BDD"));if(!g.members.includes(p))throw new Error((0,a.t)("\u4F1A\u8BDD\u6CA1\u6709\u6743\u9650"));return yield(0,c.appendUserDMConverse)(h),g})}function A(h){return h.reduce((g,Y)=>S(E({},g),{[Y.id]:Y.nickname}),{})}function T(h,p){return O(this,null,function*(){var g;if((0,o.YQu)(p.name))return p.name;const Y=p.members.filter(se=>se!==h),F=yield Promise.all(Y.map(se=>(0,l.pG)(se))),G=(0,o.vIP)().getState().user.friends,U=A(G),J=F.map(se=>{var Ie;return U[se._id]?U[se._id]:(Ie=se.nickname)!=null?Ie:""}),k=J.length;return k===1?(g=J[0])!=null?g:"":k===2?`${J[0]}, ${J[1]}`:`${J[0]}, ${J[1]} ...`})}},40160:(x,P,t)=>{"use strict";t.d(P,{y:()=>l});var o=t(52983);function l(a){const c=(0,o.useRef)(a);return c.current=a,c}},19692:(x,P,t)=>{"use strict";t.d(P,{$G:()=>z,G3:()=>E,Yt:()=>W,lT:()=>O,m0:()=>B,t:()=>j,t4:()=>S});var o=t(21357),l=t(96605),a=t(23951),c=t(2773),C=t(74105),y=t(52983),N=t(35005),L=(A,T,h)=>new Promise((p,g)=>{var Y=U=>{try{G(h.next(U))}catch(J){g(J)}},F=U=>{try{G(h.throw(U))}catch(J){g(J)}},G=U=>U.done?p(U.value):Promise.resolve(U.value).then(Y,F);G((h=h.apply(A,T)).next())});o.ZP.use(C.lB).use(N.Z).use(l.Db).init({fallbackLng:C.X9,load:"currentOnly",backend:{loadPath:"/locales/{{lng}}/{{ns}}.json",allowMultiLoading:!1,addPath:(...A)=>{console.log("Lost translate:",...A)}},react:{hashTransKey(A){return`k${(0,c.kn)(A).toString(16)}`}}});const j=(A,T,h)=>{try{const p=`k${(0,c.kn)(A).toString(16)}`;let g=o.ZP.t(p,T,h);return g===p&&(g=A,console.info(`[i18n] \u7FFB\u8BD1\u7F3A\u5931: [${p}]${A}`)),g}catch(p){return console.error(p),A}};function W(A){var T,h;const p=o.ZP.language;return(h=(T=A[p])!=null?T:A["zh-CN"])!=null?h:A["en-US"]}function B(A){return L(this,null,function*(){return new Promise((T,h)=>{o.ZP.changeLanguage(A,p=>{p?h(p):T()})})})}function E(){return o.ZP.language}function S(A){o.ZP.on("loaded",A)}function O(A){o.ZP.on("languageChanged",A)}function z(){const{t:A,ready:T}=(0,a.$)(),[h,p]=(0,y.useState)(()=>j);return(0,y.useEffect)(()=>{p(()=>(...g)=>j(...g))},[A]),{t:h,ready:T}}},74105:(x,P,t)=>{"use strict";t.d(P,{X9:()=>L,ZK:()=>B,lB:()=>S});var o=t(52983),l=t(14698),a=t.n(l),c=t(19692),C=t(54284),y=t(81281),N=(O,z,A)=>new Promise((T,h)=>{var p=F=>{try{Y(A.next(F))}catch(G){h(G)}},g=F=>{try{Y(A.throw(F))}catch(G){h(G)}},Y=F=>F.done?T(F.value):Promise.resolve(F.value).then(p,g);Y((A=A.apply(O,z)).next())});const L="en-US";function j(){return navigator.language?navigator.language.startsWith("zh")?"zh-CN":"en-US":L}function W(){return N(this,null,function*(){return yield(0,C.cF)().get(y.Px,j())})}function B(){const[O,{save:z}]=(0,C.y$)(y.Px,L),A=(0,o.useRef)(),T=(0,o.useCallback)(p=>N(this,null,function*(){a()(A.current)&&(A.current=O),z(p),yield(0,c.m0)(p)}),[O,z]),h=(0,o.useMemo)(()=>a()(A.current)?!1:A.current!==O,[O]);return{language:O,setLanguage:T,isChanged:h}}function E(O){return N(this,null,function*(){yield(0,C.cF)().save(y.Px,O)})}const S={type:"languageDetector",async:!0,init:()=>{},detect:O=>N(void 0,null,function*(){try{const z=yield W();O(z)}catch(z){O(L)}}),cacheUserLanguage(O){try{E(O)}catch(z){}}}},98281:(x,P,t)=>{"use strict";t.d(P,{eFs:()=>Ws,gvw:()=>Jt,$Ib:()=>In,QEo:()=>He,AKk:()=>At,f4G:()=>Nn,Xpe:()=>Be.GroupPanelType,NtG:()=>he,g3S:()=>Ce,m$Z:()=>hr.zt,q6$:()=>nr.q6,IE7:()=>ue,cCv:()=>it,NDn:()=>Lr,vAN:()=>Sr,rUo:()=>_t,m8p:()=>ce.m8,FcZ:()=>bs,GM2:()=>Be.applyGroupInvite,x9K:()=>ze,Ntz:()=>Y.Nt,_CB:()=>Y._C,D3K:()=>Y.D3,Kdd:()=>E,J3N:()=>xr,ONy:()=>de,YXr:()=>Q.checkTokenValid,xuY:()=>Q.claimTemporaryUser,L1i:()=>ce.L1,sSU:()=>Be.createGroup,fiB:()=>Be.createGroupInviteCode,XAi:()=>Be.createGroupPanel,Tzh:()=>xe,DW_:()=>Q.createTemporaryUser,fA3:()=>qr,u39:()=>Fs,L4o:()=>Be.deleteGroupInvite,J9q:()=>Be.deleteGroupPanel,$Zg:()=>kt,K_u:()=>zr,Y4U:()=>Xn,DtN:()=>Jo,o9n:()=>Q.forgetPassword,KJm:()=>Vr,vMv:()=>Hr,TcU:()=>Be.getAllGroupInviteCode,D6C:()=>ye.D6,r5V:()=>ye.r5,ct2:()=>ye.ct,Mlq:()=>ye.Ml,pGV:()=>ye.pG,U$y:()=>ye.U$,S8F:()=>mt.S8,Q$5:()=>$r,HiA:()=>Tr,doy:()=>Be.getGroupBasicInfo,r3q:()=>Be.getGroupConfigWithInfo,G33:()=>g.G3,pZA:()=>sr,vIP:()=>Os,qQ$:()=>z.qQ,cF2:()=>et.cF,hyC:()=>Et,TGs:()=>Rs,jUY:()=>A,yGS:()=>h,VxZ:()=>Bs,YQu:()=>b.YQ,Mo8:()=>Cs,YtP:()=>g.Yt,fZz:()=>Q.loginWithEmail,ouS:()=>Q.loginWithToken,o4J:()=>c,uRW:()=>Be.modifyGroupField,d89:()=>Be.modifyGroupPanel,jOv:()=>Q.modifyUserField,MjZ:()=>Q.modifyUserPassword,t4N:()=>g.t4,Awg:()=>Zs.A,XV6:()=>Be.quitGroup,peM:()=>Qt,csP:()=>tr.cs,Kr1:()=>Uo,YiW:()=>Q.registerWithEmail,tJD:()=>Ur,WOV:()=>qt,WY0:()=>S.W,c0U:()=>Q.resetPassword,eGN:()=>Q.searchUserWithUniqueName,bG5:()=>pt,brB:()=>se,J7p:()=>tr.J7,I5R:()=>je,YAW:()=>z.YA,poP:()=>et.po,lx9:()=>G,OvJ:()=>tr.Ov,cUn:()=>As,Agn:()=>ee.A,Nvc:()=>Us,wp$:()=>k,hJM:()=>U,omK:()=>xs,jiy:()=>J,lHp:()=>F,t:()=>g.t,AwB:()=>pn,cTq:()=>Js,cGl:()=>ot,TL5:()=>Ee.TL,CGy:()=>Ee.CG,r53:()=>ut,ilX:()=>ct,IxN:()=>Do,CoE:()=>_n,pHK:()=>ro,aoI:()=>me,xzJ:()=>V,xMc:()=>wt,tv4:()=>Bt,hoD:()=>qo,FNv:()=>Vn,Wfz:()=>$o,Y84:()=>ts,zX9:()=>er,TQq:()=>ns.T,tR0:()=>Pn,PlN:()=>cs,iFL:()=>ht,rE2:()=>$n,aaJ:()=>wr,Tgq:()=>ss,mWi:()=>ds,wY6:()=>as,Ew8:()=>Qr,EP:()=>is,a_M:()=>ps,WHr:()=>ms,VM1:()=>vs,eT7:()=>br,Yzt:()=>Ao,GLd:()=>us,ZKp:()=>kn.ZK,kz6:()=>Io,nWw:()=>Ye,GCv:()=>co,j$3:()=>Oo,RxY:()=>Co,coD:()=>jo,JtK:()=>ee.J,cvI:()=>pr,y$C:()=>et.y$,$G7:()=>g.$G,wuX:()=>Br,ysv:()=>rt.y,IIz:()=>Kt,Pc$:()=>Rr,FDf:()=>qn,OqL:()=>vr,Flu:()=>mr,R8f:()=>Mo,qoQ:()=>To,hIH:()=>tt,i83:()=>p});var o={};t.r(o),t.d(o,{addReaction:()=>_t,deleteMessage:()=>kt,fetchConverseLastMessages:()=>Xt,fetchConverseMessage:()=>Nt,fetchNearbyMessage:()=>zn,recallMessage:()=>Qt,removeReaction:()=>qt,sendMessage:()=>pt});var l={};t.r(l),t.d(l,{acceptFriendRequest:()=>Lr,addFriendRequest:()=>Sr,cancelFriendRequest:()=>xr,denyFriendRequest:()=>zr,removeFriend:()=>Ur,setFriendNickname:()=>Zo});var a={};t.r(a),t.d(a,{clearInbox:()=>Vo,setInboxAck:()=>Ho});var c={};t.r(c),t.d(c,{Qr:()=>ce,r9:()=>l,ru:()=>Be,Ty:()=>a,yw:()=>o,EA:()=>Q});var C=t(96319),y=t(39765),N=t(14698),L=t.n(N),j=t(86474),W=t.n(j),B=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});function E(n){const e=new y.ZP({size:1e3,storageBackend:n,defaultExpires:1e3*3600*24,enableCache:!0});return{set:(s,u)=>B(this,null,function*(){try{!!s&&typeof s=="string"&&!W()(u)&&(yield e.save({key:s,data:u}))}catch(m){console.error(m)}return u}),setWithExpires:(s,u,m)=>B(this,null,function*(){try{!!s&&typeof s=="string"&&!W()(u)&&(yield e.save({key:s,data:u,expires:m}))}catch(I){console.error(I)}return u}),get:(s,u)=>B(this,null,function*(){let m;try{m=yield e.load({key:s,autoSync:!0,syncInBackground:!1})}catch(I){I instanceof y.dR||console.log(`get key ${s} error:`,String(I)),m=L()(u)?null:u}return m}),remove:s=>B(this,null,function*(){yield e.remove({key:s})}),save:(s,u)=>B(this,null,function*(){try{!!s&&typeof s=="string"&&!W()(u)&&(yield e.save({key:s,data:u,expires:null}))}catch(m){console.error(m)}return u})}}var S=t(72163),O=t(78989),z=t(49076);const A=typeof window!="undefined",T=typeof navigator!="undefined",h=!1,p="nightly-202309151712";var g=t(19692),Y=t(11318);const[F,G]=(0,Y.Nt)("toasts");function U(n){let e="";n instanceof Error?e=n.message:e=String(n),F(e,"error")}function J(n=(0,g.t)("\u64CD\u4F5C\u6210\u529F")){F(n,"success")}const[k,se]=(0,Y.Nt)("alert"),[Ie,je]=(0,Y.Nt)("global-loading",()=>()=>{});var ee=t(99852),De=t(80527),Ae=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});class Le extends Error{constructor(){super(...arguments);this.name="SocketEventError"}}class Je{constructor(e){this.socket=e,this.listener=[],this.closeFn=null,e.onAny((r,s)=>{const u=this.listener.filter(([m])=>m===r);if(u.length===0){console.warn(`[Socket IO] Unhandler event: ${r}`,s);return}u.forEach(([,m])=>{m(s)})})}get connected(){return this.socket.connected}request(e){return Ae(this,arguments,function*(r,s={}){return new Promise((u,m)=>{this.socket.emit(r,s,I=>{I.result===!0?u(I.data):I.result===!1&&m(new Le(`[${r}]: ${I.message}: 
data: ${JSON.stringify(s)}`))})})})}listen(e,r){this.listener.push([`notify:${e}`,r])}removeListener(e,r){const s=this.listener.findIndex(u=>u[0]===`notify:${e}`&&u[1]===r);s>=0&&this.listener.splice(s,1)}mockReconnect(){this.socket.disconnect(),F("reconnect after 5s"),setTimeout(()=>{this.socket.io.skipReconnect=!1,this.socket.io.reconnect()},5*1e3)}onReconnect(e){this.socket.io.on("reconnect",e)}disconnect(){this.socket.disconnect()}setupSocketStatusTip(){const e=this.socket,r=()=>{this.closeFn||(this.closeFn=Ie((0,g.t)("\u6B63\u5728\u91CD\u65B0\u94FE\u63A5")))},s=()=>{this.closeFn&&typeof this.closeFn=="function"&&(this.closeFn(),this.closeFn=null)};e.on("connect",()=>{console.log("\u8FDE\u63A5\u6210\u529F"),s(),ee.A.emit("updateNetworkStatus","connected")}),e.on("connecting",u=>{console.log("\u6B63\u5728\u8FDE\u63A5"),r(),ee.A.emit("updateNetworkStatus","reconnecting")}),e.on("disconnect",u=>{console.log("\u4E0E\u670D\u52A1\u5668\u7684\u94FE\u63A5\u5DF2\u65AD\u5F00"),U((0,g.t)("\u4E0E\u670D\u52A1\u5668\u7684\u94FE\u63A5\u5DF2\u65AD\u5F00")),s(),ee.A.emit("updateNetworkStatus","disconnected")}),e.on("connect_error",u=>{console.log("\u8FDE\u63A5\u5931\u8D25"),U((0,g.t)("\u8FDE\u63A5\u5931\u8D25")),s(),ee.A.emit("updateNetworkStatus","disconnected")}),e.io.on("reconnect",u=>{console.log("\u91CD\u8FDE\u6210\u529F"),s(),ee.A.emit("updateNetworkStatus","connected")}),e.io.on("reconnect_attempt",u=>{console.log("\u91CD\u8FDE\u4E2D..."),r(),ee.A.emit("updateNetworkStatus","reconnecting")}),e.io.on("reconnect_error",u=>{console.error("\u91CD\u8FDE\u5C1D\u8BD5\u5931\u8D25...",u),r(),ee.A.emit("updateNetworkStatus","reconnecting")}),e.io.on("reconnect_failed",()=>{console.error("\u91CD\u8FDE\u5931\u8D25..."),r(),ee.A.emit("updateNetworkStatus","disconnected")}),e.io.on("error",u=>{console.error("\u7F51\u7EDC\u51FA\u73B0\u5F02\u5E38",u),U((0,g.t)("\u7F51\u7EDC\u51FA\u73B0\u5F02\u5E38")),s(),ee.A.emit("updateNetworkStatus","disconnected")})}}let Pe;function xe(n){return L()(Pe)||Pe.close(),new Promise((e,r)=>{Pe=(0,O.io)((0,z.qQ)(),{transports:["websocket"],auth:{token:n},forceNew:!0,parser:De}),Pe.once("connect",()=>{const s=new Je(Pe);s.setupSocketStatusTip(),e(s)}),Pe.once("error",()=>{r()}),h&&Pe.onAny((...s)=>{console.debug("Receive Notify:",s)})})}var ye=t(62789),Oe=t(98258),we=t(43697),Q=t(77100),b=t(518);function V(n,e=!1){const{data:r}=(0,Oe.a)(["user",n],()=>(0,b.YQ)(n)?(0,Q.fetchUserInfo)(n):{},{staleTime:2*60*60*1e3,refetchOnMount:e?"always":!0});return r??{}}function me(n,e){const r=20*1e3,{data:s,isSuccess:u}=(0,Oe.a)(["onlineStatus",n.join(",")],()=>(0,Q.getUserOnlineStatus)(n),{staleTime:r});return u&&Array.isArray(s)&&typeof e=="function"&&s&&e(s),s??n.map(()=>!1)}var d=t(52983),R=Object.defineProperty,K=Object.defineProperties,$=Object.getOwnPropertyDescriptors,q=Object.getOwnPropertySymbols,ae=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable,ie=(n,e,r)=>e in n?R(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Z=(n,e)=>{for(var r in e||(e={}))ae.call(e,r)&&ie(n,r,e[r]);if(q)for(var r of q(e))fe.call(e,r)&&ie(n,r,e[r]);return n},te=(n,e)=>K(n,$(e));class le extends d.PureComponent{constructor(){super(...arguments);this.state={portals:[]},this.mount=(e,r)=>{this.setState(s=>({portals:[...s.portals,{key:e,children:r}]}))},this.update=(e,r)=>{this.setState(s=>({portals:s.portals.map(u=>u.key===e?te(Z({},u),{children:r}):u)}))},this.unmount=e=>{this.setState(r=>({portals:r.portals.filter(s=>s.key!==e)}))}}render(){const{renderManagerView:e}=this.props;return this.state.portals.map(({key:r,children:s},u)=>d.createElement(d.Fragment,{key:r},e(s)))}}function Re(n){const e=d.createContext(null);return e.displayName="PortalContext-"+n,e}class Qe extends d.Component{componentDidMount(){if(!this.props.manager)throw new Error("Looks like you forgot to wrap your root component with `PortalHost` component.\n");this._key=this.props.manager.mount(this.props.hostName,this.props.children)}componentDidUpdate(){this.props.manager.update(this.props.hostName,this._key,this.props.children)}componentWillUnmount(){this.props.manager.unmount(this.props.hostName,this._key)}render(){return null}}class He{constructor(){this.listeners={}}emit(e,...r){if(!(e in this.listeners))return;const s=this.listeners[e];for(let u=0,m=s.length;u<m;u++){s[u].call(this,event);const I=s[u];typeof I=="function"&&I(...r)}}addListener(e,r){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(r)}removeListener(e,r){if(!(e in this.listeners))return;const s=this.listeners[e];for(let u=0,m=s.length;u<m;u++)if(s[u]===r)return s.splice(u,1),this.removeListener(e,r)}}const Te="ADD_PORTAL",Se="REMOVE_PORTAL",Me=n=>d.createElement(d.Fragment,null,n);function ze(n){const{hostName:e="default",eventEmitter:r=new He,renderManagerView:s=Me}=n;let u=1e4;const m=ve=>{const re=u++;return r.emit(Te,e,ve,re),re},I=ve=>{r.emit(Se,e,ve)},D=Re(e),f=d.memo(ve=>{const re=(0,d.useRef)(),qe=(0,d.useRef)(0),Ze=(0,d.useRef)([]),Dt=(0,d.useRef)(e);(0,d.useEffect)(()=>{Dt.current=e},[e]);const $e=(0,d.useCallback)((Fe,Ke,ke)=>{if(Fe!==Dt.current)return;const xt=ke||qe.current++;return re.current?re.current.mount(xt,Ke):Ze.current.push({type:"mount",key:xt,children:Ke}),xt},[]),zt=(0,d.useCallback)((Fe,Ke,ke)=>{if(Fe===Dt.current)if(re.current)re.current.update(Ke,ke);else{const xt={type:"mount",key:Ke,children:ke},kr=Ze.current.findIndex(ar=>ar.type==="mount"||ar.type==="update"&&ar.key===Ke);kr>-1?Ze.current[kr]=xt:Ze.current.push(xt)}},[]),Ue=(0,d.useCallback)((Fe,Ke)=>{Fe===Dt.current&&(re.current?re.current.unmount(Ke):Ze.current.push({type:"unmount",key:Ke}))},[]);return(0,d.useEffect)(()=>(r.addListener(Te,$e),r.addListener(Se,Ue),()=>{r.removeListener(Te,$e),r.removeListener(Se,Ue)}),[$e,Ue]),(0,d.useEffect)(()=>{const Fe=Ze.current,Ke=re.current;for(;Fe.length&&Ke;){const ke=Fe.pop();if(!!ke)switch(ke.type){case"mount":Ke.mount(ke.key,ke.children);break;case"update":Ke.update(ke.key,ke.children);break;case"unmount":Ke.unmount(ke.key);break}}},[]),d.createElement(D.Provider,{value:{mount:$e,update:zt,unmount:Ue}},d.createElement(d.Fragment,null,ve.children),d.createElement(le,{ref:re,renderManagerView:s}))});f.displayName="PortalHost-"+e;const w=d.memo(ve=>{const re=(0,d.useContext)(D);return L()(re)?(console.error("Not find PortalContext"),null):d.createElement(Qe,{hostName:e,manager:re},ve.children)});return w.displayName="PortalRender-"+e,{add:m,remove:I,PortalHost:f,PortalRender:w}}var et=t(54284);const Ut="alphaMode";function ot(){const[n,{save:e}]=(0,et.y$)(Ut,!1);return{isAlphaMode:n,setAlphaMode:e}}const Ft=d.memo(n=>{const{isAlphaMode:e}=ot();return e?d.createElement(d.Fragment,null,n.children):null});Ft.displayName="AlphaContainer";const At=d.memo(n=>h?d.createElement(d.Fragment,null,n.children):null);At.displayName="DevContainer";var Mt=t(31672),It=t(21974);const st=d.memo(n=>d.createElement(It.S,{client:Mt.E,persistOptions:{persister:Mt.L}},n.children));st.displayName="CacheProvider";function Rt(n){if(n==="dark")return{isDarkMode:!0,extraSchemeName:null};if(n==="light")return{isDarkMode:!1,extraSchemeName:null};if(n==="auto")return{isDarkMode:window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)").matches:!0,extraSchemeName:null};{let[e,r]=n.split("+");return(0,b.YQ)(r)||(r=e,e="dark"),{isDarkMode:e==="dark",extraSchemeName:`theme-${r}`}}}const at=d.createContext({colorScheme:"dark",setColorScheme:()=>{}});at.displayName="ColorSchemeContext";const gt=d.memo(n=>{const[e="dark",{save:r}]=(0,et.y$)("colorScheme","dark");return(0,d.useEffect)(()=>{ee.A.emit("loadColorScheme",e)},[e]),d.createElement(at.Provider,{value:{colorScheme:e,setColorScheme:r}},n.children)});gt.displayName="ColorSchemeContextProvider";function Bt(){const{colorScheme:n,setColorScheme:e}=(0,d.useContext)(at),{isDarkMode:r,extraSchemeName:s}=Rt(n);return{colorScheme:n,setColorScheme:e,isDarkMode:r,extraSchemeName:s}}const ue=d.memo(n=>d.createElement(st,null,d.createElement(gt,null,n.children)));ue.displayName="TcProvider";var pe=t(71607),Ne=t.n(pe);const lt=d.createContext({replyMsg:null,setReplyMsg:Ne()});lt.displayName="ChatBoxContext";const Jt=d.memo(n=>{const[e,r]=(0,d.useState)(null);return d.createElement(lt.Provider,{value:{replyMsg:e,setReplyMsg:r}},n.children)});Jt.displayName="ChatBoxContextProvider";function wt(){const n=(0,d.useContext)(lt),e=(0,d.useCallback)(()=>{n.setReplyMsg(null)},[n.setReplyMsg]);return{hasContext:n.setReplyMsg!==Ne(),replyMsg:n.replyMsg,setReplyMsg:n.setReplyMsg,clearReplyMsg:e}}var mt=t(96228);function On(){const n=(0,d.useRef)(!1),e=(0,d.useCallback)(()=>n.current,[]);return(0,d.useEffect)(()=>(n.current=!0,()=>{n.current=!1}),[]),e}var Cn=Object.defineProperty,jn=Object.defineProperties,Zt=Object.getOwnPropertyDescriptors,Ht=Object.getOwnPropertySymbols,Tn=Object.prototype.hasOwnProperty,Vt=Object.prototype.propertyIsEnumerable,$t=(n,e,r)=>e in n?Cn(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Sn=(n,e)=>{for(var r in e||(e={}))Tn.call(e,r)&&$t(n,r,e[r]);if(Ht)for(var r of Ht(e))Vt.call(e,r)&&$t(n,r,e[r]);return n},Ln=(n,e)=>jn(n,Zt(e));function ct(n,e=[],r={loading:!1}){const s=(0,d.useRef)(0),u=On(),[m,I]=(0,d.useState)(r),D=(0,d.useCallback)((...f)=>{const w=++s.current;return I(ve=>Ln(Sn({},ve),{loading:!0})),n(...f).then(ve=>(u()&&w===s.current&&I({value:ve,loading:!1}),ve),ve=>(u()&&w===s.current&&I({error:ve,loading:!1}),ve))},e);return[m,D]}function ut(n,e=[]){const[r,s]=ct(n,e,{loading:!0});return(0,d.useEffect)(()=>{s()},[s]),r}var Xe=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});function Nt(n,e){return Xe(this,null,function*(){const{data:r}=yield S.W.get("/api/chat/message/fetchConverseMessage",{params:{converseId:n,startId:e}});return r})}function pt(n){return Xe(this,null,function*(){const{data:e}=yield S.W.post("/api/chat/message/sendMessage",n);return e})}function Qt(n){return Xe(this,null,function*(){const{data:e}=yield S.W.post("/api/chat/message/recallMessage",{messageId:n});return e})}function kt(n){return Xe(this,null,function*(){const{data:e}=yield S.W.post("/api/chat/message/deleteMessage",{messageId:n});return e})}function Xt(n){return Xe(this,null,function*(){const{data:e}=yield S.W.post("/api/chat/message/fetchConverseLastMessages",{converseIds:n});return e})}function zn(n){return Xe(this,null,function*(){const{data:e}=yield S.W.post("/api/chat/message/fetchNearbyMessage",n);return e})}function _t(n,e){return Xe(this,null,function*(){const{data:r}=yield S.W.post("/api/chat/message/addReaction",{messageId:n,emoji:e});return r})}function qt(n,e){return Xe(this,null,function*(){const{data:r}=yield S.W.post("/api/chat/message/removeReaction",{messageId:n,emoji:e});return r})}var en=t(2031),dt=t(47393),xn=t(26226),Pt=t.n(xn);const tn={info:null,friends:[],friendRequests:[]},Wt=(0,dt.oM)({name:"user",initialState:tn,reducers:{setUserInfo(n,e){n.info=e.payload},setUserInfoField(n,e){const{fieldName:r,fieldValue:s}=e.payload;n.info!==null&&Pt()(n.info,[r],s)},setUserInfoExtra(n,e){const{fieldName:r,fieldValue:s}=e.payload;n.info!==null&&Pt()(n.info,["extra",r],s)},setFriendList(n,e){n.friends=e.payload},setFriendRequests(n,e){n.friendRequests=e.payload},appendFriend(n,e){n.friends.some(r=>r===e.payload)||n.friends.push(e.payload)},removeFriend(n,e){const r=e.payload,s=n.friends.findIndex(u=>u.id===r);s>=0&&n.friends.splice(s,1)},appendFriendRequest(n,e){n.friendRequests.some(({_id:r})=>r===e.payload._id)||n.friendRequests.push(e.payload)},removeFriendRequest(n,e){const r=n.friendRequests.findIndex(({_id:s})=>s===e.payload);r>=0&&n.friendRequests.splice(r,1)},setFriendNickname(n,e){const{friendId:r,nickname:s}=e.payload,u=n.friends.find(m=>m.id===r);u&&(u.nickname=s)}}}),tt=Wt.actions,nn=Wt.reducer;var Un=t(3010),rn=t.n(Un),on=t(40916),sn=t.n(on),Fn=t(77875),an=t.n(Fn),Ot=Object.defineProperty,un=Object.getOwnPropertySymbols,Rn=Object.prototype.hasOwnProperty,Bn=Object.prototype.propertyIsEnumerable,ln=(n,e,r)=>e in n?Ot(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,vt=(n,e)=>{for(var r in e||(e={}))Rn.call(e,r)&&ln(n,r,e[r]);if(un)for(var r of un(e))Bn.call(e,r)&&ln(n,r,e[r]);return n};const be={currentConverseId:null,converses:{},ack:{},inbox:[],lastMessageMap:{}},We=(0,dt.oM)({name:"chat",initialState:be,reducers:{updateCurrentConverseId(n,e){n.currentConverseId=e.payload},setConverseInfo(n,e){const r=e.payload._id,s=n.converses[r]?vt({},n.converses[r]):{messages:[],hasFetchedHistory:!1,hasMoreMessage:!0};n.converses[r]=vt(vt({},s),e.payload)},appendConverseMessage(n,e){var r;const{converseId:s,messages:u}=e.payload;if(!n.converses[s]){console.error("\u6CA1\u6709\u4F1A\u8BDD\u4FE1\u606F, \u8BF7\u5148\u8BBE\u7F6E\u4F1A\u8BDD\u4FE1\u606F");return}const m=sn()(rn()([...n.converses[s].messages,...u],"_id"),"_id","asc");if(n.converses[s].messages=m,n.currentConverseId!==s){const I=(r=an()(m.filter(D=>!(0,b.AJ)(D._id))))==null?void 0:r._id;(0,b.YQ)(I)&&(n.lastMessageMap[s]=I)}},appendLocalMessage(n,e){const{author:r,localMessageId:s,payload:u}=e.payload,{converseId:m,groupId:I,content:D,meta:f}=u;if(!n.converses[m]){console.error("\u6CA1\u6709\u4F1A\u8BDD\u4FE1\u606F, \u8BF7\u5148\u8BBE\u7F6E\u4F1A\u8BDD\u4FE1\u606F");return}const w={_id:s,author:r,groupId:I,converseId:m,content:D,meta:f,isLocal:!0},ve=sn()(rn()([...n.converses[m].messages,w],"_id"),"_id","asc");n.converses[m].messages=ve},initialHistoryMessage(n,e){const{converseId:r,historyMessages:s}=e.payload;if(!n.converses[r]){console.error("\u6CA1\u6709\u4F1A\u8BDD\u4FE1\u606F, \u8BF7\u5148\u8BBE\u7F6E\u4F1A\u8BDD\u4FE1\u606F");return}We.caseReducers.appendConverseMessage(n,We.actions.appendConverseMessage({converseId:r,messages:[...s]})),s.length<50&&(n.converses[r].hasMoreMessage=!1),n.converses[r].hasFetchedHistory=!0},appendHistoryMessage(n,e){const{converseId:r,historyMessages:s}=e.payload;if(!n.converses[r]){console.error("\u6CA1\u6709\u4F1A\u8BDD\u4FE1\u606F, \u8BF7\u5148\u8BBE\u7F6E\u4F1A\u8BDD\u4FE1\u606F");return}We.caseReducers.appendConverseMessage(n,We.actions.appendConverseMessage({converseId:r,messages:[...s]})),s.length<50&&(n.converses[r].hasMoreMessage=!1),n.converses[r].hasFetchedHistory=!0},removeConverse(n,e){const{converseId:r}=e.payload;!n.converses[r]||delete n.converses[r]},clearAllConverses(n){n.converses={}},setConverseAck(n,e){const{converseId:r,lastMessageId:s}=e.payload;n.ack[r]=s},updateMessageInfo(n,e){var r;const{message:s}=e.payload,u=(r=e.payload.messageId)!=null?r:s._id,m=s.converseId;if(!m){console.warn("Not found converse id,",s);return}const I=n.converses[m];if(!I){console.warn("Not found converse,",m);return}const D=I.messages.findIndex(f=>f._id===u);D>=0&&(I.messages[D]=vt(vt({},I.messages[D]),s))},deleteMessageById(n,e){const{converseId:r,messageId:s}=e.payload,u=n.converses[r];if(!u){console.warn("Not found converse,",r);return}const m=u.messages.findIndex(I=>I._id===s);m>=0&&u.messages.splice(m,1)},setLastMessageMap(n,e){const r=e.payload;Array.isArray(r)&&r.forEach(s=>{n.lastMessageMap[s.converseId]=s.lastMessageId})},appendMessageReaction(n,e){const{converseId:r,messageId:s,reaction:u}=e.payload,m=n.converses[r];if(!m){console.warn("Not found converse,",r);return}const I=m.messages.find(D=>D._id===s);if(!I){console.warn("Not found message,",s);return}Array.isArray(I.reactions)||(I.reactions=[]),I.reactions.push(u)},removeMessageReaction(n,e){const{converseId:r,messageId:s,reaction:u}=e.payload,m=n.converses[r];if(!m){console.warn("Not found converse,",r);return}const I=m.messages.find(f=>f._id===s);if(!I){console.warn("Not found message,",s);return}Array.isArray(I.reactions)||(I.reactions=[]);const D=I.reactions.findIndex(f=>f.name===u.name&&f.author===u.author);I.reactions.splice(D,1)},setInboxList(n,e){const r=e.payload;n.inbox=r},appendInboxItem(n,e){n.inbox.push(e.payload)},setInboxItemAck(n,e){const r=e.payload,s=n.inbox.find(u=>u._id===r);s&&(s.readed=!0)}}}),de=We.actions,bt=We.reducer;var Ct=Object.defineProperty,cn=Object.defineProperties,dn=Object.getOwnPropertyDescriptors,Gt=Object.getOwnPropertySymbols,fn=Object.prototype.hasOwnProperty,wn=Object.prototype.propertyIsEnumerable,Mn=(n,e,r)=>e in n?Ct(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,nt=(n,e)=>{for(var r in e||(e={}))fn.call(e,r)&&Mn(n,r,e[r]);if(Gt)for(var r of Gt(e))wn.call(e,r)&&Mn(n,r,e[r]);return n},yt=(n,e)=>cn(n,dn(e));const Qn={groups:{}},Yt=(0,dt.oM)({name:"group",initialState:Qn,reducers:{appendGroups(n,e){const r=e.payload;for(const s of r)n.groups[s._id]=nt(nt({},n.groups[s._id]),s)},updateGroup(n,e){const r=e.payload,s=r._id;n.groups[s]&&(n.groups[s]=nt(nt({},n.groups[s]),r))},removeGroup(n,e){const r=e.payload;delete n.groups[r]},pinGroupPanel(n,e){const{groupId:r,panelId:s}=e.payload;n.groups[r]&&(n.groups[r]=yt(nt({},n.groups[r]),{pinnedPanelId:s}))},unpinGroupPanel(n,e){const{groupId:r}=e.payload;n.groups[r]&&(n.groups[r]=yt(nt({},n.groups[r]),{pinnedPanelId:void 0}))},updateGroupConfig(n,e){var r;const{groupId:s,configName:u,configValue:m}=e.payload,I=n.groups[s];I&&(n.groups[s]=yt(nt({},I),{config:yt(nt({},(r=I.config)!=null?r:{}),{[u]:m})}))}}}),Et=Yt.actions,gn=Yt.reducer,Wn={panelWinUrls:[]},mn=(0,dt.oM)({name:"ui",initialState:Wn,reducers:{addPanelWindowUrl(n,e){const r=e.payload.url;n.panelWinUrls.push(r)},deletePanelWindowUrl(n,e){const r=e.payload.url,s=n.panelWinUrls.indexOf(r);n.panelWinUrls.splice(s,1)}}}),pn=mn.actions,bn=mn.reducer,vn={networkStatus:"initial",reconnectNum:0},yn=(0,dt.oM)({name:"global",initialState:vn,reducers:{setNetworkStatus(n,e){n.networkStatus=e.payload},incReconnectNum(n){n.reconnectNum+=1}}}),jt=yn.actions,Gn=yn.reducer,Yn=(0,en.UY)({global:Gn,user:nn,chat:bt,group:gn,ui:bn});var Ee=t(84966),En=t(13546),ft=t.n(En),Kn=t(61422),hn=t.n(Kn),Dn=t(49335),i=t.n(Dn),M=Object.defineProperty,v=Object.getOwnPropertySymbols,H=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable,ne=(n,e,r)=>e in n?M(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,_=(n,e)=>{for(var r in e||(e={}))H.call(e,r)&&ne(n,r,e[r]);if(v)for(var r of v(e))oe.call(e,r)&&ne(n,r,e[r]);return n};const ge=["_id","content","author"];class he{constructor(e){this.payload=_({},e)}hasReply(){const e=ft()(this.payload,["meta","reply"]);return L()(e)?!1:e}setReplyMsg(e){L()(e)||Pt()(this.payload,["meta","reply"],i()(e,ge))}generatePayload(){return _({},this.payload)}}var ce=t(22149),rt=t(40160),_e=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});const Tt=()=>hn()("localMessage_");function An(){const n=(0,Ee.CG)(D=>{var f;return(f=D.user.info)==null?void 0:f._id}),e=(0,Ee.TL)(),{hasContext:r,replyMsg:s,clearReplyMsg:u}=wt(),m=(0,rt.y)(s);return er(D=>{if(D.content===""){U((0,g.t)("\u65E0\u6CD5\u53D1\u9001\u7A7A\u6D88\u606F"));return}if(r===!0){const w=new he(D);L()(m.current)||(w.setReplyMsg(m.current),u()),D=w.generatePayload()}const f=Tt();e(de.appendLocalMessage({author:n,localMessageId:f,payload:D})),pt(D).then(w=>{e(de.deleteMessageById({converseId:D.converseId,messageId:f})),e(de.appendConverseMessage({converseId:D.converseId,messages:[w]})),ee.A.emit("sendMessage",D)}).catch(w=>{U(w),e(de.updateMessageInfo({messageId:f,message:{sendFailed:!0}}))})})}function Jn(n){var e,r;const{converseId:s,isGroup:u}=n,m=(0,Ee.CG)(Ue=>Ue.chat.converses[s]),I=(0,Ee.CG)(Ue=>Ue.global.reconnectNum),D=(e=m==null?void 0:m.hasMoreMessage)!=null?e:!0,f=(0,Ee.TL)(),w=(r=m==null?void 0:m.messages)!=null?r:[],ve=(0,Ee.CG)(Ue=>{var Fe;return(Fe=Ue.user.info)==null?void 0:Fe._id});(0,d.useEffect)(()=>(f(de.updateCurrentConverseId(s)),()=>{f(de.updateCurrentConverseId(null))}),[s]);const{loading:re,error:qe}=ut(()=>_e(this,null,function*(){if(!!ve)if(m){if(!m.hasFetchedHistory){const Ue=L()(m.messages[0])?void 0:m.messages[0]._id,Fe=yield Nt(s,Ue);f(de.initialHistoryMessage({converseId:s,historyMessages:Fe}))}}else{if(u)f(de.setConverseInfo({_id:s,name:"",type:ce.tv.Group,members:[]}));else{const Fe=yield(0,mt.tx)(s,ve);f(de.setConverseInfo(Fe))}const Ue=yield Nt(s);f(de.initialHistoryMessage({converseId:s,historyMessages:Ue}))}}),[s,I,ve]),[{loading:Ze},Dt]=_n(()=>_e(this,null,function*(){const Ue=ft()(w,[0,"_id"]);if(!(0,b.YQ)(Ue)||D===!1)return;const Fe=yield Nt(s,Ue);f(de.appendHistoryMessage({converseId:s,historyMessages:Fe}))}),[s,D,ft()(w,[0,"_id"])]),$e=Ye(()=>_e(this,null,function*(){Ze||(yield Dt())})),zt=An();return{messages:w,loading:re,error:qe,isLoadingMore:Ze,hasMoreMessage:D,handleFetchMoreMessage:$e,handleSendMessage:zt}}function Zn(n){const e=d.createContext(n.defaultValue);e.displayName=n.displayName;function r(){return d.useContext(e)}return{Context:e,useContext:r}}const{Context:Hn,useContext:Vn}=Zn({defaultValue:{},displayName:"ConverseMessageContext"}),In=d.memo(n=>{const{converseId:e,isGroup:r}=n,{messages:s,loading:u,error:m,isLoadingMore:I,hasMoreMessage:D,handleFetchMoreMessage:f,handleSendMessage:w}=Jn({converseId:e,isGroup:r});return d.createElement(Hn.Provider,{value:{messages:s,loading:u,error:m,isLoadingMore:I,hasMoreMessage:D,fetchMoreMessage:f,sendMessage:w}},n.children)});In.displayName="ConverseMessageProvider";const St=d.createContext({groupInfo:null});St.displayName="GroupInfoContext";const Nn=d.memo(n=>d.createElement(St.Provider,{value:{groupInfo:n.groupInfo}},n.children));Nn.displayName="GroupInfoContextProvider";function $n(){return(0,d.useContext)(St).groupInfo}var Ge=t(13432);const it=d.memo(n=>d.createElement(Ge.c,null,n.children));it.displayName="Trans";var kn=t(74105),Xr=t(45563),cr=t.n(Xr);function Ye(n){const e=(0,d.useRef)(n);e.current=(0,d.useMemo)(()=>n,[n]);const r=(0,d.useRef)();return r.current||(r.current=function(...s){return e.current.apply(this,s)}),r.current}const _r=(n=>(e,r)=>{const s=(0,d.useRef)(!1);n(()=>()=>{s.current=!1},[]),n(()=>{if(!s.current)s.current=!0;else return e()},r)})(d.useEffect);function qr(n){function e(r,s){let u;try{u=n()}catch(re){console.error(re)}const m=re=>(s==null?void 0:s.serializer)?s==null?void 0:s.serializer(re):JSON.stringify(re),I=re=>(s==null?void 0:s.deserializer)?s==null?void 0:s.deserializer(re):JSON.parse(re);function D(){try{const re=u==null?void 0:u.getItem(r);if(re)return I(re)}catch(re){console.error(re)}return cr()(s==null?void 0:s.defaultValue)?s==null?void 0:s.defaultValue():s==null?void 0:s.defaultValue}const[f,w]=(0,d.useState)(()=>D());return _r(()=>{w(D())},[r]),[f,Ye(re=>{const qe=cr()(re)?re(f):re;if(w(qe),W()(qe))u==null||u.removeItem(r);else try{u==null||u.setItem(r,m(qe))}catch(Ze){console.error(Ze)}})]}return e}var eo=t(96393),to=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});const Xn=(0,eo.w)("fetchAvailableServices",()=>to(void 0,null,function*(){const{data:n}=yield S.W.get("/api/gateway/health");return n.services}));var no=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});function ro(){const[{loading:n,value:e},r]=ct(()=>Xn());(0,d.useEffect)(()=>{r()},[]);const s=Ye(()=>no(this,null,function*(){Xn.clearCache(),r()}));return{loading:n,availableServices:e,refetch:s}}var oo=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});function _n(n,e=[]){const[{loading:r,value:s},u]=ct((...m)=>oo(this,null,function*(){try{return yield n(...m)}catch(I){U(I),console.error("[useAsyncRequest] error:",I)}}),e);return[{loading:r,value:s},u]}var so=t(92238),ao=t.n(so),uo=Object.defineProperty,dr=Object.getOwnPropertySymbols,io=Object.prototype.hasOwnProperty,lo=Object.prototype.propertyIsEnumerable,fr=(n,e,r)=>e in n?uo(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Mr=(n,e)=>{for(var r in e||(e={}))io.call(e,r)&&fr(n,r,e[r]);if(dr)for(var r of dr(e))lo.call(e,r)&&fr(n,r,e[r]);return n},gr=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});function mr(){const n=(0,we.NL)(),{data:e,isLoading:r}=(0,Oe.a)([ye.r7.userSettings],()=>(0,Q.getUserSettings)(),{staleTime:10*60*1e3}),[{loading:s},u]=_n(m=>gr(this,null,function*(){n.setQueryData([ye.r7.userSettings],()=>Mr(Mr({},e),m));const I=yield(0,Q.setUserSettings)(m);n.setQueryData([ye.r7.userSettings],()=>I),ee.A.emit("userSettingsUpdate",I)}),[n]);return{settings:e??{},setSettings:u,loading:r||s}}function pr(n,e){var r;const{settings:s,setSettings:u,loading:m}=mr();return{value:(r=s[n])!=null?r:e,setValue:I=>gr(this,null,function*(){return u({[n]:I})}),loading:m}}function vr(){const{value:n=[],setValue:e}=pr("messageNotificationMuteList",[]),r=Ye(I=>{e([...n,I])}),s=Ye(I=>{e(ao()(n,I))}),u=Ye(I=>{n.includes(I)?s(I):r(I)}),m=Ye((I,D)=>D?n.includes(I)||n.includes(D):n.includes(I));return{mutedList:n,mute:r,unmute:s,toggleMute:u,checkIsMuted:m}}function co(){const{checkIsMuted:n}=vr();(0,ee.J)("receiveMessage",e=>{!e||n(e.converseId,e.groupId)||ee.A.emit("receiveUnmutedMessage",e)})}var fo=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});function qn(n=[]){const{value:e=[]}=ut(()=>fo(this,null,function*(){return yield Promise.all(n.map(s=>(0,ye.pG)(s)))}),[n.join(",")]);return e}function Mo(n){return qn(n).map(r=>r.nickname)}var go=Object.defineProperty,mo=Object.defineProperties,po=Object.getOwnPropertyDescriptors,yr=Object.getOwnPropertySymbols,vo=Object.prototype.hasOwnProperty,yo=Object.prototype.propertyIsEnumerable,Er=(n,e,r)=>e in n?go(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Eo=(n,e)=>{for(var r in e||(e={}))vo.call(e,r)&&Er(n,r,e[r]);if(yr)for(var r of yr(e))yo.call(e,r)&&Er(n,r,e[r]);return n},ho=(n,e)=>mo(n,po(e));function Do(n,e=[]){const[r,s]=ct(n,e,{loading:!0});(0,d.useEffect)(()=>{s()},[s]);const u=(0,d.useCallback)(()=>s(),[s]);return ho(Eo({},r),{refresh:u})}function Vs(n,e=0){const r=useRef(!1),s=useRef(),u=useRef(n),m=useCallback(()=>r.current,[]),I=useCallback(()=>{r.current=!1,s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{r.current=!0,u.current()},e)},[e]),D=useCallback(()=>{r.current=null,s.current&&clearTimeout(s.current)},[]);return useEffect(()=>{u.current=n},[n]),useEffect(()=>(I(),D),[e]),[m,D,I]}function $s(n,e=0,r=[]){const[s,u,m]=useTimeoutFn(n,e);return useEffect(m,r),[s,u]}function ks(n,e){const[r,s]=useState(n);useLayoutEffect(()=>{s(n)},[n]);const u=useCallback(()=>{e(r)},[r,e]);return[r,s,u]}const er=Ye;function Ao(n,e,r){const s=r==null?void 0:r.immediate,u=(0,rt.y)(n),m=(0,d.useRef)();return(0,d.useEffect)(()=>{if(!(typeof e!="number"||e<0))return s&&u.current(),m.current=window.setInterval(()=>{u.current()},e),()=>{m.current&&window.clearInterval(m.current)}},[e]),(0,d.useCallback)(()=>{m.current&&window.clearInterval(m.current)},[])}function Io(n,e){const[r,s]=(0,d.useState)(n);(0,d.useLayoutEffect)(()=>{s(n)},[n]);const u=er(m=>{s(m),e(m)});return[r,u]}function Xs(n){const e=useRef();return useEffect(()=>{e.current=n}),e.current}const No=n=>{(0,d.useEffect)(n,[])},Po=n=>{const e=(0,d.useRef)(n);e.current=n,No(()=>()=>e.current())},Oo=n=>{const e=(0,d.useRef)(0),[r,s]=(0,d.useState)(n),u=(0,d.useCallback)(m=>{cancelAnimationFrame(e.current),e.current=requestAnimationFrame(()=>{s(m)})},[]);return Po(()=>{cancelAnimationFrame(e.current)}),[r,u]};function Co(n){const{dataSource:e,filterFn:r}=n,[s,u]=(0,d.useState)(""),m=s!=="",I=(0,d.useMemo)(()=>e.filter(D=>r(D,s)),[e,s]);return{searchText:s,setSearchText:u,isSearching:m,searchResult:I}}var hr=t(99698);function jo(n){const[e,r]=(0,d.useState)(n);return(0,d.useLayoutEffect)(()=>{(0,hr.wU)(e,n)||r(n)},[n]),e}function To(n,e){const r=Ye(e);(0,d.useLayoutEffect)(()=>{r()},n)}var _s=t(31676),qs=t(85466),So=Object.defineProperty,Dr=Object.getOwnPropertySymbols,Lo=Object.prototype.hasOwnProperty,zo=Object.prototype.propertyIsEnumerable,Ar=(n,e,r)=>e in n?So(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Ir=(n,e)=>{for(var r in e||(e={}))Lo.call(e,r)&&Ar(n,r,e[r]);if(Dr)for(var r of Dr(e))zo.call(e,r)&&Ar(n,r,e[r]);return n};function ea(n,e,{onChangeFound:r,onNoChangeFound:s}={}){const u=useRef(e);useEffect(()=>{if(!isDevelopment)return;const m=Object.keys(Ir(Ir({},u.current),e)),I={};m.forEach(D=>{u.current[D]!==e[D]&&(I[D]={from:u.current[D],to:e[D],changedKeys:e[D]&&typeof e[D]=="object"?Object.keys(u.current[D]).map(f=>_get(u.current,[D,f])===_get(e,[D,f])?"":f).filter(Boolean):void 0,isDeepEqual:_isEqual(u.current[D],e[D])})}),Object.keys(I).length?r?r({changesObj:I}):console.log("[why-did-you-update]",n,{changes:parse(stringify(I)),props:{from:u.current,to:e}}):s&&s(),u.current=e})}var tr=t(71205);const[xo,Uo]=(0,Y._C)();var Fo=t(36350),Ro=t(61506),nr=t(81281),Bo=Object.defineProperty,Nr=Object.getOwnPropertySymbols,wo=Object.prototype.hasOwnProperty,Qo=Object.prototype.propertyIsEnumerable,Pr=(n,e,r)=>e in n?Bo(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Wo=(n,e)=>{for(var r in e||(e={}))wo.call(e,r)&&Pr(n,r,e[r]);if(Nr)for(var r of Nr(e))Qo.call(e,r)&&Pr(n,r,e[r]);return n};const Pn=(0,Fo.create)()((0,Ro.tJ)(n=>Wo({},nr.Xb),{name:"globalConfigStore"}));var bo=Object.defineProperty,Or=Object.getOwnPropertySymbols,Go=Object.prototype.hasOwnProperty,Yo=Object.prototype.propertyIsEnumerable,Cr=(n,e,r)=>e in n?bo(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,jr=(n,e)=>{for(var r in e||(e={}))Go.call(e,r)&&Cr(n,r,e[r]);if(Or)for(var r of Or(e))Yo.call(e,r)&&Cr(n,r,e[r]);return n},Ko=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});function Tr(){return Pn.getState()}function Jo(){return Ko(this,null,function*(){const{data:n}=yield S.W.get("/api/config/client");return Pn.setState(jr(jr({},nr.Xb),n)),n})}var Lt=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});function Sr(n){return Lt(this,null,function*(){const{data:e}=yield S.W.post("/api/friend/request/add",{to:n});return e})}function Lr(n){return Lt(this,null,function*(){yield S.W.post("/api/friend/request/accept",{requestId:n})})}function zr(n){return Lt(this,null,function*(){yield S.W.post("/api/friend/request/deny",{requestId:n})})}function xr(n){return Lt(this,null,function*(){yield S.W.post("/api/friend/request/cancel",{requestId:n})})}function Ur(n){return Lt(this,null,function*(){yield S.W.post("/api/friend/removeFriend",{friendUserId:n})})}function Zo(n,e){return Lt(this,null,function*(){yield S.W.post("/api/friend/setFriendNickname",{targetId:n,nickname:e})})}var Be=t(19478),ta=t(75135),Fr=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});function Ho(n){return Fr(this,null,function*(){yield S.W.post("/api/chat/inbox/ack",{inboxItemIds:n})})}function Vo(){return Fr(this,null,function*(){yield S.W.post("/api/chat/inbox/clear")})}function $o(){const n=(0,Ee.CG)(s=>s.chat.converses),e=(0,Ee.CG)(s=>s.chat.lastMessageMap),r=(0,d.useMemo)(()=>Object.entries(n).filter(([,s])=>[ce.tv.DM,ce.tv.Multi].includes(s.type)).map(([,s])=>s),[n]);return(0,d.useMemo)(()=>r.sort((s,u)=>{var m,I;return((m=e[s._id])!=null?m:"")<((I=e[u._id])!=null?I:"")?1:-1}),[r,e])}var ko=t(77837),Xo=t.n(ko);const _o=Xo()((n,e)=>{(0,ce.g3)(n,e)},1e3,{leading:!0,trailing:!0});function qo(n){const e=(0,Ee.TL)(),r=(0,Ee.CG)(D=>D.chat.lastMessageMap[n]),s=(0,d.useRef)("");s.current=(0,Ee.CG)(D=>{var f;return(f=D.chat.ack[n])!=null?f:""});const u=Ye((D,f)=>{(0,b.AJ)(f)||(0,b.YQ)(s.current)&&f<=s.current||(e(de.setConverseAck({converseId:D,lastMessageId:f})),_o(D,f),s.current=f)}),m=Ye(D=>{u(n,D)}),I=Ye(()=>{m(r)});return{updateConverseAck:m,markConverseAllAck:I}}function Rr(){return(0,Ee.CG)(n=>n.user.info)}function Kt(){var n;return(n=Rr())==null?void 0:n._id}var es=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});function ts(n){const e=Kt(),r=(0,Ee.CG)(u=>u.user.friends),{value:s=""}=ut(()=>es(this,null,function*(){return(0,b.YQ)(e)?(0,mt.S8)(e,n):""}),[e,n.name,n.members.join(","),r]);return s}var ns=t(95850);function Br(n){const e=(0,Ee.CG)(s=>s.chat.ack),r=(0,Ee.CG)(s=>s.chat.lastMessageMap);return n.map(s=>e[s]===void 0&&r[s]!==void 0?!0:r[s]>e[s])}var rs=t(6494),os=t.n(rs);function ht(n){var e;return(e=(0,Ee.CG)(r=>r.group.groups[n]))!=null?e:null}function wr(n){var e;const r=ht(n),s=(e=r==null?void 0:r.members)!=null?e:[];return(0,d.useMemo)(()=>s.map(m=>m.userId),[s])}function ss(n){const e=wr(n),r=qn(e);return os()(r)}function Qr(n){const e=ht(n);return(0,d.useMemo)(()=>{var r;return(r=e==null?void 0:e.panels)!=null?r:[]},[e])}function as(n,e){const r=Qr(n);return(0,d.useMemo)(()=>{var s;return(s=r.find(u=>u.id===e))!=null?s:null},[n,e,r])}function us(n,e){const r=ht(n),s=Kt();return(0,b.YQ)(e)?(r==null?void 0:r.owner)===e:typeof s=="string"&&(r==null?void 0:r.owner)===s}function is(n){return Br([n])[0]}function ls(n){return n.type===Be.GroupPanelType.TEXT}function cs(n){const e=ht(n),r=(0,Ee.CG)(m=>m.chat.lastMessageMap),s=(0,Ee.TL)();return{markGroupAllAck:Ye(()=>{var m;const I=((m=e==null?void 0:e.panels)!=null?m:[]).filter(ls);for(const D of I){const f=D.id,w=r[f];f&&w&&(s(de.setConverseAck({converseId:f,lastMessageId:w})),(0,ce.g3)(f,w))}})}}function ds(n,e){const r=(0,Ee.CG)(s=>{var u,m;return(m=(u=s.group.groups[n])==null?void 0:u.members.find(I=>I.userId===e))==null?void 0:m.muteUntil});return!r||new Date(r).valueOf()<new Date().valueOf()?!1:r}var fs=t(90292),rr=t.n(fs),Ms=t(62923),or=t.n(Ms);function Wr(n){var e,r;const s=ht(n),u=Kt();if(!s||!u)return[];if(s.owner===u)return sr().map(w=>w.key);const m=s.members,I=s.roles,D=(r=(e=m.find(w=>w.userId===u))==null?void 0:e.roles)!=null?r:[],f=rr()([...or()(D.map(w=>{var ve,re;return(re=(ve=I.find(qe=>String(qe._id)===w))==null?void 0:ve.permissions)!=null?re:[]})),...s.fallbackPermissions]);return(0,d.useDebugValue)({groupRoles:I,userRoles:D,userPermissions:f,fallbackPermissions:s.fallbackPermissions}),f}function gs(n,e){var r,s,u,m,I;const D=ht(n),f=Kt();if(!D||!f)return[];const w=D.panels.find($e=>$e.id===e);if(!w)return[];const ve=(r=w.fallbackPermissions)!=null?r:[],re=(s=w.permissionMap)!=null?s:{},qe=(u=re[f])!=null?u:[],Ze=(I=(m=D.members.find($e=>$e.userId===f))==null?void 0:m.roles)!=null?I:[];return rr()([...or()(Ze.map($e=>{var zt;return(zt=re[$e])!=null?zt:[]})),...qe,...ve])}function ms(n,e){const r=Wr(n),s=(0,d.useMemo)(()=>e.map(u=>r.includes(u)),[r.join(","),e.join(",")]);return(0,d.useDebugValue)({groupId:n,userPermissions:r,checkedPermissions:e,result:s}),s}function ps(n,e,r){const s=Wr(n),u=gs(n,e),m=rr()([...s,...u]),I=(0,d.useMemo)(()=>r.map(D=>m.includes(D)),[m.join(","),r.join(",")]);return(0,d.useDebugValue)({groupId:n,panelId:e,fullPermissions:m,checkedPermissions:r,result:I}),I}function br(){return(0,Ee.CG)(n=>{var e;return(e=n.chat.inbox)!=null?e:[]})}function vs(n){var e;return(e=br().find(s=>s._id===n))!=null?e:null}var ys=Object.defineProperty,Gr=Object.getOwnPropertySymbols,Es=Object.prototype.hasOwnProperty,hs=Object.prototype.propertyIsEnumerable,Yr=(n,e,r)=>e in n?ys(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Kr=(n,e)=>{for(var r in e||(e={}))Es.call(e,r)&&Yr(n,r,e[r]);if(Gr)for(var r of Gr(e))hs.call(e,r)&&Yr(n,r,e[r]);return n},Ds=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});function As(n,e){e.dispatch(jt.setNetworkStatus("initial")),Jr(n,e),Is(n,e),n.onReconnect(()=>{console.warn("\u56E0\u4E3A\u65AD\u7EBF\u91CD\u8FDE\u89E6\u53D1\u91CD\u65B0\u540C\u6B65\u8FDC\u7A0B\u6570\u636E"),Jr(n,e),e.dispatch(de.clearAllConverses()),e.dispatch(jt.incReconnectNum())}),ee.A.on("updateNetworkStatus",r=>{e.dispatch(jt.setNetworkStatus(r))})}function Jr(n,e){console.log("\u521D\u59CB\u5316Redux\u4E0A\u4E0B\u6587...");const r=n.request("chat.converse.findAndJoinRoom").catch(s=>{throw console.error(s),F((0,g.t)("\u65E0\u6CD5\u52A0\u5165\u623F\u95F4, \u60A8\u5C06\u65E0\u6CD5\u83B7\u53D6\u5230\u6700\u65B0\u7684\u4FE1\u606F, \u8BF7\u5237\u65B0\u9875\u9762\u540E\u91CD\u8BD5"),"error"),new Error("findAndJoinRoom failed")});Promise.all([r,(0,ce.LB)()]).then(([{dmConverseIds:s,textPanelIds:u},m])=>{m.forEach(D=>{e.dispatch(de.setConverseAck({converseId:D.converseId,lastMessageId:D.lastMessageId}))});const I=[...s,...u];Xt(I).then(D=>{e.dispatch(de.setLastMessageMap(D))})}),n.request("friend.getAllFriends").then(s=>{e.dispatch(tt.setFriendList(s))}),n.request("friend.request.allRelated").then(s=>{e.dispatch(tt.setFriendRequests(s))}),n.request("user.dmlist.getAllConverse").then(s=>{(s??[]).forEach(u=>Ds(this,null,function*(){try{const m=yield(0,ye.r5)(u);e.dispatch(de.setConverseInfo(m))}catch(m){console.error(m)}}))}),n.request("group.getUserGroups").then(s=>{e.dispatch(Et.appendGroups(s))}),n.request("chat.inbox.all").then(s=>{e.dispatch(de.setInboxList(s))})}function Is(n,e){n.listen("friend.add",({userId:r})=>{if(typeof r!="string"){console.error("\u9519\u8BEF\u7684\u4FE1\u606F",r);return}e.dispatch(tt.appendFriend({id:r}))}),n.listen("friend.request.add",r=>{e.dispatch(tt.appendFriendRequest(r))}),n.listen("friend.request.remove",({requestId:r})=>{e.dispatch(tt.removeFriendRequest(r))}),n.listen("chat.message.add",r=>{const s=r.converseId,u=e.getState().chat.converses[s],m=()=>{e.dispatch(de.appendConverseMessage({converseId:s,messages:[r]}))};u?m():r.groupId?e.dispatch(de.setLastMessageMap([{converseId:s,lastMessageId:r._id}])):(0,ye.r5)(s).then(I=>{[ce.tv.DM,ce.tv.Multi].includes(I.type)&&(0,Q.appendUserDMConverse)(I._id),e.dispatch(de.setConverseInfo(I)),m()}),ee.A.emit("receiveMessage",r)}),n.listen("chat.message.update",r=>{e.dispatch(de.updateMessageInfo({message:r}))}),n.listen("chat.message.delete",({converseId:r,messageId:s})=>{e.dispatch(de.deleteMessageById({converseId:r,messageId:s}))}),n.listen("chat.message.addReaction",({converseId:r,messageId:s,reaction:u})=>{e.dispatch(de.appendMessageReaction({converseId:r,messageId:s,reaction:u}))}),n.listen("chat.message.removeReaction",({converseId:r,messageId:s,reaction:u})=>{e.dispatch(de.removeMessageReaction({converseId:r,messageId:s,reaction:u}))}),n.listen("chat.converse.updateDMConverse",r=>{e.dispatch(de.setConverseInfo(r))}),n.listen("group.add",r=>{e.dispatch(Et.appendGroups([r]))}),n.listen("group.updateInfo",r=>{e.dispatch(Et.updateGroup(r))}),n.listen("group.remove",({groupId:r})=>{e.dispatch(Et.removeGroup(r))}),n.listen("chat.inbox.append",r=>{e.dispatch(de.appendInboxItem(r))}),n.listen("chat.inbox.updated",()=>{n.request("chat.inbox.all").then(r=>{e.dispatch(de.setInboxList(r))})}),n.listen("config.updateClientConfig",r=>{Pn.setState(s=>Kr(Kr({},s),r))}),xo.forEach(({eventName:r,eventFn:s})=>{n.listen(r,s)})}function Ns(){return(0,dt.xC)({reducer:Yn,middleware:e=>e({serializableCheck:!1}),devTools:!1})}const Ps=Ns();function Os(){return Ps}function Cs(n,e){return or()(n.map((r,s)=>s===0?[r]:[e,r]))}var js=t(35708),Ve=t.n(js),Ts=t(79201),Ss=t.n(Ts),Ls=t(58104),zs=t.n(Ls),na=t(57570);Ve().extend(Ss()),Ve().extend(zs()),Ve().locale("zh-cn"),(0,g.lT)(n=>{if(n==="en-US"){Ve().locale("en");return}Ve().locale("zh-cn")});function Zr(n){return Ve()(n).isSame(Ve()(),"d")}function ra(n){const e=dayjs(n);return Zr(e)?e.fromNow():e.format("YYYY-MM-DD HH:mm:ss")}function xs(n){const e=Ve()(n);return Zr(e)?Hr(e):Vr(e)}function Us(n,e){return Math.abs(n.valueOf()-e.valueOf())>15*60*1e3}function Hr(n){return Ve()(n).format("HH:mm")}function Vr(n){return Ve()(n).format("YYYY-MM-DD HH:mm:ss")}function oa(n){return dayjs(n).toNow()}function Fs(n){return Ve()(n).fromNow()}function Rs(n){return Ve().duration(n,"ms").humanize()}function Bs(n){if(typeof n!="string")return!1;try{return JSON.parse(n),!0}catch(e){return!1}}var ws=t(51208),Qs=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});const Ws=Symbol("AllPermission"),Ce={core:{message:"core.message",invite:"core.invite",unlimitedInvite:"core.unlimitedInvite",editInvite:"core.editInvite",groupDetail:"core.groupDetail",groupConfig:"core.groupConfig",manageUser:"core.manageUser",managePanel:"core.managePanel",manageInvite:"core.manageInvite",manageRoles:"core.manageRoles",deleteMessage:"core.deleteMessage"}},sr=()=>[{key:Ce.core.message,title:(0,g.t)("\u53D1\u9001\u6D88\u606F"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u5728\u6587\u5B57\u9891\u9053\u53D1\u9001\u6D88\u606F"),default:!0,panel:[ws.Xp.TEXT]},{key:Ce.core.invite,title:(0,g.t)("\u9080\u8BF7\u94FE\u63A5"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u521B\u5EFA\u9080\u8BF7\u94FE\u63A5"),default:!1},{key:Ce.core.unlimitedInvite,title:(0,g.t)("\u4E0D\u9650\u65F6\u9080\u8BF7\u94FE\u63A5"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u521B\u5EFA\u4E0D\u9650\u65F6\u9080\u8BF7\u94FE\u63A5"),default:!1,required:[Ce.core.invite]},{key:Ce.core.editInvite,title:(0,g.t)("\u7F16\u8F91\u9080\u8BF7\u94FE\u63A5"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u7F16\u8F91\u9080\u8BF7\u94FE\u63A5"),default:!1,required:[Ce.core.unlimitedInvite]},{key:Ce.core.groupDetail,title:(0,g.t)("\u67E5\u770B\u7FA4\u7EC4\u8BE6\u60C5"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u67E5\u770B\u7FA4\u7EC4\u8BE6\u60C5"),default:!1},{key:Ce.core.groupConfig,title:(0,g.t)("\u4FEE\u6539\u7FA4\u7EC4\u914D\u7F6E"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u4FEE\u6539\u7FA4\u7EC4\u914D\u7F6E"),default:!1,required:[Ce.core.groupDetail]},{key:Ce.core.manageUser,title:(0,g.t)("\u5141\u8BB8\u7BA1\u7406\u7528\u6237"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u7BA1\u7406\u7528\u6237\uFF0C\u5982\u7981\u8A00\u3001\u79FB\u9664\u7528\u6237\u7B49\u64CD\u4F5C"),default:!1,required:[Ce.core.groupDetail]},{key:Ce.core.managePanel,title:(0,g.t)("\u5141\u8BB8\u7BA1\u7406\u9891\u9053"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u67E5\u770B\u7BA1\u7406\u9891\u9053"),default:!1,required:[Ce.core.groupDetail]},{key:Ce.core.manageInvite,title:(0,g.t)("\u5141\u8BB8\u7BA1\u7406\u9080\u8BF7\u94FE\u63A5"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u7BA1\u7406\u9080\u8BF7\u94FE\u63A5"),default:!1,required:[Ce.core.groupDetail]},{key:Ce.core.manageRoles,title:(0,g.t)("\u5141\u8BB8\u7BA1\u7406\u8EAB\u4EFD\u7EC4"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u7BA1\u7406\u8EAB\u4EFD\u7EC4"),default:!1,required:[Ce.core.groupDetail]},{key:Ce.core.deleteMessage,title:(0,g.t)("\u5220\u9664\u6D88\u606F"),desc:(0,g.t)("\u5141\u8BB8\u5220\u9664\u7528\u6237\u4FE1\u606F"),default:!1,required:[Ce.core.groupDetail]}];function $r(){return sr().filter(n=>n.default===!0).map(n=>n.key)}function bs(n){return Qs(this,null,function*(){yield Be.modifyGroupField(n,"fallbackPermissions",$r())})}var Gs=t(85848),Ys=t.n(Gs),Ks=(n,e,r)=>new Promise((s,u)=>{var m=f=>{try{D(r.next(f))}catch(w){u(w)}},I=f=>{try{D(r.throw(f))}catch(w){u(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,I);D((r=r.apply(n,e)).next())});function Js(n){return Ks(this,arguments,function*(e,r={}){const s=new FormData;s.append("file",e);const u=Tr().uploadFileLimit;if(e.size>u)throw U(`${(0,g.t)("\u4E0A\u4F20\u5931\u8D25, \u652F\u6301\u7684\u6587\u4EF6\u6700\u5927\u5927\u5C0F\u4E3A:")} ${Ys()(u,{base:2})}`),new Error("File Too Large");try{const{data:m}=yield S.W.post("/upload",s,{onUploadProgress(I){I.lengthComputable&&typeof r.onProgress=="function"&&r.onProgress(I.loaded/I.total,I)}});return m}catch(m){throw F(`${(0,g.t)("\u4E0A\u4F20\u5931\u8D25")}: ${(0,g.t)("\u53EF\u80FD\u662F\u6587\u4EF6\u4F53\u79EF\u8FC7\u5927")}`,"error"),console.error(`${(0,g.t)("\u4E0A\u4F20\u5931\u8D25")}: ${ft()(m,"message")}`),m}})}var Zs=t(58787)},11318:(x,P,t)=>{"use strict";t.d(P,{D3:()=>B,MG:()=>N,Nt:()=>y,_C:()=>W,g9:()=>j});var o=t(45563),l=t.n(o),a=t(85466),c=t.n(a),C=(E,S,O)=>new Promise((z,A)=>{var T=g=>{try{p(O.next(g))}catch(Y){A(Y)}},h=g=>{try{p(O.throw(g))}catch(Y){A(Y)}},p=g=>g.done?z(g.value):Promise.resolve(g.value).then(T,h);p((O=O.apply(E,S)).next())});function y(E,S){let O;return[(...T)=>{if(!O){if(l()(S))return S(...T);throw new Error(`${E} not regist`)}return O(...T)},T=>{O=T}]}function N(E,S){const[O,z]=y(E,S),A=[];return[O,p=>{z(p),A.forEach(g=>g(p))},p=>{A.push(p)}]}function L(E,S){const[O,z]=y(E,S);let A=null,T;function h(F){return A!==null&&_isEqual(F,T)}const p=(...F)=>{if(h(F))return A;{const G=O(...F);return A=G??null,T=F,G}},g=()=>{A=null};return[p,F=>{z(F),g()},g]}function j(E,S){const[O,z]=y(E,S);let A=null,T;function h(F){return A!==null&&c()(F,T)}const p=(...F)=>C(this,null,function*(){if(h(F))return A;{const G=yield O(...F);return A=G??null,T=F,G}}),g=()=>{A=null};return[p,F=>{z(F),g()},g]}function W(){const E=[];return[E,O=>{E.push(O)}]}function B(){const E={};return[E,(O,z)=>{E[O]&&console.warn("[buildRegMap] \u91CD\u590D\u6CE8\u518C:",O),E[O]=z}]}},71205:(x,P,t)=>{"use strict";t.d(P,{J7:()=>a,Jd:()=>l,Ov:()=>C,cs:()=>y,mx:()=>c});var o=t(11318);const[l,a]=(0,o.Nt)("requestErrorHook",()=>!0),[c,C,y]=(0,o.g9)("requestTokenGetter")},49076:(x,P,t)=>{"use strict";t.d(P,{A6:()=>c,YA:()=>a,qQ:()=>l});var o=t(11318);const[l,a,c]=(0,o.MG)("serverUrl",()=>window.location.origin)},54284:(x,P,t)=>{"use strict";t.d(P,{cF:()=>a,po:()=>c,y$:()=>y});var o=t(11318),l=t(52983);const[a,c]=(0,o.Nt)("storage"),C=new Map;function y(N,L){var j;const[W,B]=(0,l.useState)((j=C.get(N))!=null?j:L);(0,l.useLayoutEffect)(()=>{a().get(N).then(O=>{B(O??L),C.set(N,O??L)})},[N]);const E=(0,l.useCallback)(O=>{B(O),a().set(N,O),C.set(N,O)},[N]),S=(0,l.useCallback)(O=>{B(O),a().save(N,O),C.set(N,O)},[N]);return[W,{set:E,save:S}]}},22149:(x,P,t)=>{"use strict";t.d(P,{L1:()=>c,LB:()=>L,g3:()=>N,jW:()=>y,m8:()=>C,tv:()=>a});var o=t(72163),l=(j,W,B)=>new Promise((E,S)=>{var O=T=>{try{A(B.next(T))}catch(h){S(h)}},z=T=>{try{A(B.throw(T))}catch(h){S(h)}},A=T=>T.done?E(T.value):Promise.resolve(T.value).then(O,z);A((B=B.apply(j,W)).next())}),a=(j=>(j.DM="DM",j.Multi="Multi",j.Group="Group",j))(a||{});function c(j){return l(this,null,function*(){const{data:W}=yield o.W.post("/api/chat/converse/createDMConverse",{memberIds:j});return W})}function C(j,W){return l(this,null,function*(){const{data:B}=yield o.W.post("/api/chat/converse/appendDMConverseMembers",{converseId:j,memberIds:W});return B})}function y(j){return l(this,null,function*(){const{data:W}=yield o.W.get("/api/chat/converse/findConverseInfo",{params:{converseId:j}});return W})}function N(j,W){return l(this,null,function*(){yield o.W.post("/api/chat/ack/update",{converseId:j,lastMessageId:W})})}function L(){return l(this,null,function*(){const{data:j}=yield o.W.get("/api/chat/ack/all");return Array.isArray(j)?j:[]})}},19478:(x,P,t)=>{"use strict";t.r(P),t.d(P,{GroupPanelType:()=>l.Xp,appendGroupMemberRoles:()=>Y,applyGroupInvite:()=>se,createGroup:()=>z,createGroupInviteCode:()=>G,createGroupPanel:()=>je,createGroupRole:()=>Ae,deleteGroupInvite:()=>Ie,deleteGroupMember:()=>ye,deleteGroupPanel:()=>De,deleteGroupRole:()=>Le,editGroupInvite:()=>U,findGroupInviteByCode:()=>k,getAllGroupInviteCode:()=>J,getGroupBasicInfo:()=>A,getGroupConfigWithInfo:()=>O,getGroupPanelExtraData:()=>Oe,groupConfigNames:()=>S,isMember:()=>g,modifyGroupConfig:()=>h,modifyGroupField:()=>T,modifyGroupPanel:()=>ee,muteGroupMember:()=>xe,quitGroup:()=>p,removeGroupMemberRoles:()=>F,saveGroupPanelExtraData:()=>we,updateGroupRoleName:()=>Je,updateGroupRolePermission:()=>Pe});var o=t(72163),l=t(51208),a=Object.defineProperty,c=Object.defineProperties,C=Object.getOwnPropertyDescriptors,y=Object.getOwnPropertySymbols,N=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable,j=(Q,b,V)=>b in Q?a(Q,b,{enumerable:!0,configurable:!0,writable:!0,value:V}):Q[b]=V,W=(Q,b)=>{for(var V in b||(b={}))N.call(b,V)&&j(Q,V,b[V]);if(y)for(var V of y(b))L.call(b,V)&&j(Q,V,b[V]);return Q},B=(Q,b)=>c(Q,C(b)),E=(Q,b,V)=>new Promise((me,d)=>{var R=q=>{try{$(V.next(q))}catch(ae){d(ae)}},K=q=>{try{$(V.throw(q))}catch(ae){d(ae)}},$=q=>q.done?me(q.value):Promise.resolve(q.value).then(R,K);$((V=V.apply(Q,b)).next())});const S=["hideGroupMemberDiscriminator","disableCreateConverseFromGroup","groupBackgroundImage"];function O(Q){var b,V,me;const d=(b=Q==null?void 0:Q.config)!=null?b:{};return B(W({},d),{hideGroupMemberDiscriminator:(V=d.hideGroupMemberDiscriminator)!=null?V:!1,disableCreateConverseFromGroup:(me=d.disableCreateConverseFromGroup)!=null?me:!1})}function z(Q,b){return E(this,null,function*(){const{data:V}=yield o.W.post("/api/group/createGroup",{name:Q,panels:b});return V})}function A(Q){return E(this,null,function*(){const{data:b}=yield o.W.get("/api/group/getGroupBasicInfo",{params:{groupId:Q}});return b})}function T(Q,b,V){return E(this,null,function*(){yield o.W.post("/api/group/updateGroupField",{groupId:Q,fieldName:b,fieldValue:V})})}function h(Q,b,V){return E(this,null,function*(){yield o.W.post("/api/group/updateGroupConfig",{groupId:Q,configName:b,configValue:V})})}function p(Q){return E(this,null,function*(){yield o.W.post("/api/group/quitGroup",{groupId:Q})})}function g(Q){return E(this,null,function*(){const{data:b}=yield o.W.post("/api/group/isMember",{groupId:Q});return b})}function Y(Q,b,V){return E(this,null,function*(){yield o.W.post("/api/group/appendGroupMemberRoles",{groupId:Q,memberIds:b,roles:V})})}function F(Q,b,V){return E(this,null,function*(){yield o.W.post("/api/group/removeGroupMemberRoles",{groupId:Q,memberIds:b,roles:V})})}function G(Q,b){return E(this,null,function*(){const{data:V}=yield o.W.post("/api/group/invite/createGroupInvite",{groupId:Q,inviteType:b});return V})}function U(Q,b,V,me){return E(this,null,function*(){yield o.W.post("/api/group/invite/editGroupInvite",{groupId:Q,code:b,expiredAt:V,usageLimit:me})})}function J(Q){return E(this,null,function*(){const{data:b}=yield o.W.get("/api/group/invite/getAllGroupInviteCode",{params:{groupId:Q}});return b})}function k(Q){return E(this,null,function*(){const{data:b}=yield o.W.get("/api/group/invite/findInviteByCode",{params:{code:Q}});return b})}function se(Q){return E(this,null,function*(){yield o.W.post("/api/group/invite/applyInvite",{code:Q})})}function Ie(Q,b){return E(this,null,function*(){yield o.W.post("/api/group/invite/deleteInvite",{groupId:Q,inviteId:b})})}function je(Q,b){return E(this,null,function*(){yield o.W.post("/api/group/createGroupPanel",B(W({},b),{groupId:Q}))})}function ee(Q,b,V){return E(this,null,function*(){yield o.W.post("/api/group/modifyGroupPanel",B(W({},V),{groupId:Q,panelId:b}))})}function De(Q,b){return E(this,null,function*(){yield o.W.post("/api/group/deleteGroupPanel",{groupId:Q,panelId:b})})}function Ae(Q,b,V){return E(this,null,function*(){yield o.W.post("/api/group/createGroupRole",{groupId:Q,roleName:b,permissions:V})})}function Le(Q,b){return E(this,null,function*(){yield o.W.post("/api/group/deleteGroupRole",{groupId:Q,roleId:b})})}function Je(Q,b,V){return E(this,null,function*(){yield o.W.post("/api/group/updateGroupRoleName",{groupId:Q,roleId:b,roleName:V})})}function Pe(Q,b,V){return E(this,null,function*(){yield o.W.post("/api/group/updateGroupRolePermission",{groupId:Q,roleId:b,permissions:V})})}function xe(Q,b,V){return E(this,null,function*(){yield o.W.post("/api/group/muteGroupMember",{groupId:Q,memberId:b,muteMs:V})})}function ye(Q,b){return E(this,null,function*(){yield o.W.post("/api/group/deleteGroupMember",{groupId:Q,memberId:b})})}function Oe(Q,b,V){return E(this,null,function*(){var me;const{data:d}=yield o.W.post("/api/group/extra/getPanelData",{groupId:Q,panelId:b,name:V});return(me=d.data)!=null?me:null})}function we(Q,b,V,me){return E(this,null,function*(){yield o.W.post("/api/group/extra/savePanelData",{groupId:Q,panelId:b,name:V,data:typeof me=="string"?me:JSON.stringify(me)})})}},75135:(x,P,t)=>{"use strict";t.d(P,{c0:()=>a,g3:()=>c,zd:()=>C});var o=t(72163),l=(y,N,L)=>new Promise((j,W)=>{var B=O=>{try{S(L.next(O))}catch(z){W(z)}},E=O=>{try{S(L.throw(O))}catch(z){W(z)}},S=O=>O.done?j(O.value):Promise.resolve(O.value).then(B,E);S((L=L.apply(y,N)).next())});function a(){return l(this,null,function*(){const{data:y}=yield o.W.get("/api/plugin/registry/list");return y})}function c(){return l(this,null,function*(){const{data:y}=yield o.W.get("/registry-be.json");return y})}function C(){return l(this,null,function*(){const{data:y}=yield o.W.get("/registry.json",{baseURL:""});return y})}},77100:(x,P,t)=>{"use strict";t.r(P),t.d(P,{appendUserDMConverse:()=>ye,checkTokenValid:()=>me,claimTemporaryUser:()=>De,createTemporaryUser:()=>ee,fetchUserInfo:()=>Je,forgetPassword:()=>Ie,getUserOnlineStatus:()=>xe,getUserSettings:()=>b,loginWithEmail:()=>F,loginWithToken:()=>G,modifyUserExtra:()=>Q,modifyUserField:()=>we,modifyUserPassword:()=>se,pickUserBaseInfo:()=>g,registerWithEmail:()=>k,removeUserDMConverse:()=>Oe,resetPassword:()=>je,searchUserWithUniqueName:()=>Ae,setUserSettings:()=>V,verifyEmail:()=>U,verifyEmailWithOTP:()=>J});var o=t(72163),l=t(96393),a=t(99852),c=t(81281),C=t(11286),y=t.n(C),N=t(62923),L=t.n(N),j=(d,R,K)=>new Promise(($,q)=>{var ae=Z=>{try{ie(K.next(Z))}catch(te){q(te)}},fe=Z=>{try{ie(K.throw(Z))}catch(te){q(te)}},ie=Z=>Z.done?$(Z.value):Promise.resolve(Z.value).then(ae,fe);ie((K=K.apply(d,R)).next())});function W(d,R=200){let K=[],$=null;function q(){return j(this,null,function*(){$=null;const ae=[...K];K=[];try{const fe=yield d(ae.map(ie=>ie.params));ae.forEach((ie,Z)=>{ie.resolve(fe[Z])})}catch(fe){ae.forEach(ie=>{ie.reject(fe)})}})}return ae=>($||($=window.setTimeout(()=>{q()},R)),new Promise((fe,ie)=>{K.push({params:ae,resolve:fe,reject:ie})}))}function B(d,R,K=100){return $=>j(this,null,function*(){const q=y()($,K);if(R==="serial"){const ae=[];for(const fe of q){const ie=yield d(fe);Array.isArray(ie)?ae.push(...ie):console.warn("[createAutoSplitRequest] fn should be return array")}return ae}else if(R==="parallel"){const ae=yield Promise.all(q.map(fe=>d(fe)));return L()(ae)}return[]})}var E=t(49335),S=t.n(E),O=t(90292),z=t.n(O),A=t(54142),T=t.n(A),h=t(19692),p=(d,R,K)=>new Promise(($,q)=>{var ae=Z=>{try{ie(K.next(Z))}catch(te){q(te)}},fe=Z=>{try{ie(K.throw(Z))}catch(te){q(te)}},ie=Z=>Z.done?$(Z.value):Promise.resolve(Z.value).then(ae,fe);ie((K=K.apply(d,R)).next())});function g(d){return S()(d,["_id","email","nickname","discriminator","avatar","temporary","emailVerified","banned"])}const Y={[c.q6]:()=>({_id:c.q6,email:"admin@msgbyte.com",nickname:(0,h.t)("\u7CFB\u7EDF"),discriminator:"0000",avatar:null,temporary:!1,emailVerified:!1,banned:!1})};function F(d,R){return p(this,null,function*(){const{data:K}=yield o.W.post("/api/user/login",{email:d,password:R});return a.A.emit("loginSuccess",g(K)),K})}function G(d){return p(this,null,function*(){const{data:R}=yield o.W.post("/api/user/resolveToken",{token:d});return a.A.emit("loginSuccess",g(R)),R})}function U(d){return p(this,null,function*(){const{data:R}=yield o.W.post("/api/user/verifyEmail",{email:d});return R})}function J(d){return p(this,null,function*(){const{data:R}=yield o.W.post("/api/user/verifyEmailWithOTP",{emailOTP:d});return R})}function k(d){return p(this,arguments,function*({email:R,password:K,nickname:$,emailOTP:q}){const{data:ae}=yield o.W.post("/api/user/register",{email:R,nickname:$,password:K,emailOTP:q});return ae})}function se(d,R){return p(this,null,function*(){yield o.W.post("/api/user/modifyPassword",{oldPassword:d,newPassword:R})})}function Ie(d){return p(this,null,function*(){yield o.W.post("/api/user/forgetPassword",{email:d})})}function je(d,R,K){return p(this,null,function*(){yield o.W.post("/api/user/resetPassword",{email:d,password:R,otp:K})})}function ee(d){return p(this,null,function*(){const{data:R}=yield o.W.post("/api/user/createTemporaryUser",{nickname:d});return R})}function De(d,R,K,$){return p(this,null,function*(){const{data:q}=yield o.W.post("/api/user/claimTemporaryUser",{userId:d,email:R,password:K,emailOTP:$});return q})}function Ae(d){return p(this,null,function*(){const{data:R}=yield o.W.post("/api/user/searchUserWithUniqueName",{uniqueName:d});return R})}const Le=W(B(d=>p(void 0,null,function*(){const{data:R}=yield o.W.post("/api/user/getUserInfoList",{userIds:d});return R}),"serial",1e3));function Je(d){return p(this,null,function*(){return Y[d]&&typeof Y[d]=="function"?Y[d]():yield Le(d)})}const Pe=W(B(d=>p(void 0,null,function*(){const R=z()(L()(d)),{data:K}=yield o.W.post("/api/gateway/checkUserOnline",{userIds:R}),$=T()(R,K);return d.map(q=>q.map(ae=>{var fe;return(fe=$[ae])!=null?fe:!1}))}),"serial",1e3));function xe(d){return p(this,null,function*(){return Pe(d)})}function ye(d){return p(this,null,function*(){const{data:R}=yield o.W.post("/api/user/dmlist/addConverse",{converseId:d});return R})}function Oe(d){return p(this,null,function*(){const{data:R}=yield o.W.post("/api/user/dmlist/removeConverse",{converseId:d});return R})}function we(d,R){return p(this,null,function*(){const{data:K}=yield o.W.post("/api/user/updateUserField",{fieldName:d,fieldValue:R});return K})}function Q(d,R){return p(this,null,function*(){const{data:K}=yield o.W.post("/api/user/updateUserExtra",{fieldName:d,fieldValue:R});return K})}function b(){return p(this,null,function*(){const{data:d}=yield o.W.get("/api/user/getUserSettings");return a.A.emit("userSettingsUpdate",d),d})}function V(d){return p(this,null,function*(){const{data:R}=yield o.W.post("/api/user/setUserSettings",{settings:d});return R})}const me=(0,l.w)("tokenValid",d=>p(void 0,null,function*(){const{data:R}=yield o.W.post("/api/user/checkTokenValid",{token:d});return R}))},84966:(x,P,t)=>{"use strict";t.d(P,{CG:()=>l,TL:()=>a});var o=t(99698);function l(C,y){return(0,o.v9)(C,y)}const a=o.I0;function c(){return useStore()}},95850:(x,P,t)=>{"use strict";t.d(P,{T:()=>C,x:()=>y});var o=t(52983),l=t(96228),a=t(518),c=t(84966);function C(N){const L=(0,c.CG)(j=>{var W;return(W=j.user.friends.find(B=>B.id===N))==null?void 0:W.nickname});return(0,a.YQ)(L)?L:null}function y(){const N=(0,c.CG)(j=>j.user.friends);return(0,o.useMemo)(()=>(0,l.No)(N),[N])}},81281:(x,P,t)=>{"use strict";t.d(P,{Px:()=>l,Xb:()=>c,q6:()=>a});const o=/^([0-9a-zA-Z]{1,2}|[\u4e00-\u9eff]|[\u3040-\u309F]|[\u30A0-\u30FF]){1,8}$/,l="i18n:language",a="000000000000000000000000",c={uploadFileLimit:1*1024*1024,emailVerification:!1,serverName:"Tailchat",disableUserRegister:!1,disableGuestLogin:!1,disableCreateGroup:!1,disablePluginStore:!1,disableAddFriend:!1,announcement:!1}},518:(x,P,t)=>{"use strict";t.d(P,{AJ:()=>B,YQ:()=>W});var o=t(76705),l=t.n(o),a=t(66659),c=t.n(a);function C(E){return typeof E=="string"&&E.length>0}function y(E){return urlRegex({exact:!0}).test(E)}const N=E=>_isString(E)&&E.startsWith("blob:"),L=E=>{var S;return(S=E.match(urlRegex()))!=null?S:[]};function j(E){return!!E&&E!=="0"&&E!=="false"}function W(E){return typeof E=="string"&&E!==""}function B(E){return typeof E!="string"?!1:E.startsWith("localMessage_")}},58787:(x,P,t)=>{"use strict";t.d(P,{A:()=>l});var o=t(49076);function l(a){return String(a).replace("{BACKEND}",(0,o.qQ)()).replace("%7BBACKEND%7D",(0,o.qQ)())}},70877:(x,P,t)=>{"use strict";t.d(P,{_:()=>c,c:()=>a});var o=t(52983),l=t(54782);let a=()=>{throw new Error("route navigate not init")};const c=o.memo(()=>(a=(0,l.useNavigate)(),null));c.displayName="AppRouterApi"},67706:(x,P,t)=>{"use strict";t.d(P,{S:()=>y});var o=t(75526),l=t(52983),a=t(98281),c=t(6739);const C={error:void 0,info:{componentStack:""}};class y extends l.Component{constructor(){super(...arguments);this.state=C,this.reset=()=>{this.setState(C)}}componentDidCatch(L,j){this.setState({error:L,info:j})}render(){const{message:L,description:j,children:W}=this.props,{error:B,info:E}=this.state,S=E&&E.componentStack?E.componentStack:null,O=typeof L=="undefined"?(B||"").toString():L,z=typeof j=="undefined"?S:j;return B?l.createElement(c.t,{text:l.createElement(l.Fragment,null,l.createElement("h3",null,(0,a.t)("\u9875\u9762\u51FA\u73B0\u4E86\u4E00\u4E9B\u95EE\u9898")),l.createElement("p",{title:z??""},O),l.createElement(o.Z,{size:"small",onClick:this.reset},(0,a.t)("\u91CD\u8BD5")))}):W}}},80474:(x,P,t)=>{"use strict";t.d(P,{P:()=>T});var o=t(52983),l=t(2697),a=t(23463),c=t(38887),C=t(98281),y=t(170),N=t(61422),L=t.n(N),j=Object.defineProperty,W=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable,S=(h,p,g)=>p in h?j(h,p,{enumerable:!0,configurable:!0,writable:!0,value:g}):h[p]=g,O=(h,p)=>{for(var g in p||(p={}))B.call(p,g)&&S(h,g,p[g]);if(W)for(var g of W(p))E.call(p,g)&&S(h,g,p[g]);return h};function z(h,p){const g=new Date().valueOf();return h.then(Y=>{const F=new Date().valueOf();return console.debug(`[Loadable] load ${p} usage: ${F-g}ms`),Y})}function A(h){const p=L()("Loadable");return y.ZP.loading({content:(0,C.t)("\u52A0\u8F7D\u4E2D..."),key:p,duration:0}),h.then(g=>(y.ZP.destroy(p),g))}function T(h,p){return(0,l.ZP)(g=>{let Y=h(g);return(0,C.YQu)(p==null?void 0:p.componentName)&&(Y=z(Y,String(p==null?void 0:p.componentName))),(p==null?void 0:p.showLoading)===!0&&(Y=A(Y)),(0,a.Z)(Y,200,{delayRejection:!1})},O({fallback:o.createElement(c.T,null)},p))}},38887:(x,P,t)=>{"use strict";t.d(P,{T:()=>c});var o=t(52983),l=t(98281),a=t(67434);const c=o.memo(C=>{var y;return o.createElement("div",null,o.createElement(a.$,null),(y=C.tip)!=null?y:(0,l.t)("\u52A0\u8F7D\u4E2D..."))});c.displayName="LoadingSpinner"},84208:(x,P,t)=>{"use strict";t.d(P,{AB:()=>d,Mr:()=>Oe,VW:()=>b,_5:()=>Q,aW:()=>V,h7:()=>we,vR:()=>me});var o=t(52983),l=t(45563),a=t.n(l),c=t(14698),C=t.n(c),y=t(77875),N=t.n(y),L=t(69966),j=t.n(L),W=t(76705),B=t.n(W),E=t(71607),S=t.n(E),O=t(442),z=t(75526),A=t(75283),T=t(93540),h=t(29603),p=t(14517),g=t(89935),Y=t(22398),F=t(67706),G=t(98281),U=Object.defineProperty,J=Object.defineProperties,k=Object.getOwnPropertyDescriptors,se=Object.getOwnPropertySymbols,Ie=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable,ee=(R,K,$)=>K in R?U(R,K,{enumerable:!0,configurable:!0,writable:!0,value:$}):R[K]=$,De=(R,K)=>{for(var $ in K||(K={}))Ie.call(K,$)&&ee(R,$,K[$]);if(se)for(var $ of se(K))je.call(K,$)&&ee(R,$,K[$]);return R},Ae=(R,K)=>J(R,k(K)),Le=(R,K,$)=>new Promise((q,ae)=>{var fe=te=>{try{Z($.next(te))}catch(le){ae(le)}},ie=te=>{try{Z($.throw(te))}catch(le){ae(le)}},Z=te=>te.done?q(te.value):Promise.resolve(te.value).then(fe,ie);Z(($=$.apply(R,K)).next())});const Je=(R,K)=>R.addEventListener("transitionend",K,!1),Pe=o.createContext({closeModal:S()}),xe=o.memo(R=>{const{visible:K,onChangeVisible:$,closable:q=!1,maskClosable:ae=!0}=R,[fe,ie]=(0,o.useState)(!0),Z=(0,o.useCallback)(()=>{ie(!1)},[]),te=(0,o.useCallback)(()=>{ae!==!1&&Z()},[ae,Z]);return K===!1?null:o.createElement(h.Z,{in:fe,classNames:"modal-anim",timeout:200,addEndListener:Je,onExited:()=>{fe===!1&&a()($)&&$(!1)},appear:!0},o.createElement("div",{className:"absolute left-0 right-0 top-0 bottom-0 bg-black bg-opacity-60 flex justify-center items-center z-10",onClick:te,"data-tc-role":"modal-mask"},o.createElement(Pe.Provider,{value:{closeModal:Z}},o.createElement("div",{className:"modal-inner bg-content-light dark:bg-content-dark rounded overflow-auto relative z-10",style:{maxHeight:"80vh",maxWidth:"80vw"},onClick:Y.UW,"data-tc-role":"modal"},q===!0&&o.createElement(T.JO,{className:"absolute right-2.5 top-3.5 text-xl z-10 cursor-pointer",icon:"mdi:close",onClick:Z}),o.createElement(F.S,null,R.children)))))});xe.displayName="Modal";const ye=[];function Oe(R){C()(R)&&(R=N()(ye)),typeof R=="number"&&(j()(ye,R),(0,O.i6)(R))}function we(R,K){const $=(0,O.rk)(o.createElement(xe,Ae(De({},K),{visible:!0,onChangeVisible:q=>Le(this,null,function*(){q===!1&&(typeof(K==null?void 0:K.onCloseModal)=="function"&&(yield K.onCloseModal()),Oe($))})}),R));return ye.push($),$}function Q(R){var K;const $=we(o.createElement(d,{title:(K=R.title)!=null?K:(0,G.t)("\u786E\u8BA4\u64CD\u4F5C")},o.createElement("h3",{className:"text-center pb-6"},R.content),o.createElement("div",{className:"space-x-2 text-right"},o.createElement(z.Z,{onClick:()=>{var q;(q=R.onCancel)==null||q.call(R),Oe($)}},(0,G.t)("\u53D6\u6D88")),o.createElement(z.Z,{type:"primary",onClick:()=>{R.onConfirm(),Oe($)}},(0,G.t)("\u786E\u8BA4")))),{onCloseModal:R.onCancel})}function b(R){var K,$;Q({onConfirm:R.onConfirm,onCancel:R.onCancel,title:(K=R.title)!=null?K:(0,G.t)("\u786E\u8BA4\u8981\u8FDB\u884C\u8BE5\u64CD\u4F5C\u4E48?"),content:($=R.content)!=null?$:(0,G.t)("\u8BE5\u64CD\u4F5C\u65E0\u6CD5\u88AB\u64A4\u56DE")})}function V(R){return new Promise(K=>{b(Ae(De({},R),{onConfirm:()=>K(!0),onCancel:()=>K(!1)}))})}function me(){const{closeModal:R}=(0,o.useContext)(Pe);return{closeModal:R}}const d=o.memo(R=>{const K=(0,g.d)(),$=B()(R.title)?o.createElement(A.Z.Title,{level:4,className:"text-center mb-4"},R.title):null;return o.createElement("div",{className:(0,p.Z)("tc-modal","p-4",R.className),style:De({minWidth:K?290:420},R.style)},$,R.children)});d.displayName="ModalWrapper"},442:(x,P,t)=>{"use strict";t.d(P,{$2:()=>c,i6:()=>N,rk:()=>y});var o=t(52983),l=t(98281);const a=new l.QEo,{PortalHost:c,PortalRender:C,add:y,remove:N}=(0,l.x9K)({hostName:"default",eventEmitter:a,renderManagerView:L=>o.createElement("div",{className:"z-10"},L)})},6739:(x,P,t)=>{"use strict";t.d(P,{t:()=>C});var o=t(52983);const l="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8cGF0aCBkPSJNMjE1Ljc1MSAxMzMuOTM4TDIxNS41NzcgMTM0LjA3N0wyMTUuNDM4IDEzNC4yNTFDMjEzLjg0OCAxMzYuMjM4IDIxMS4yNSAxMzkuMDA0IDIwOC40NDggMTQxLjI1M0MyMDcuMDQ5IDE0Mi4zNzYgMjA1LjY0MiAxNDMuMzM1IDIwNC4zMiAxNDQuMDA2QzIwMi45NzcgMTQ0LjY4NyAyMDEuODU5IDE0NSAyMDEgMTQ1QzE5OC43NTcgMTQ1IDE5Ny4zNTMgMTQ0LjQ3MiAxOTYuMjgzIDE0My43MzFDMTk1LjE0IDE0Mi45MzkgMTk0LjIzOSAxNDEuODE4IDE5My4xIDE0MC4zQzE5Mi4xNDYgMTM5LjAyNyAxOTAuNDUxIDEzNy42MjcgMTg4LjUxMSAxMzYuMzAyQzE4Ni41MjIgMTM0Ljk0MyAxODQuMTA2IDEzMy41NSAxODEuNTU0IDEzMi4zMjNDMTc5LjAwNSAxMzEuMDk3IDE3Ni4yODEgMTMwLjAxNiAxNzMuNjc1IDEyOS4zMDVDMTcxLjEwMiAxMjguNjAyIDE2OC40OTIgMTI4LjIxNyAxNjYuMjM2IDEyOC41MThDMTU5LjU1OCAxMjkuNDA4IDE1NS45NTQgMTI5LjM3NiAxNTQuMDEgMTI5LjA3MkMxNTMuMDU0IDEyOC45MjMgMTUyLjU5OCAxMjguNzIxIDE1Mi4zOTkgMTI4LjYwNUMxNTIuMjQ4IDEyOC41MTcgMTUyLjIxMSAxMjguNDYxIDE1Mi4xNjYgMTI4LjM5NEwxNTIuMTY0IDEyOC4zOTFMMTUxLjg5MSAxMjcuOThMMTUxLjQ1OCAxMjcuNzQ0QzE1MS4xMjQgMTI3LjU2MiAxNTAuNjY1IDEyNy4wMzggMTUwLjMyNyAxMjUuNTdDMTUwIDEyNC4xNDkgMTQ5Ljg4NyAxMjIuMjg0IDE0OS44NSAxMjAuMDY2QzE0OS44MzYgMTE5LjI1OCAxNDkuODM0IDExOC40MDIgMTQ5LjgzMSAxMTcuNTE2QzE0OS44MjEgMTEzLjg3MyAxNDkuODA5IDEwOS43MjYgMTQ5LjAxMSAxMDYuMzA4QzE0OS4wMjUgMTA1LjY0MiAxNDguOTMgMTA0Ljc1NiAxNDguNDM2IDEwMy45OUMxNDguMTA1IDEwMy40NzcgMTQ3LjU4OSAxMDMuMDE1IDE0Ni44NzMgMTAyLjc5M0MxNDYuMTg3IDEwMi41ODEgMTQ1LjUxMyAxMDIuNjUxIDE0NC45NDIgMTAyLjgyMUMxNDMuODY0IDEwMy4xNDIgMTQyLjczMyAxMDMuOTQ1IDE0MS41MjYgMTA1LjA3QzE0MC4yNzMgMTA2LjIzNyAxMzguNzYgMTA3LjkyMyAxMzYuOTI1IDExMC4yNjdDMTI5LjU3IDExOS42NjUgMTIwLjY4OSAxMzcuMTUyIDExNy4xODggMTQ0LjY1NEwxMTcuMTMgMTQ0Ljc3N0wxMTcuMDkgMTQ0LjkwNkMxMTYuNzUgMTQ1Ljk5OCAxMTYuMzAyIDE0Ny4yODggMTE1LjggMTQ4LjcyOUMxMTQuNjkgMTUxLjkyMSAxMTMuMzIxIDE1NS44NTYgMTEyLjMwNyAxNjAuMDI4QzExMC44MTEgMTY2LjE4MiAxMDkuOTU1IDE3My4yNjggMTExLjU0OCAxODAuNDM0QzExNC4yMSAxOTIuNDE3IDEyMy4zODQgMjAzLjU4OCAxMzAuODg1IDIxMC4zMDJDMTMwLjE1OSAyMTUuMjQ1IDEyNy45MiAyMTkuNzUxIDEyNC45NzMgMjI0LjY0OUMxMjQuMTEgMjI2LjA4NCAxMjMuMTggMjI3LjU2MSAxMjIuMjE2IDIyOS4wOUMxMTkuNzMzIDIzMy4wMzQgMTE3LjAzMSAyMzcuMzI0IDExNC43MDEgMjQyLjEyN0MxMTAuNjMgMjUwLjUxNyAxMDYuNjg3IDI1OC40MzUgMTAyLjkxIDI2Ni4wMTlDOTIuMTYxNyAyODcuNjAxIDgyLjc2MSAzMDYuNDc3IDc1LjYyMzggMzI1LjgwN0M2My41Mjk1IDM1OC41NjMgNjAuNDcxMiAzOTQuMzgzIDYyLjUxNDYgNDExLjI0MUM2NC41NzE5IDQyOC4yMTQgNzUuMzQ5OCA0NTQuNDExIDEwMy4xMDYgNDY4LjI4OUMxMjQuMTEgNDc4Ljc5MSAxNDEuNjEzIDQ4MS40NzQgMTQ4Ljc0OSA0ODEuNTA4QzE1NS4zOTYgNDg3LjI0OSAxNzIuOTE4IDQ5Ny40NzUgMTk1LjkxNSA0OTcuNUMyMTAuMzE3IDQ5OC43MDkgMjI5LjQwNCA0OTMuOTE4IDIzNy4xMiA0OTEuNDAxTDIzNy4yMzQgNDkxLjM2NEwyMzcuMzQzIDQ5MS4zMTRMMzA4LjI5NyA0NTguMzM1QzMxMy45MjQgNDU2LjA1NiAzMjMuMjYyIDQ1My4xNDQgMzMyLjkzMSA0NTEuODMyQzM0Mi43MTYgNDUwLjUwNCAzNTIuMzk0IDQ1MC44NzkgMzU4Ljk5MiA0NTQuNzI4QzM2Ny45MDEgNDU5LjkyNCAzNzEuNDg5IDQ2My4yNTIgMzczLjU1OCA0NjYuMTZDMzc0LjYwNiA0NjcuNjMyIDM3NS4zMDcgNDY5LjA1NCAzNzYuMTMxIDQ3MC43NDlMMzc2LjE4MyA0NzAuODU2QzM3Ni45ODkgNDcyLjUxNiAzNzcuOTAzIDQ3NC4zOTUgMzc5LjMyMSA0NzYuNTg3QzM4Mi4yNzkgNDgxLjE1OCAzODYuNjc0IDQ4NC44MDMgMzkxLjg1OSA0ODYuMDFDMzk3LjEzNyA0ODcuMjM5IDQwMi45MTUgNDg1Ljg2NyA0MDguMzM4IDQ4MC45ODdDNDEyLjk1OSA0NzYuODI3IDQxMy44NzggNDcxLjUwOSA0MTMuMjMyIDQ2Ni43NzlDNDEyLjYxNCA0NjIuMjYgNDEwLjU2NSA0NTguMTI4IDQwOC43OTUgNDU1LjU3NkM0MDYuMjYyIDQ0OC41NDcgMzk1LjkxMiA0MzIuODcyIDM3My40MiA0MjEuMjI0QzM2MS42NjYgNDE1LjEzNyAzNDYuMDc3IDQxNC44MjYgMzMxLjY1MSA0MTYuNzNDMzE3LjE1OCA0MTguNjQyIDMwMy40NyA0MjIuODQxIDI5NS4yNTQgNDI2LjE0NEwyOTUuMTczIDQyNi4xNzdMMjk1LjA5NiA0MjYuMjE2QzI4MC45NzEgNDMzLjM3OCAyNjMuOTExIDQ0MC43MjYgMjQ4LjYzMyA0NDYuNTk2QzIzMy4zMDMgNDUyLjQ4NSAyMTkuOTQgNDU2LjgxOCAyMTMuMTQ4IDQ1OC4wMzFDMjEyLjUzNiA0NTguMTQxIDIxMS45NjMgNDU4LjI1NSAyMTEuMzk1IDQ1OC4zNjdDMjA5LjUyNSA0NTguNzM5IDIwNy43MTggNDU5LjA5OSAyMDQuNzgxIDQ1OS4yMzdDMjAxLjI3OCA0NTkuNDAyIDE5Ni4xODcgNDU5LjI0MiAxODcuNzcyIDQ1OC4zMDdDMTkwLjQwMyA0NTAuNDk0IDE5MS4zNDQgNDQwLjE0OSAxOTEuNDk4IDQzNS41ODlDMTkyLjAwMyA0MjYuNDcyIDE5MS40OTkgNDE5Ljk1NyAxOTAuNzI0IDQxNS4yMzhDMTkwLjA5NCA0MTEuNDA4IDE4OS4yOCA0MDguNzU5IDE4OC43NDQgNDA3LjAxNUMxODguNjIgNDA2LjYxMyAxODguNTExIDQwNi4yNTkgMTg4LjQyMyA0MDUuOTUxQzE4Ni41NDEgMzk5LjM2MiAxNzcuNDQyIDM2OS41MSAxNzIuNDE1IDM1NS40MTVDMTcwLjk5NiAzNDkuODU4IDE2OS4yNzYgMzQ0LjAxNyAxNjcuNDU0IDMzNy44MzFDMTYzLjYyMSAzMjQuODE4IDE1OS4zNCAzMTAuMjggMTU2LjQ3MSAyOTMuNjZDMTU1Ljk1MyAyOTAuNjYxIDE1NS40NTEgMjg3LjkwNCAxNTQuOTc4IDI4NS4zMDRDMTUyLjgwMyAyNzMuMzY1IDE1MS4yMjkgMjY0LjcyIDE1MS41IDI1MS4wNEMxNTEuNjg1IDI0MS42NyAxNTIuNDk2IDIzMi43NSAxNTMuNzM3IDIyNy40NTdDMTU0LjM1NyAyMjQuODE0IDE1NS4wMTMgMjIzLjQ3MyAxNTUuNjM4IDIyMi43MjlDMTU2LjE0OCAyMjIuMTIxIDE1Ni43NDYgMjIxLjc4MSAxNTcuNzI2IDIyMS41MDlDMTcyLjYzNSAyMjEuOTk5IDE4Ny42ODUgMjIxLjk4NiAyMDIuMiAyMTEuMUMyMDguMTY1IDIwNi42MjYgMjEyLjY3IDE5OS43NiAyMTUuODc0IDE5My4xNjFDMjE5LjA5IDE4Ni41MzcgMjIxLjA5MSAxNzkuOTgyIDIyMS45NTYgMTc1LjkxNkwyMjEuOTcxIDE3NS44NDdMMjIxLjk4MSAxNzUuNzc2QzIyMi45NzUgMTY4LjY1IDIyNSAxNTIuNDY3IDIyNSAxNDUuNUMyMjUgMTQyLjAxIDIyNC43NDQgMTM5LjUgMjI0LjQgMTM3Ljc1MUMyMjQuMjI4IDEzNi44NzggMjI0LjAyOSAxMzYuMTY2IDIyMy44MTQgMTM1LjYwNEMyMjMuNjI0IDEzNS4xMDggMjIzLjM0NyAxMzQuNTE4IDIyMi45MTQgMTM0LjA4NkMyMjEuNTk3IDEzMi43NjggMjIwLjAxNSAxMzIuNDggMjE4LjY4MSAxMzIuNjdDMjE3LjQzNSAxMzIuODQ3IDIxNi4zODUgMTMzLjQzMSAyMTUuNzUxIDEzMy45MzhaIiBmaWxsPSIjNDIzQzNDIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjQiLz4NCjxwYXRoIGQ9Ik0zOTYuMjkzIDE4OS44MjJMMzk2LjMwMSAxODkuODE2TDM5Ni4zMDkgMTg5LjgxQzQwMC44MDcgMTg2LjU1NCA0MDQuODk0IDE4Mi41ODIgNDA4LjU3NSAxNzcuOTA4QzQxMi40MTggMTczLjEzIDQxNS42MDEgMTY3LjQ1OSA0MTguMTQxIDE2MC45MjNDNDIxLjQ0MyAxNTIuNDMxIDQyMi42NDEgMTQzLjg1OSA0MjEuNzA4IDEzNS4yM0M0MjAuODY1IDEyNi42NjQgNDE4LjEyMiAxMTguNTY2IDQxMy41IDExMC45NTJDNDA4LjkxNyAxMDMuMjU3IDQwMi41OTUgOTYuMjY1IDM5NC41NzggODkuOTY2QzM4Ni42NjEgODMuNTk3MSAzNzcuMzI0IDc4LjMzNDEgMzY2LjU5MSA3NC4xNjE2QzM1OS43NjggNzEuNTA5NCAzNTIuNDAyIDY5Ljc4MjggMzQ0LjUwMyA2OC45NzFMMzQ0LjQ5NiA2OC45NzAzQzMzNi42NDQgNjguMTg5MSAzMjkuMDE4IDY4LjYzNjYgMzIxLjYyNyA3MC4zMjE1QzMxNC4yMTUgNzEuOTMxMyAzMDcuNDM0IDc0Ljk5MjQgMzAxLjI5OSA3OS40OTYyTDMwMS4yOTEgNzkuNTAyN0wzMDEuMjgyIDc5LjUwOTJDMjk1LjEyNSA4NC4xMzM2IDI5MC41MjMgOTAuNDQxNCAyODcuNDQ5IDk4LjM0ODNDMjg1LjI4NiAxMDMuOTEzIDI4NC4xNDIgMTA4Ljk3NiAyODQuMTExIDExMy41MDZMMjg0LjExMSAxMTMuNTI2TDI4NC4xMTIgMTEzLjU0N0MyODQuMTcyIDExNy45MDkgMjg0LjYyOSAxMjEuNzI5IDI4NS41MTYgMTI0Ljk3NkwyODUuNTI3IDEyNS4wMTZMMjg1LjU0IDEyNS4wNTZDMjg2LjUxOCAxMjguMTI1IDI4Ny42IDEzMC42MjYgMjg4LjgyMyAxMzIuNDdMMjg4Ljg0NSAxMzIuNTA0TDI4OC44NjggMTMyLjUzN0MyODkuNDI2IDEzMy4zMDggMjg5Ljg2NSAxMzMuOTExIDI5MC4xODUgMTM0LjM0NEMyOTAuMzcyIDEzNC41OTYgMjkwLjU1MSAxMzQuODM3IDI5MC42OTYgMTM1LjAyQzI5MS4yMTggMTM1Ljk3OCAyOTEuODU4IDEzNi44MyAyOTIuNjY3IDEzNy40NDNMMjkyLjY5NCAxMzcuNDY0TDI5Mi43MjEgMTM3LjQ4M0MyOTMuNDgxIDEzOC4wMjEgMjk0LjI5IDEzOC40NTkgMjk1LjE0NiAxMzguNzkyQzI5Ny41NzQgMTM5LjczNSAzMDAuMDExIDEzOS42MzggMzAyLjMgMTM4LjQ1NEMzMDQuNTQ4IDEzNy4zNjggMzA2LjE5MSAxMzUuNjk0IDMwNy4wNjkgMTMzLjQzNUMzMDguMzY4IDEzMC4wOTUgMzA3LjQ5OCAxMjYuNjMyIDMwNS4xODMgMTIzLjI5MkMzMDUuMDc4IDEyMy4xMDcgMzA0Ljk1NSAxMjIuOTIzIDMwNC44NzMgMTIyLjgwMUwzMDQuODYzIDEyMi43ODVDMzA0LjcwNyAxMjIuNTUzIDMwNC41IDEyMi4yNTIgMzA0LjI0MyAxMjEuODg1QzMwMy45MTkgMTIxLjIyNiAzMDMuNTc0IDEyMC4xOTYgMzAzLjI0NiAxMTguNzE1QzMwMi45NTMgMTE3LjE2MiAzMDIuODA4IDExNS4yNTcgMzAyLjgzMyAxMTIuOThDMzAyLjk3MyAxMTAuODA1IDMwMy42MDggMTA4LjE4NyAzMDQuODA5IDEwNS4wOTdDMzA2LjExNCAxMDEuNzM5IDMwOC4yMDkgOTguNzA1OCAzMTEuMTM4IDk1Ljk5NDFDMzE0LjE5OSA5My4yNzYxIDMxNy42MDcgOTEuMTI1OSAzMjEuMzcgODkuNTM4NUwzMjEuMzcxIDg5LjUzODFDMzI1LjI1MyA4Ny44OTc5IDMyOS4yOTUgODYuOTQyMSAzMzMuNTA2IDg2LjY2ODlDMzM3Ljc2MyA4Ni40MzIgMzQxLjcwMSA4Ny4wMzM0IDM0NS4zNDUgODguNDVDMzUwLjc5OSA5MC41NzA1IDM1NS41MTcgOTMuNTEzOSAzNTkuNTE4IDk3LjI3NDNMMzU5LjUyNyA5Ny4yODI1QzM2My42MjQgMTAxLjA4NiAzNjYuNzI1IDEwNS40MDMgMzY4Ljg1MiAxMTAuMjM3TDM2OC44NTcgMTEwLjI0OEwzNjguODYyIDExMC4yNTlDMzcxLjA3NiAxMTUuMTMyIDM3Mi4yNzcgMTIwLjQzNyAzNzIuNDUgMTI2LjE5NEMzNzIuNjIyIDEzMS45MDQgMzcxLjU2MyAxMzcuNzQxIDM2OS4yMzggMTQzLjcyM0MzNjYuNDkgMTUwLjc5MSAzNjMuNTY5IDE1Ni41MTcgMzYwLjQ5MiAxNjAuOTQyQzM1Ny4zODEgMTY1LjQxNSAzNTQuMTI0IDE2OS4wMzkgMzUwLjczMiAxNzEuODQ0TDM1MC43MTkgMTcxLjg1NkwzNTAuNzA1IDE3MS44NjdDMzQ3LjM2MyAxNzQuNzM0IDM0My44ODUgMTc2Ljk4OCAzNDAuMjczIDE3OC42NDdMMzQwLjI1OCAxNzguNjUzTDM0MC4yNDMgMTc4LjY2MUMzMzYuNTc1IDE4MC40MTkgMzMyLjgzNiAxODIuMSAzMjkuMDI3IDE4My43MDZDMzI1LjMwNSAxODUuMTI0IDMyMS43MDcgMTg2Ljc0NiAzMTguMjMzIDE4OC41NjlMMzE4LjIxNyAxODguNTc4TDMxOC4yMDEgMTg4LjU4N0MzMTQuNzcyIDE5MC40NyAzMTEuNTQyIDE5Mi42MzkgMzA4LjUxMiAxOTUuMDkzQzMwNS40NTMgMTk3LjU3MSAzMDIuNjc1IDIwMC40MTQgMzAwLjE3OCAyMDMuNjE3TDMwMC4xNjQgMjAzLjYzNUwzMDAuMTUgMjAzLjY1NEMyOTcuNzE1IDIwNi45MzEgMjk1LjcwNyAyMTAuNjE3IDI5NC4xMTggMjE0LjcwMkMyOTMuNjI5IDIxNS45NjIgMjkzLjI1NCAyMTcuMDU5IDI5My4wMDkgMjE3Ljk3OEMyOTIuNzg2IDIxOC44MTcgMjkyLjY1MiAyMTkuMjUgMjkyLjU5NyAyMTkuMzkyTDI5Mi41NjEgMjE5LjQ4NUwyOTIuNTM0IDIxOS41ODFDMjkxLjg4NSAyMjEuOTE2IDI5Mi4xNzMgMjI0LjIyNyAyOTMuMzE1IDIyNi40MTZMMjkzLjMzMiAyMjYuNDQ4TDI5My4zNSAyMjYuNDhDMjk0LjU2MSAyMjguNjA1IDI5Ni40MjggMjMwLjExOCAyOTguODEzIDIzMS4wNDVMMjk4LjkwNiAyMzEuMDgxTDI5OS4wMDIgMjMxLjEwOEMzMDEuMzAxIDIzMS43NDcgMzAzLjU1NiAyMzEuNTE0IDMwNS42NTggMjMwLjQwNkMzMDcuODIzIDIyOS4yNzQgMzA5LjM5NiAyMjcuNTgyIDMxMC4yNjIgMjI1LjM1NEwzMTEuNjM4IDIyMS44MTVDMzEzLjAyNiAyMTguMjQ1IDMxNC40NjQgMjE1LjU1OSAzMTUuOTIgMjEzLjY3OEMzMTcuMzYyIDIxMS44MTUgMzE5LjA2OCAyMTAuNCAzMjEuMDQyIDIwOS40MDRDMzIzLjA3MSAyMDguMzggMzI1LjU0NyAyMDcuNjE0IDMyOC41MDQgMjA3LjEzOEMzMzEuNTU2IDIwNi42NDggMzM1LjI1MyAyMDYuMTk5IDMzOS42MDQgMjA1Ljc5M0MzNDMuNjY5IDIwNS40NTcgMzQ4LjA2MSAyMDUuMDQ4IDM1Mi43ODIgMjA0LjU2NkwzNTIuNzk5IDIwNC41NjRMMzUyLjgxNiAyMDQuNTYyQzM1Ny42MjcgMjAzLjk4NiAzNjIuNDc3IDIwMy4xNzEgMzY3LjM2NSAyMDIuMTE5TDM2Ny4zOCAyMDIuMTE2TDM2Ny4zOTYgMjAyLjExM0MzNzIuMzU4IDIwMC45NjMgMzc3LjI2IDE5OS40MzMgMzgyLjEwMiAxOTcuNTIzTDM4Mi4xMDMgMTk3LjUyMkMzODcuMTI3IDE5NS41MzUgMzkxLjg1OCAxOTIuOTY4IDM5Ni4yOTMgMTg5LjgyMlpNMzAxLjExMyAyNzcuOTMyQzMwMy44OTIgMjc2LjcwOSAzMDYuMzY5IDI3NC45ODggMzA4LjUzNyAyNzIuNzgyQzMxMC44MzEgMjcwLjU3MiAzMTIuNTcgMjY3LjkzMSAzMTMuNzU1IDI2NC44ODNDMzE0LjkwOSAyNjEuOTE0IDMxNS4zOSAyNTguODM1IDMxNS4xOTEgMjU1LjY2NUMzMTUuMDgxIDI1Mi41NjUgMzE0LjM5NiAyNDkuNjUgMzEzLjEyNCAyNDYuOTRDMzExLjg2MiAyNDQuMjUzIDMxMC4xMjIgMjQxLjgzIDMwNy45MjIgMjM5LjY3MkMzMDUuNjg2IDIzNy40NzkgMzAzLjA4MSAyMzUuODA2IDMwMC4xMjUgMjM0LjY1NkMyOTcuMTY4IDIzMy41MDcgMjk0LjExNyAyMzIuOTgxIDI5MC45ODcgMjMzLjA4OEMyODcuOTA3IDIzMy4xOTMgMjg0Ljk4NyAyMzMuODA2IDI4Mi4yNDIgMjM0LjkzNUMyNzkuNDY0IDIzNi4wNzcgMjc2Ljk4MyAyMzcuNzcyIDI3NC44MDQgMjM5Ljk5NEMyNzIuNjExIDI0Mi4yMyAyNzAuOTM4IDI0NC44MzUgMjY5Ljc4OCAyNDcuNzkyQzI2OC42MDggMjUwLjgyNyAyNjguMDYyIDI1My45MjEgMjY4LjE2OSAyNTcuMDZDMjY4LjI3NSAyNjAuMTYyIDI2OC45MzkgMjYzLjExNCAyNzAuMTY2IDI2NS45MDFDMjcxLjM5MyAyNjguNjg5IDI3My4xMjEgMjcxLjE3MiAyNzUuMzM3IDI3My4zNDZDMjc3LjU3MyAyNzUuNTM4IDI4MC4xNzggMjc3LjIxMSAyODMuMTM1IDI3OC4zNjFDMjg2LjA5MSAyNzkuNTEgMjg5LjE0MiAyODAuMDM2IDI5Mi4yNzIgMjc5LjkyOUMyOTUuMzc0IDI3OS44MjMgMjk4LjMyNiAyNzkuMTU5IDMwMS4xMTMgMjc3LjkzMloiIGZpbGw9IiMyOTJBMkUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iNCIvPg0KPC9zdmc+DQo=";var a=t(98281),c=t(14517);const C=o.memo(y=>{var N;return o.createElement("div",{className:(0,c.Z)("text-center w-full",y.className),style:y.style},o.createElement("img",{className:"w-32 h-32 m-auto mb-2",src:l}),o.createElement("div",null,(N=y.text)!=null?N:(0,a.t)("\u51FA\u73B0\u4E86\u4E00\u4E9B\u95EE\u9898")))});C.displayName="Problem"},67434:(x,P,t)=>{"use strict";t.d(P,{$:()=>a});var o=t(93540),l=t(52983);const a=l.memo(()=>l.createElement(o.JO,{className:"animate-spin mr-3 inline",icon:"mdi:loading"}));a.displayName="Spinner"},50842:(x,P,t)=>{"use strict";t.d(P,{A:()=>a,b:()=>c});var o=t(52983);const l=o.createContext("");l.displayName="GroupIdContext";const a=l.Provider;function c(){return(0,o.useContext)(l)}},85478:(x,P,t)=>{"use strict";t.d(P,{D:()=>a,x:()=>l});var o=t(52983);const l=o.createContext(null);l.displayName="GroupPanelContext";function a(){return(0,o.useContext)(l)}},96857:(x,P,t)=>{"use strict";t.d(P,{Z:()=>a,i:()=>c});var o=t(52983);const l=o.createContext({});l.displayName="SocketContext";const a=o.memo(C=>o.createElement(l.Provider,{value:C.socket},C.children));a.displayName="SocketContextProvider";function c(){return(0,o.useContext)(l)}},89935:(x,P,t)=>{"use strict";t.d(P,{d:()=>c});var o=t(98281),l=t(52983);const a=(C=1/0,y=1/0)=>{const[N,L]=(0,o.j$3)({width:o.jUY?window.innerWidth:C,height:o.jUY?window.innerHeight:y});return(0,l.useEffect)(()=>{if(o.jUY){const j=()=>{L({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",j),()=>{window.removeEventListener("resize",j)}}},[]),N};function c(){const{width:C}=a();return C<768}},81070:(x,P,t)=>{"use strict";var o=t(170),l=t(18370),a=t(52983),c=t(98281),C=t(22398),y=t(87450),N=t(13546),L=t.n(N),j=t(82335),W=t(89408),B=t(93540),E=(Z,te,le)=>new Promise((Re,Qe)=>{var He=Me=>{try{Se(le.next(Me))}catch(ze){Qe(ze)}},Te=Me=>{try{Se(le.throw(Me))}catch(ze){Qe(ze)}},Se=Me=>Me.done?Re(Me.value):Promise.resolve(Me.value).then(He,Te);Se((le=le.apply(Z,te)).next())});(0,j.CN)("init"),(0,W.S)("init"),c.yGS&&t.e(528).then(t.bind(t,7528)).then(({start:Z})=>Z());const S=(0,c.Kdd)(window.localStorage);(0,c.poP)(()=>S),(0,c.OvJ)(()=>E(void 0,null,function*(){return yield(0,y.pT)()}));const O=window.localStorage.getItem("serviceUrl");O?(0,c.YAW)(()=>O):(0,c.YAW)(()=>String("https://ssdcc.online:11443")),(0,c.lx9)((Z,te="info")=>{o.ZP.open({type:te,duration:3,content:a.createElement("span",{"data-testid":"toast"},String(Z))})}),(0,c.brB)(Z=>{l.Z.confirm({content:Z.message,onOk:()=>E(void 0,null,function*(){typeof Z.onConfirm=="function"&&(yield Z.onConfirm())}),getContainer:C.Gr})}),(0,c.I5R)(Z=>o.ZP.loading(Z,0)),(0,B.Yk)(c.Awg),(0,c.t4N)(()=>{(0,B.YE)({submitLabel:(0,c.t)("\u63D0\u4EA4")})});const z=(()=>{let Z;return()=>{Z||window.location.pathname.startsWith("/entry")||window.location.pathname.startsWith("/invite")||(console.warn("\u8D26\u53F7\u6388\u6743\u5DF2\u8FC7\u671F, 2\u79D2\u540E\u81EA\u52A8\u8DF3\u8F6C\u5230\u767B\u5F55\u9875"),(0,c.lHp)((0,c.t)("\u8D26\u53F7\u6388\u6743\u5DF2\u8FC7\u671F, 2\u79D2\u540E\u81EA\u52A8\u8DF3\u8F6C\u5230\u767B\u5F55\u9875"),"warning"),Z=window.setTimeout(()=>{window.clearTimeout(Z),window.location.href="/entry/login"},2e3))}})();(0,c.J7p)(Z=>L()(Z,"response.data.code")===401?(z(),!1):!0),(0,c.DtN)().catch(Z=>{(0,c.hJM)((0,c.t)("\u5168\u5C40\u914D\u7F6E\u52A0\u8F7D\u5931\u8D25")),console.error("\u5168\u5C40\u914D\u7F6E\u52A0\u8F7D\u5931\u8D25",Z)}),c.yGS===!0&&(window.DEBUG={request:c.WY0,version:c.i83,measure:j.L8});var A=t(78520),T=t(10330),h=t(54782),p=t(14517),g=t(80474),Y=t(13474),F=t(94343),G=t(38887),U=t(7975),J=t(442),k=t(30547),se=t.n(k),Ie=t(70877),je=t(98992),ee=t(21940),De=t(67706),Ae=t(83824),Le=(Z,te,le)=>new Promise((Re,Qe)=>{var He=Me=>{try{Se(le.next(Me))}catch(ze){Qe(ze)}},Te=Me=>{try{Se(le.throw(Me))}catch(ze){Qe(ze)}},Se=Me=>Me.done?Re(Me.value):Promise.resolve(Me.value).then(He,Te);Se((le=le.apply(Z,te)).next())});const Je=se()()?T.UT:T.VK,Pe=(0,g.P)(()=>Promise.all([t.e(850),t.e(674),t.e(108),t.e(899),t.e(260),t.e(771),t.e(258),t.e(179)]).then(t.bind(t,5995))),xe=(0,g.P)(()=>t.e(497).then(t.bind(t,84850))),ye=(0,g.P)(()=>Promise.all([t.e(850),t.e(108),t.e(771),t.e(258),t.e(212)]).then(t.bind(t,85603))),Oe=(0,g.P)(()=>t.e(152).then(t.bind(t,49002))),we=a.memo(Z=>{const{value:te}=(0,c.r53)(()=>Le(void 0,null,function*(){return(0,c.G33)()==="zh-CN"?t.e(579).then(t.bind(t,42342)).then(Re=>Re.default):Ae.Z}),[]);return a.createElement(Y.ZP,{getPopupContainer:C.Gr,locale:te},Z.children)});we.displayName="TcAntdProvider";const Q=a.memo(Z=>a.createElement(a.Suspense,{fallback:a.createElement(G.T,null)},a.createElement(Je,null,a.createElement(c.IE7,null,a.createElement(je.W,{backend:ee.PD},a.createElement(we,null,Z.children))))));Q.displayName="AppProvider";const b=a.memo(Z=>{const{isDarkMode:te,extraSchemeName:le}=(0,c.tv4)();return a.createElement("div",{id:"tailchat-app",className:(0,p.Z)("tailchat-app","absolute inset-0 select-none overflow-hidden",{dark:te},le),onContextMenu:C.PF},Z.children)});b.displayName="AppContainer";const V=a.memo(()=>{const{language:Z}=(0,c.ZKp)(),{serverName:te,serverEntryImage:le}=(0,c.tR0)(Re=>({serverName:Re.serverName,serverEntryImage:Re.serverEntryImage}));return a.createElement(F.q,null,a.createElement("meta",{httpEquiv:"Content-Language",content:Z}),a.createElement("title",null,te),le&&a.createElement("style",{type:"text/css"},`
              #tailchat-app {
                --tc-background-image: url(${(0,c.Awg)(le)});
              }
            `))});V.displayName="AppHeader";const me=a.memo(()=>((0,j.bw)("appRenderStart"),(0,a.useEffect)(()=>{c.Agn.emit("appLoaded")},[]),a.createElement(Q,null,a.createElement(V,null),a.createElement(b,null,a.createElement(Ie._,null),a.createElement(De.S,null,a.createElement(h.Routes,null,a.createElement(h.Route,{path:"/entry/*",element:a.createElement(J.$2,null,a.createElement(xe,null))}),a.createElement(h.Route,{path:"/main/*",element:a.createElement(Pe,null)}),a.createElement(h.Route,{path:"/panel/*",element:a.createElement(ye,null)}),a.createElement(h.Route,{path:"/invite/:inviteCode",element:a.createElement(Oe,null)}),a.createElement(h.Route,{path:"/plugin/*",element:a.createElement(J.$2,null,a.createElement(h.Routes,null,U.pluginRootRoute.map((Z,te)=>{var le;return a.createElement(h.Route,{key:Z.name,path:(le=Z.path)!=null?le:`/fallback${te}`,element:a.createElement(Z.component)})})))}),a.createElement(h.Route,{path:"/*",element:a.createElement(h.Navigate,{to:"/entry",replace:!0})})))))));me.displayName="App";var d=t(45165),R=t(99631),K=(Z,te,le)=>new Promise((Re,Qe)=>{var He=Me=>{try{Se(le.next(Me))}catch(ze){Qe(ze)}},Te=Me=>{try{Se(le.throw(Me))}catch(ze){Qe(ze)}},Se=Me=>Me.done?Re(Me.value):Promise.resolve(Me.value).then(He,Te);Se((le=le.apply(Z,te)).next())});function $(){return K(this,null,function*(){q(),ae(),yield R.E.initPlugins()})}function q(){(0,d.vf)("react",()=>Promise.resolve().then(t.t.bind(t,52983,19))),(0,d.vf)("react-router",()=>Promise.resolve().then(t.bind(t,54782))),(0,d.vf)("axios",()=>Promise.resolve().then(t.t.bind(t,95326,23))),(0,d.vf)("styled-components",()=>Promise.all([t.e(899),t.e(236)]).then(t.bind(t,56899))),(0,d.vf)("zustand",()=>Promise.resolve().then(t.bind(t,36350))),(0,d.vf)("zustand/middleware/immer",()=>t.e(748).then(t.bind(t,50748)))}function ae(){(0,d.h7)("@capital/common",()=>Promise.resolve().then(t.bind(t,7975))),(0,d.h7)("@capital/component",()=>Promise.all([t.e(850),t.e(674),t.e(771),t.e(746)]).then(t.bind(t,9968)))}var fe=t(77569),ie=t(10430);(0,fe.Fv)(),(0,j.CN)("initPluginsStart"),$().then(()=>{(0,j.CN)("initPluginsEnd"),(0,W.S)("loaded"),(0,A.s)(document.querySelector("#app")).render(a.createElement(a.StrictMode,null,a.createElement(me,null)))}).catch(()=>{(0,c.hJM)((0,c.t)("MiniStar \u5E94\u7528\u521D\u59CB\u5316\u5931\u8D25"))})},72824:(x,P,t)=>{"use strict";t.d(P,{Y:()=>c});var o=t(6494),l=t.n(o);const a=["nightly.paw.msgbyte.com"].includes(location.host),c=l()([{label:"Web Panel Plugin","label.zh-CN":"\u7F51\u9875\u9762\u677F\u63D2\u4EF6",name:"com.msgbyte.webview",url:"/plugins/com.msgbyte.webview/index.js",version:"0.0.0",author:"msgbyte",description:"Provides groups with the ability to create web panels","description.zh-CN":"\u4E3A\u7FA4\u7EC4\u63D0\u4F9B\u521B\u5EFA\u7F51\u9875\u9762\u677F\u7684\u529F\u80FD",documentUrl:"/plugins/com.msgbyte.webview/README.md",requireRestart:!1},{label:"BBCode Mmessage Interpreter","label.zh-CN":"BBCode \u6D88\u606F\u89E3\u91CA\u5668",name:"com.msgbyte.bbcode",url:"/plugins/com.msgbyte.bbcode/index.js",version:"0.0.0",author:"msgbyte",description:"A plugin for supporting bbcode syntax to interpret rich text messages","description.zh-CN":"\u4E00\u4E2A\u7528\u4E8E\u652F\u6301bbcode\u8BED\u6CD5\u89E3\u91CA\u5BCC\u6587\u672C\u6D88\u606F\u7684\u63D2\u4EF6",requireRestart:!0},{label:"Message notification plugin","label.zh-CN":"\u6D88\u606F\u901A\u77E5\u63D2\u4EF6",name:"com.msgbyte.notify",url:"/plugins/com.msgbyte.notify/index.js",version:"0.0.0",author:"msgbyte",description:"Ability to add notifications to apps","description.zh-CN":"\u4E3A\u5E94\u7528\u589E\u52A0\u901A\u77E5\u7684\u80FD\u529B",requireRestart:!0},{label:"Intro plugin","label.zh-CN":"\u521D\u59CB\u5F15\u5BFC\u63D2\u4EF6",name:"com.msgbyte.intro",url:"/plugins/com.msgbyte.intro/index.js",version:"0.0.0",author:"msgbyte",description:"Turn on the ability to introduce the app for the first time for the app","description.zh-CN":"\u4E3A\u5E94\u7528\u9996\u6B21\u6253\u5F00\u4ECB\u7ECD\u5E94\u7528\u7684\u80FD\u529B",requireRestart:!0},{label:"Markdown Panel","label.zh-CN":"Markdown \u9762\u677F",name:"com.msgbyte.mdpanel",url:"/plugins/com.msgbyte.mdpanel/index.js",version:"0.0.0",author:"moonrailgun",description:"Add markdown panel support","description.zh-CN":"\u589E\u52A0 Markdown \u9762\u677F\u652F\u6301",requireRestart:!0},{label:"Identity and Access Management","label.zh-CN":"IAM \u63D2\u4EF6",name:"com.msgbyte.iam",url:"{BACKEND}/plugins/com.msgbyte.iam/index.js",documentUrl:"https://tailchat.msgbyte.com/docs/advanced-usage/plugins/com.msgbyte.iam",version:"0.0.0",author:"moonrailgun",description:"Provide Tailchat with the function of conveniently accessing external account systems","description.zh-CN":"\u4E3ATailchat\u63D0\u4F9B\u65B9\u4FBF\u7684\u63A5\u5165\u5916\u90E8\u8D26\u6237\u7CFB\u7EDF\u7684\u529F\u80FD",requireRestart:!0},{label:"Offline Icons","label.zh-CN":"\u79BB\u7EBF\u56FE\u6807",name:"com.msgbyte.offline-icons",url:"/plugins/com.msgbyte.offline-icons/index.js",version:"0.0.0",author:"moonrailgun",description:"Add prefetched icons which need run in intranet environment","description.zh-CN":"\u589E\u52A0\u9884\u83B7\u53D6\u7684\u56FE\u6807\uFF0C\u9002\u7528\u4E8E\u5185\u7F51\u73AF\u5883",requireRestart:!0},{label:"Discover","label.zh-CN":"\u53D1\u73B0\u7FA4\u7EC4",name:"com.msgbyte.discover",url:"{BACKEND}/plugins/com.msgbyte.discover/index.js",version:"0.0.0",author:"moonrailgun",description:"Add Discover panel which can help user found groups","description.zh-CN":"\u589E\u52A0\u4E00\u4E2A\u53D1\u73B0\u9762\u677F\uFF0C\u7528\u4E8E\u63A2\u7D22\u516C\u5F00\u7684\u7FA4\u7EC4",requireRestart:!0},{label:"Agora","label.zh-CN":"\u58F0\u7F51\u97F3\u89C6\u9891",name:"com.msgbyte.agora",url:"{BACKEND}/plugins/com.msgbyte.agora/index.js",icon:"{BACKEND}/plugins/com.msgbyte.agora/assets/icon.png",version:"0.0.0",author:"moonrailgun",description:"Add the Agora audio and video communication feature to Tailchat","description.zh-CN":"\u4E3ATailchat\u589E\u52A0\u58F0\u7F51\u97F3\u89C6\u9891\u901A\u4FE1\u529F\u80FD",requireRestart:!1},{label:"SSDC\u89C6\u9891\u6D88\u606F\u652F\u6301\u63D2\u4EF6",name:"cn.ssdcc.tailchat.video",url:"https://ssdcc.github.io/tailchat-plugin/dist/plugins/cn.ssdcc.tailchat.video/index.js",version:"0.0.0",author:"ssdcc",description:"\u63D0\u4F9B\u89C6\u9891\u6D88\u606F\u80FD\u529B",requireRestart:!0},a&&{label:"Posthog",name:"com.msgbyte.posthog",url:"/plugins/com.msgbyte.posthog/index.js",icon:"/plugins/com.msgbyte.posthog/assets/icon.png",version:"0.0.0",author:"moonrailgun",description:"Posthog Statistics","description.zh-CN":"Posthog \u6570\u636E\u7EDF\u8BA1",requireRestart:!0},a&&{label:"Sentry",name:"com.msgbyte.sentry",url:"/plugins/com.msgbyte.sentry/index.js",icon:"/plugins/com.msgbyte.sentry/assets/icon.png",version:"0.0.0",author:"moonrailgun",description:"Sentry error handling","description.zh-CN":"Sentry \u9519\u8BEF\u5904\u7406",requireRestart:!0},a&&{label:"User Location","label.zh-CN":"\u7528\u6237\u5730\u7406\u4F4D\u7F6E",name:"com.msgbyte.user.location",url:"/plugins/com.msgbyte.user.location/index.js",version:"0.0.0",author:"moonrailgun",description:"Add geographic location records for user information","description.zh-CN":"\u4E3A\u7528\u6237\u4FE1\u606F\u589E\u52A0\u5730\u7406\u4F4D\u7F6E\u8BB0\u5F55",requireRestart:!0},a&&{label:"AI Assistant",name:"com.msgbyte.ai-assistant",url:"/plugins/com.msgbyte.ai-assistant/index.js",icon:"/plugins/com.msgbyte.ai-assistant/assets/icon.png",version:"0.0.0",author:"moonrailgun",description:"Add chatgpt into Tailchat",requireRestart:!0}])},7975:(x,P,t)=>{"use strict";t.r(P),t.d(P,{Loadable:()=>Se.P,ModalWrapper:()=>Te.AB,appendUrlSearch:()=>ot.no,closeModal:()=>Te.Mr,createFastFormSchema:()=>st._D,createPluginRequest:()=>gt,dataUrlToFile:()=>Ut.Bo,fetchAvailableServices:()=>a.Y4U,fieldSchema:()=>st._6,getCachedBaseGroupInfo:()=>a.D6C,getCachedConverseInfo:()=>a.r5V,getCachedUserInfo:()=>a.pGV,getCachedUserSettings:()=>a.U$y,getGlobalState:()=>ze.MO,getJWTUserInfo:()=>et.Yt,getLanguage:()=>a.G33,getMessageRender:()=>A,getMessageTextDecorators:()=>Y,getServiceUrl:()=>a.qQ$,getServiceWorkerRegistration:()=>Ft.Op,getTextColorHex:()=>st.Yy,isDevelopment:()=>a.yGS,isValidStr:()=>a.YQu,joinArray:()=>a.Mo8,localTrans:()=>a.YtP,loginWithToken:()=>a.ouS,messageInterpreter:()=>O,navigate:()=>Mt.c,openConfirmModal:()=>Te._5,openModal:()=>Te.h7,openReconfirmModal:()=>Te.VW,parseUrlStr:()=>a.Awg,pluginCardItemMap:()=>q,pluginChatInputActions:()=>F,pluginChatInputButtons:()=>U,pluginColorScheme:()=>k,pluginCustomPanel:()=>W,pluginGroupConfigItems:()=>fe,pluginGroupPanel:()=>E,pluginGroupPanelBadges:()=>Oe,pluginGroupTextPanelExtraMenus:()=>Q,pluginInboxItemMap:()=>K,pluginInspectServices:()=>Ie,pluginLoginAction:()=>Z,pluginMessageExtraParsers:()=>ee,pluginPanelActions:()=>Je,pluginPermission:()=>xe,pluginRootRoute:()=>Ae,pluginSettings:()=>d,pluginUserExtraInfo:()=>V,postMessageEvent:()=>At.S,postRequest:()=>Bt,regChatInputAction:()=>G,regChatInputButton:()=>J,regCustomPanel:()=>B,regGroupPanel:()=>S,regGroupPanelBadge:()=>we,regInspectService:()=>je,regLoginAction:()=>te,regMessageExtraParser:()=>De,regMessageInterpreter:()=>z,regMessageRender:()=>T,regMessageTextDecorators:()=>g,regPluginCardItem:()=>ae,regPluginColorScheme:()=>se,regPluginGroupConfigItem:()=>ie,regPluginGroupTextPanelExtraMenu:()=>b,regPluginInboxItemMap:()=>$,regPluginPanelAction:()=>Pe,regPluginPermission:()=>ye,regPluginRootRoute:()=>Le,regPluginSettings:()=>R,regSocketEventListener:()=>a.Kr1,regUserExtraInfo:()=>me,sendMessage:()=>a.bG5,setUserJWT:()=>et._H,sharedEvent:()=>a.Agn,showErrorToasts:()=>a.hJM,showMessageTime:()=>a.omK,showSuccessToasts:()=>a.jiy,showToasts:()=>a.lHp,uploadFile:()=>a.cTq,urlSearchParse:()=>ot.qp,urlSearchStringify:()=>ot.a,useAsync:()=>a.r53,useAsyncFn:()=>a.ilX,useAsyncRefresh:()=>a.IxN,useAsyncRequest:()=>a.CoE,useConverseMessageContext:()=>a.FNv,useCurrentUserInfo:()=>Rt,useEvent:()=>a.zX9,useGlobalSocketEvent:()=>ze.s0,useGroupIdContext:()=>le.b,useGroupPanelContext:()=>Re.D,useGroupPanelInfo:()=>a.wY6,useGroupPanelParams:()=>He.PO,useIsMobile:()=>Me.d,useLocation:()=>It.useLocation,useModalContext:()=>Te.vR,useNavigate:()=>It.useNavigate,useSocketContext:()=>Qe.i,useUpdateRef:()=>a.ysv,useWatch:()=>a.qoQ});var o=t(49335),l=t.n(o),a=t(98281),c=Object.defineProperty,C=Object.getOwnPropertySymbols,y=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,L=(ue,pe,Ne)=>pe in ue?c(ue,pe,{enumerable:!0,configurable:!0,writable:!0,value:Ne}):ue[pe]=Ne,j=(ue,pe)=>{for(var Ne in pe||(pe={}))y.call(pe,Ne)&&L(ue,Ne,pe[Ne]);if(C)for(var Ne of C(pe))N.call(pe,Ne)&&L(ue,Ne,pe[Ne]);return ue};const[W,B]=(0,a._CB)(),[E,S]=(0,a._CB)(),[O,z]=(0,a._CB)(),[A,T]=(0,a.Ntz)("message-render",ue=>ue),h={url:(ue,pe)=>ue,image:(ue,pe)=>ue,card:(ue,pe)=>ue,mention:(ue,pe)=>`@${pe}`,emoji:ue=>ue,serialize:ue=>ue},[p,g]=(0,a.Ntz)("message-text-decorators",()=>h);function Y(){return j(j({},h),p())}const[F,G]=(0,a._CB)(),[U,J]=(0,a._CB)(),[k,se]=(0,a._CB)(),[Ie,je]=(0,a._CB)(),[ee,De]=(0,a._CB)(),[Ae,Le]=(0,a._CB)(),[Je,Pe]=(0,a._CB)(),[xe,ye]=(0,a._CB)(),[Oe,we]=(0,a._CB)(),[Q,b]=(0,a._CB)(),[V,me]=(0,a._CB)(),[d,R]=(0,a._CB)(),[K,$]=(0,a.D3K)(),[q,ae]=(0,a.D3K)(),[fe,ie]=(0,a._CB)(),[Z,te]=(0,a._CB)();var le=t(50842),Re=t(85478),Qe=t(96857),He=t(22215),Te=t(84208),Se=t(80474),Me=t(89935),ze=t(5198),et=t(87450),Ut=t(74774),ot=t(72297),Ft=t(77569),At=t(89408),Mt=t(70877),It=t(54782),st=t(93540);function Rt(){const ue=(0,a.Pc$)();return l()(ue,["email","nickname","discriminator","avatar"])}function at(ue){if(!!ue)return l()(ue,["transformRequest","transformResponse","headers","params","data","timeout","withCredentials","xsrfCookieName","xsrfHeaderName"])}function gt(ue){return{get(pe,Ne){return a.WY0.get(`/api/plugin:${ue}/${pe.replace(/\./g,"/")}`,at(Ne))},post(pe,Ne,lt){return a.WY0.post(`/api/plugin:${ue}/${pe.replace(/\./g,"/")}`,Ne,at(lt))}}}function Bt(ue,pe,Ne){return a.WY0.post(`/api${ue}`,pe,at(Ne))}},99631:(x,P,t)=>{"use strict";t.d(P,{E:()=>Y});var o=t(98281),l=t(45165),a=t(47020),c=t.n(a),C=t(72824),y=t(43991),N=t(52983);function L(F){y.Z.warn({message:N.createElement("div",null,N.createElement("p",null,(0,o.t)("\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"),":"),F.map(G=>N.createElement("p",{key:G},"- ",G))),duration:2})}function j(F,G){window.tailchat||(window.tailchat={}),window.tailchat[F]=G}var W=t(3010),B=t.n(W),E=Object.defineProperty,S=Object.getOwnPropertySymbols,O=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable,A=(F,G,U)=>G in F?E(F,G,{enumerable:!0,configurable:!0,writable:!0,value:U}):F[G]=U,T=(F,G)=>{for(var U in G||(G={}))O.call(G,U)&&A(F,U,G[U]);if(S)for(var U of S(G))z.call(G,U)&&A(F,U,G[U]);return F},h=(F,G,U)=>new Promise((J,k)=>{var se=ee=>{try{je(U.next(ee))}catch(De){k(De)}},Ie=ee=>{try{je(U.throw(ee))}catch(De){k(De)}},je=ee=>ee.done?J(ee.value):Promise.resolve(ee.value).then(se,Ie);je((U=U.apply(F,G)).next())});const p=class{constructor(){this.initPlugins=c()(()=>h(this,null,function*(){const G=B()([...C.Y,...yield this.getInstalledPlugins()],"name").map(({name:J,url:k})=>({name:J,url:(0,o.Awg)(k)})),U=new Set;yield(0,l.FV)({plugins:G,onPluginLoadError:J=>{console.error("Plugin load error:",J),U.add(J.pluginName)}}),U.size>0&&L(Array.from(U))})),this.getRegistryPlugins=c()(()=>h(this,null,function*(){const F=yield(0,o.Mlq)();return this.updatePluginsInfo(F),F}))}getInstalledPlugins(){return h(this,null,function*(){return yield(0,o.cF2)().get(p.STORE_KEY,[])})}updatePluginsInfo(F){return h(this,null,function*(){const G=yield this.getInstalledPlugins();yield this.saveInstalledPlugins(G.map(U=>{const J=F.find(k=>k.name===U.name);return J?T(T({},U),J):U}))})}installPlugin(F){return h(this,null,function*(){const G=yield this.getInstalledPlugins(),U=G.findIndex(J=>J.name===F.name);U>=0?G[U]=F:G.push(F),yield this.saveInstalledPlugins(G),yield(0,l.dZ)({name:F.name,url:F.url})})}uninstallPlugin(F){return h(this,null,function*(){const G=yield(0,o.cF2)().get(p.STORE_KEY),U=G.findIndex(J=>J.name===F);U>=0&&(G.splice(U,1),yield this.saveInstalledPlugins(G))})}saveInstalledPlugins(F){return h(this,null,function*(){yield(0,o.cF2)().save(p.STORE_KEY,F)})}};let g=p;g.STORE_KEY="$TailchatInstalledPlugins";const Y=new g;j("installPlugin",Y.installPlugin.bind(Y))},22215:(x,P,t)=>{"use strict";t.d(P,{PO:()=>L,Sp:()=>j,rF:()=>W});var o=t(7975),l=t(89889),a=t(52983),c=t(54782),C=t(93540),y=t(98281),N=t(52486);function L(){const{groupId:B="",panelId:E=""}=(0,c.useParams)();return{groupId:B,panelId:E}}function j(B){const E=(0,a.useMemo)(()=>{var S,O;return B.type===y.Xpe.TEXT?o.pluginGroupTextPanelExtraMenus:(0,y.YQu)(B.pluginPanelName)?(O=(S=(0,l.S)(B.pluginPanelName))==null?void 0:S.menus)!=null?O:[]:[]},[B.type,B.pluginPanelName]);return Array.isArray(E)&&E.length>0?[{type:"divider"},...E.map(S=>({key:S.name,label:S.label,icon:S.icon?a.createElement(C.JO,{icon:S.icon}):void 0,onClick:()=>S.onClick(B)}))]:[]}function W(B,E,S){const O=(0,N.Z)();return(0,y.JtK)("groupPanelBadgeUpdate",()=>{O()}),o.pluginGroupPanelBadges.filter(A=>A.panelType===S).map(A=>{const T=A.render;return a.createElement(a.Fragment,{key:E+A.name},a.createElement(T,{groupId:B,panelId:E}))})}},22398:(x,P,t)=>{"use strict";t.d(P,{Gr:()=>o,PF:()=>a,SQ:()=>C,UW:()=>l,g$:()=>c});function o(){const y=document.querySelector("#tailchat-app");return y||document.body}function l(y){y.stopPropagation()}function a(y){y.preventDefault()}function c(y){const N=[];let L=y.parentElement;for(;L;)N.unshift(L),L=L.parentElement;return N}function C(y){let N=!1;const L=(...j)=>{N!==!1&&(y(...j),requestAnimationFrame(()=>{L(...j)}))};return{start:(...j)=>{N=!0,L(...j)},end:()=>{requestAnimationFrame(()=>{N=!1})}}}},89408:(x,P,t)=>{"use strict";t.d(P,{S:()=>o});function o(l,a){window.postMessage({_isTailchat:!0,type:l,payload:a},"*")}},74774:(x,P,t)=>{"use strict";t.d(P,{Bo:()=>y,DQ:()=>O,Fy:()=>C,GR:()=>B,NV:()=>W,ZB:()=>S,hv:()=>z});var o=t(13546),l=t.n(o),a=t(98281),c=(A,T,h)=>new Promise((p,g)=>{var Y=U=>{try{G(h.next(U))}catch(J){g(J)}},F=U=>{try{G(h.throw(U))}catch(J){g(J)}},G=U=>U.done?p(U.value):Promise.resolve(U.value).then(Y,F);G((h=h.apply(A,T)).next())});function C(A){return new Promise((T,h)=>{const p=new FileReader;p.addEventListener("load",()=>{var g;return T(String((g=p.result)!=null?g:""))}),p.addEventListener("error",()=>h(p.error)),p.readAsDataURL(A)})}function y(A,T="file"){const h=A.split(","),p=l()(h[0].match(/:(.*?);/),[1]),g=atob(h[1]);let Y=g.length;const F=new Uint8Array(Y);for(;Y--;)F[Y]=g.charCodeAt(Y);return new File([F],T,{type:p})}function N(A){return new Promise((T,h)=>{const p=new FileReader;p.addEventListener("load",()=>{var g;return T(String((g=p.result)!=null?g:""))}),p.addEventListener("error",()=>h(p.error)),p.readAsText(A)})}function L(A){return new Promise((T,h)=>{const p=new XMLHttpRequest;p.responseType="blob",p.onload=()=>{T(p.response)},p.onerror=()=>{h(p.responseText)},p.open("get",A),p.send()})}function j(A,T){return new File([A],T,{lastModified:new Date().valueOf(),type:A.type})}function W(A,T="image.jpg"){return c(this,null,function*(){const h=yield L(A);return j(h,T)})}function B(A,T){const h=document.createElement("a");h.href=(0,a.Awg)(A),h.download=T,h.target="_blank",h.click()}function E(A,T){const h=String(URL.createObjectURL(A));B(h,T),URL.revokeObjectURL(h)}function S(A){return c(this,null,function*(){return new Promise(T=>{const h=document.createElement("input");h.setAttribute("type","file"),typeof(A==null?void 0:A.accept)=="string"&&(h.accept=A.accept),h.addEventListener("change",function(p){const g=l()(this,["files",0],null);T(g),h.remove()}),h.click()})})}const O=A=>A.type==="image/gif";function z(A,T){return c(this,null,function*(){const{default:h}=yield t.e(538).then(t.t.bind(t,17538,23));return new Promise((p,g)=>{var Y,F,G;new h(A,{quality:(Y=T==null?void 0:T.quality)!=null?Y:.6,maxWidth:(F=T==null?void 0:T.maxWidth)!=null?F:1920,maxHeight:(G=T==null?void 0:T.maxHeight)!=null?G:1080,success(U){U instanceof File?p(U):p(new File([U],U.name))},error(U){g(U)}})})})}},5198:(x,P,t)=>{"use strict";t.d(P,{Kj:()=>L,MO:()=>y,_3:()=>C,s0:()=>W});var o=t(52983),l=t(98281),a=(E,S,O)=>new Promise((z,A)=>{var T=g=>{try{p(O.next(g))}catch(Y){A(Y)}},h=g=>{try{p(O.throw(g))}catch(Y){A(Y)}},p=g=>g.done?z(g.value):Promise.resolve(g.value).then(T,h);p((O=O.apply(E,S)).next())});let c;function C(E){c=E}function y(){return c?c.getState():null}let N;function L(E){N=E}function j(){return N||null}function W(E,S){const O=(0,l.zX9)(S);(0,o.useEffect)(()=>(N&&N.listen(E,O),()=>{N&&N.removeListener(E,O)}),[])}function B(E,S){return a(this,null,function*(){if(!N)throw new Error("socket not inited");return yield N.request(E,S)})}},87450:(x,P,t)=>{"use strict";t.d(P,{Yt:()=>E,_H:()=>W,pT:()=>B});var o=t(93702),l=t.n(o),a=t(7534),c=t.n(a),C=t(61006),y=t(98281),N=(S,O,z)=>new Promise((A,T)=>{var h=Y=>{try{g(z.next(Y))}catch(F){T(F)}},p=Y=>{try{g(z.throw(Y))}catch(F){T(F)}},g=Y=>Y.done?A(Y.value):Promise.resolve(Y.value).then(h,p);g((z=z.apply(S,O)).next())});function L(S){try{return(0,C.Z)(S)}catch(O){console.error(`getJWTInfo Error: [jwt: ${S}]`,O)}return{}}let j=null;function W(S){return N(this,null,function*(){j=S,yield(0,y.cF2)().save("jsonwebtoken",S),(0,y.csP)()})}function B(){return N(this,null,function*(){if(c()(j)){const S=yield(0,y.cF2)().get("jsonwebtoken");return j=S,S}return j})}function E(){return N(this,null,function*(){try{const S=yield B(),O=L(S);if(l()(O))return O}catch(S){console.error("getJWTInfo Error:",S)}return{}})}},82335:(x,P,t)=>{"use strict";t.d(P,{CN:()=>E,L8:()=>O,bw:()=>S});var o=t(52983),l=t(84184),a=Object.defineProperty,c=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable,N=(z,A,T)=>A in z?a(z,A,{enumerable:!0,configurable:!0,writable:!0,value:T}):z[A]=T,L=(z,A)=>{for(var T in A||(A={}))C.call(A,T)&&N(z,T,A[T]);if(c)for(var T of c(A))y.call(A,T)&&N(z,T,A[T]);return z};const j={},W={},B=z=>{W[z.name]||(W[z.name]=z.value)};(0,l.mw)(B),(0,l.a4)(B),(0,l.Fu)(B),(0,l.Yn)(B),(0,l.NO)(B),(0,l.mr)(B);function E(z){j[z]||(performance.mark(`tailchat:${z}`),j[z]=performance.now())}function S(z){(0,o.useLayoutEffect)(()=>{E(z)},[]),(0,o.useEffect)(()=>{E(z+"Mounted")},[])}const O={getVitals:()=>L({},W),getRecord:()=>L({},j),getTimeUsage(){let z=performance.timing;const A={dnsUsage:z.domainLookupEnd-z.domainLookupStart,tcpUsage:z.connectEnd-z.connectStart,requestUsage:z.responseEnd-z.responseStart,parseDOMUsage:z.domComplete-z.domInteractive,firstPaintTime:z.responseStart-z.navigationStart,domReadyTime:z.domContentLoadedEventEnd-z.navigationStart,onloadTime:z.loadEventEnd-z.navigationStart};return(z=performance.memory)&&(A.jsHeapRatio=z.usedJSHeapSize/z.totalJSHeapSize),A}}},89889:(x,P,t)=>{"use strict";t.d(P,{S:()=>l,g:()=>a});var o=t(7975);function l(c){return o.pluginGroupPanel.find(C=>C.name===c)}function a(c){if(typeof c!="string")throw new Error("Plugin Name must be string");return c.startsWith("plugin:")?c:`plugin:${c}`}},77569:(x,P,t)=>{"use strict";t.d(P,{Wc:()=>A,Op:()=>O,Fv:()=>S,ud:()=>z});var o=t(43991),l=t(52983),a=t(47020),c=t.n(a),C=t(98281),y=t(58761),N=t(75526);const L=l.memo(()=>l.createElement(y.Z,null,l.createElement(N.Z,{type:"primary",size:"small",onClick:()=>window.location.reload()},(0,C.t)("\u7ACB\u5373\u5237\u65B0"))));L.displayName="UpdateNotificationBtn";const j=c()(()=>{setTimeout(()=>{o.Z.open({message:(0,C.t)("\u66F4\u65B0\u7248\u672C"),description:(0,C.t)("\u68C0\u6D4B\u5230\u6709\u65B0\u7248\u672C, \u662F\u5426\u7ACB\u5373\u5237\u65B0\u4EE5\u5347\u7EA7\u5230\u6700\u65B0\u5185\u5BB9"),duration:0,btn:l.createElement(L)})},2e3)});let W=null,B;function E(T){if(console.log("registered",T),T.waiting){console.log("updated",T),j();return}T.onupdatefound=()=>{console.log("updatefound",T);const h=T.installing;h!==null&&(h.onstatechange=()=>{h.state==="installed"&&(navigator.serviceWorker.controller?(console.log("updated",T),j()):console.log("cached",T))})}}function S(){"serviceWorker"in navigator&&(window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(T=>{console.log("SW registered: ",T),W=T,E(T)}).catch(T=>{console.log("SW registration failed: ",T)})}),window.addEventListener("beforeinstallprompt",T=>{B=T}))}function O(){return W}function z(){if(!B){(0,C.hJM)((0,C.t)("\u65E0\u6CD5\u5B89\u88C5"));return}B.prompt()}function A(){return!!B}},72297:(x,P,t)=>{"use strict";t.d(P,{Cr:()=>j,a:()=>o.stringify,no:()=>W,po:()=>B,qp:()=>o.parse});var o=t(46163),l=t.n(o),a=Object.defineProperty,c=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable,N=(E,S,O)=>S in E?a(E,S,{enumerable:!0,configurable:!0,writable:!0,value:O}):E[S]=O,L=(E,S)=>{for(var O in S||(S={}))C.call(S,O)&&N(E,O,S[O]);if(c)for(var O of c(S))y.call(S,O)&&N(E,O,S[O]);return E};function j(E){return new URL(E,location.href).href}function W(E){return(0,o.stringify)(L(L({},(0,o.parse)(window.location.search,{ignoreQueryPrefix:!0})),E),{skipNulls:!0})}function B(E){return`${location.origin}/invite/${E}`}},51208:(x,P,t)=>{"use strict";t.d(P,{Xp:()=>o});var o;(function(l){l[l.TEXT=0]="TEXT",l[l.GROUP=1]="GROUP",l[l.PLUGIN=2]="PLUGIN"})(o||(o={}))},65710:()=>{}},ir={};function X(x){var P=ir[x];if(P!==void 0)return P.exports;var t=ir[x]={id:x,loaded:!1,exports:{}};return ur[x].call(t.exports,t,t.exports,X),t.loaded=!0,t.exports}X.m=ur,(()=>{var x=[];X.O=(P,t,o,l)=>{if(t){l=l||0;for(var a=x.length;a>0&&x[a-1][2]>l;a--)x[a]=x[a-1];x[a]=[t,o,l];return}for(var c=1/0,a=0;a<x.length;a++){for(var[t,o,l]=x[a],C=!0,y=0;y<t.length;y++)(l&!1||c>=l)&&Object.keys(X.O).every(E=>X.O[E](t[y]))?t.splice(y--,1):(C=!1,l<c&&(c=l));if(C){x.splice(a--,1);var N=o();N!==void 0&&(P=N)}}return P}})(),(()=>{X.n=x=>{var P=x&&x.__esModule?()=>x.default:()=>x;return X.d(P,{a:P}),P}})(),(()=>{var x=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,P;X.t=function(t,o){if(o&1&&(t=this(t)),o&8||typeof t=="object"&&t&&(o&4&&t.__esModule||o&16&&typeof t.then=="function"))return t;var l=Object.create(null);X.r(l);var a={};P=P||[null,x({}),x([]),x(x)];for(var c=o&2&&t;typeof c=="object"&&!~P.indexOf(c);c=x(c))Object.getOwnPropertyNames(c).forEach(C=>a[C]=()=>t[C]);return a.default=()=>t,X.d(l,a),l}})(),(()=>{X.d=(x,P)=>{for(var t in P)X.o(P,t)&&!X.o(x,t)&&Object.defineProperty(x,t,{enumerable:!0,get:P[t]})}})(),(()=>{X.f={},X.e=x=>Promise.all(Object.keys(X.f).reduce((P,t)=>(X.f[t](x,P),P),[]))})(),(()=>{X.u=x=>""+({"152":"invite","179":"main","497":"entry"}[x]||x)+"."+{"20":"74346ca71ba5832bd3d9","108":"3688d3185257661f8b68","152":"e688b18b77afb64bd1eb","179":"106bcbcf386c63afa23c","212":"e461c0418452dda957ef","236":"a3f78a40f5f37656199d","258":"1d61cf71f54f2f987c3a","260":"7a384533a437d5ddf40e","497":"e1ec70be85d603fc7605","528":"ac69d20cfc6300fc3c90","538":"65d05a13d61982b8ebaa","556":"7ca110b57b308ff9ef08","579":"de13c3c70ec5c6b7f4ce","674":"f13d5f565bf93bc66fd3","746":"01c1939e790db4baace8","748":"6839dd2a2eb17f25b799","771":"2c2928020e8fdd928620","850":"ae765bf8777e89eb5366","899":"02afbb5c04045b9649aa","943":"1f96442c5ad4bce1e583","994":"552a810289903861fb8b"}[x]+".js"})(),(()=>{X.miniCssF=x=>"styles-"+{"179":"6abb608ed7bff9f90804","212":"cae6d88a200818a456b2","497":"e738542ab6491cf1d167","746":"cffed5362661d1d49c68","943":"459323d593baae514585"}[x]+".css"})(),(()=>{X.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(x){if(typeof window=="object")return window}}()})(),(()=>{X.o=(x,P)=>Object.prototype.hasOwnProperty.call(x,P)})(),(()=>{var x={},P="tailchat-web:";X.l=(t,o,l,a)=>{if(x[t]){x[t].push(o);return}var c,C;if(l!==void 0)for(var y=document.getElementsByTagName("script"),N=0;N<y.length;N++){var L=y[N];if(L.getAttribute("src")==t||L.getAttribute("data-webpack")==P+l){c=L;break}}c||(C=!0,c=document.createElement("script"),c.charset="utf-8",c.timeout=120,X.nc&&c.setAttribute("nonce",X.nc),c.setAttribute("data-webpack",P+l),c.src=t),x[t]=[o];var j=(B,E)=>{c.onerror=c.onload=null,clearTimeout(W);var S=x[t];if(delete x[t],c.parentNode&&c.parentNode.removeChild(c),S&&S.forEach(O=>O(E)),B)return B(E)},W=setTimeout(j.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=j.bind(null,c.onerror),c.onload=j.bind(null,c.onload),C&&document.head.appendChild(c)}})(),(()=>{X.r=x=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(x,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(x,"__esModule",{value:!0})}})(),(()=>{X.nmd=x=>(x.paths=[],x.children||(x.children=[]),x)})(),(()=>{X.p="/"})(),(()=>{if(typeof X!="undefined"){var x=X.u,P=X.e,t={},o={},l=function(){return 0};X.u=function(a){var c=x(a);return c+(t.hasOwnProperty(a)?"?"+t[a]:"")},X.e=function(a){var c=P(a);return c.catch(function(C){var y=o.hasOwnProperty(a)?o[a]:2;if(y<1){var N=x(a);throw C.message="Loading chunk "+a+` failed after 2 retries.
(`+N+")",C.request=N,C}return new Promise(function(L){var j=2-y+1;setTimeout(function(){var W="&retry-attempt="+j,B="cache-bust=true"+W;t[a]=B,o[a]=y-1,L(X.e(a))},l(j))})})}}})(),(()=>{if(typeof document!="undefined"){var x=(l,a,c,C,y)=>{var N=document.createElement("link");N.rel="stylesheet",N.type="text/css";var L=j=>{if(N.onerror=N.onload=null,j.type==="load")C();else{var W=j&&(j.type==="load"?"missing":j.type),B=j&&j.target&&j.target.href||a,E=new Error("Loading CSS chunk "+l+` failed.
(`+B+")");E.code="CSS_CHUNK_LOAD_FAILED",E.type=W,E.request=B,N.parentNode.removeChild(N),y(E)}};return N.onerror=N.onload=L,N.href=a,c?c.parentNode.insertBefore(N,c.nextSibling):document.head.appendChild(N),N},P=(l,a)=>{for(var c=document.getElementsByTagName("link"),C=0;C<c.length;C++){var y=c[C],N=y.getAttribute("data-href")||y.getAttribute("href");if(y.rel==="stylesheet"&&(N===l||N===a))return y}for(var L=document.getElementsByTagName("style"),C=0;C<L.length;C++){var y=L[C],N=y.getAttribute("data-href");if(N===l||N===a)return y}},t=l=>new Promise((a,c)=>{var C=X.miniCssF(l),y=X.p+C;if(P(C,y))return a();x(l,y,null,a,c)}),o={143:0};X.f.miniCss=(l,a)=>{var c={"179":1,"212":1,"497":1,"746":1,"943":1};o[l]?a.push(o[l]):o[l]!==0&&c[l]&&a.push(o[l]=t(l).then(()=>{o[l]=0},C=>{throw delete o[l],C}))}}})(),(()=>{var x={143:0};X.f.j=(o,l)=>{var a=X.o(x,o)?x[o]:void 0;if(a!==0)if(a)l.push(a[2]);else{var c=new Promise((L,j)=>a=x[o]=[L,j]);l.push(a[2]=c);var C=X.p+X.u(o),y=new Error,N=L=>{if(X.o(x,o)&&(a=x[o],a!==0&&(x[o]=void 0),a)){var j=L&&(L.type==="load"?"missing":L.type),W=L&&L.target&&L.target.src;y.message="Loading chunk "+o+` failed.
(`+j+": "+W+")",y.name="ChunkLoadError",y.type=j,y.request=W,a[1](y)}};X.l(C,N,"chunk-"+o,o)}},X.O.j=o=>x[o]===0;var P=(o,l)=>{var[a,c,C]=l,y,N,L=0;if(a.some(W=>x[W]!==0)){for(y in c)X.o(c,y)&&(X.m[y]=c[y]);if(C)var j=C(X)}for(o&&o(l);L<a.length;L++)N=a[L],X.o(x,N)&&x[N]&&x[N][0](),x[N]=0;return X.O(j)},t=self.webpackChunktailchat_web=self.webpackChunktailchat_web||[];t.forEach(P.bind(null,0)),t.push=P.bind(null,t.push.bind(t))})(),(()=>{X.nc=void 0})();var lr=X.O(void 0,[410,799,342],()=>X(81070));lr=X.O(lr)})();
