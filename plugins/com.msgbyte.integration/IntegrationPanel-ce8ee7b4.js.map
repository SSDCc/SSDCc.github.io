{"version":3,"file":"IntegrationPanel-ce8ee7b4.js","sources":["../../../plugins/com.msgbyte.integration/src/IntegrationPanel.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { Avatar, Button, Input, UserName } from '@capital/component';\nimport styled from 'styled-components';\nimport type { OpenAppInfo } from 'types';\nimport {\n  useAsyncRequest,\n  postRequest,\n  showErrorToasts,\n  useGroupIdContext,\n  showSuccessToasts,\n} from '@capital/common';\nimport { Translate } from './translate';\n\nconst Tip = styled.div`\n  color: #999;\n  margin-bottom: 10px;\n`;\n\nconst Row = styled.div`\n  display: flex;\n`;\n\nconst AppInfoCard = styled.div({\n  backgroundColor: 'rgba(0, 0, 0, 0.1)',\n  borderRadius: 3,\n  padding: 10,\n  marginTop: 10,\n\n  '.app-info': {\n    flex: 1,\n    marginLeft: 10,\n\n    '.title': {\n      fontSize: 18,\n      fontWeight: 'bold',\n    },\n\n    '.action': {\n      marginTop: 10,\n    },\n  },\n});\n\nconst IntegrationPanel: React.FC = React.memo(() => {\n  const [appId, setAppId] = useState('');\n  const [openAppInfo, setOpenAppInfo] = useState<OpenAppInfo | null>(null);\n  const groupId = useGroupIdContext();\n\n  const [{ loading }, handleQueryApp] = useAsyncRequest(async () => {\n    const { data } = await postRequest('/openapi/app/get', {\n      appId,\n    });\n\n    if (!data) {\n      showErrorToasts(Translate.notFoundApp);\n      return;\n    }\n\n    setOpenAppInfo(data);\n  }, [appId]);\n\n  const [{ loading: addBotLoading }, handleAddBotIntoGroup] =\n    useAsyncRequest(async () => {\n      await postRequest('/openapi/integration/addBotUser', {\n        appId,\n        groupId,\n      });\n      showSuccessToasts();\n    }, [appId]);\n\n  return (\n    <div>\n      <Tip>{Translate.onlyAllowManualAddition}</Tip>\n\n      <Row>\n        <Input\n          placeholder={Translate.appId}\n          value={appId}\n          onChange={(e) => setAppId(e.target.value)}\n        />\n        <Button\n          type=\"primary\"\n          disabled={!appId}\n          loading={loading}\n          onClick={handleQueryApp}\n        >\n          {Translate.search}\n        </Button>\n      </Row>\n\n      {openAppInfo && (\n        <div>\n          <AppInfoCard>\n            <Row>\n              <Avatar\n                size={56}\n                src={openAppInfo.appIcon}\n                name={openAppInfo.appName}\n              />\n\n              <div className=\"app-info\">\n                <div>{openAppInfo.appName}</div>\n                <div>{openAppInfo.appDesc}</div>\n                <Row>\n                  <div>{Translate.developer}:</div>\n                  <UserName userId={openAppInfo.owner} />\n                </Row>\n\n                <div className=\"action\">\n                  {openAppInfo.capability.includes('bot') && (\n                    <Button\n                      type=\"primary\"\n                      size=\"small\"\n                      loading={addBotLoading}\n                      onClick={handleAddBotIntoGroup}\n                    >\n                      {Translate.addBot}\n                    </Button>\n                  )}\n                </div>\n              </div>\n            </Row>\n          </AppInfoCard>\n        </div>\n      )}\n    </div>\n  );\n});\nIntegrationPanel.displayName = 'IntegrationPanel';\n\nexport default IntegrationPanel;\n"],"names":["styled","React","useState","useGroupIdContext","useAsyncRequest","postRequest","showErrorToasts","Translate","showSuccessToasts","Input","Button","Avatar","UserName"],"mappings":"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"}