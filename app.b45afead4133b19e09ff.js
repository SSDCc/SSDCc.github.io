(()=>{var or={93540:(U,O,e)=>{"use strict";e.d(O,{wb:()=>a,qE:()=>fe,OI:()=>Te,EW:()=>rt,v$:()=>ge,a3:()=>lt,y$:()=>Bt,JO:()=>st,Ee:()=>Oe,PJ:()=>$e,Po:()=>En,_D:()=>We.createFastifyFormSchema,Yy:()=>Y,_6:()=>We.fieldSchema,Yk:()=>we,YE:()=>Yn,aG:()=>We.useFastifyFormContext,tF:()=>We.useFastifyFormContext});var o=e(52983),c=e(80686);const a=o.memo(u=>{const{showFullText:d="More",backgroundColor:y="white"}=u,[Z,oe]=(0,o.useState)(!1),[ne,q]=(0,o.useState)(!1),me=(0,o.useRef)(null);(0,o.useEffect)(()=>{if(!me.current)return;const tt=new window.ResizeObserver(ke=>{if(ke[0]){const{height:Ot}=ke[0].contentRect;Ot>Ee&&(q(!1),oe(!0),tt.disconnect())}});return tt.observe(me.current),()=>{tt.disconnect()}},[]);const Ee=(0,o.useMemo)(()=>ne?"none":u.maxHeight,[ne,u.maxHeight]),ce=(0,c.Z)(()=>{oe(!1),q(!0)});return o.createElement("div",{style:{maxHeight:Ee,overflow:"hidden",position:"relative"}},o.createElement("div",{ref:me},u.children),Z&&o.createElement("div",{style:{position:"absolute",left:0,right:0,bottom:0,textAlign:"center",cursor:"pointer",backgroundImage:`linear-gradient(rgba(0,0,0,0), ${y})`,padding:"4px 0"},onClick:ce},d))});a.displayName="AutoFolder";var i=e(27037),N=e(68e3),p=e(95718),A=e.n(p),L=e(18445),C=e.n(L),Q=e(14698),z=e.n(Q),j=e(29787),S=e.n(j),P=e(3224),x=e.n(P),h=e(73352),T=e.n(h),E=e(76705),m=e.n(E),g=e(35880),K=e.n(g);const R=["#333333","#2c3e50","#8e44ad","#2980b9","#27ae60","#16a085","#f39c12","#d35400","#c0392b","#3498db","#9b59b6","#2ecc71","#1abc9c","#f1c40f","#e74c3c","#e67e22"];function Y(u){if(!u||!m()(u))return"#ffffff";const d=K()(u);return R[d%R.length]}function F(u){return u*(1/16)+"rem"}function J(u){return typeof u=="string"&&u!==""}var X=e(81715),re=Object.defineProperty,Ie=Object.defineProperties,je=Object.getOwnPropertyDescriptors,te=Object.getOwnPropertySymbols,De=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable,Le=(u,d,y)=>d in u?re(u,d,{enumerable:!0,configurable:!0,writable:!0,value:y}):u[d]=y,Je=(u,d)=>{for(var y in d||(d={}))De.call(d,y)&&Le(u,y,d[y]);if(te)for(var y of te(d))Ae.call(d,y)&&Le(u,y,d[y]);return u},Pe=(u,d)=>Ie(u,je(d));let xe=u=>u;const ve="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBddr//5/DGRjYNRkY/l7////39v///y4Dmn+LgeHANwDrkl1AuO+pmgAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAwqADAAQAAAABAAAAwwAAAAD9b/HnAAAHlklEQVR4Ae3dP3PTWBSGcbGzM6GCKqlIBRV0dHRJFarQ0eUT8LH4BnRU0NHR0UEFVdIlFRV7TzRksomPY8uykTk/zewQfKw/9znv4yvJynLv4uLiV2dBoDiBf4qP3/ARuCRABEFAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghgg0Aj8i0JO4OzsrPv69Wv+hi2qPHr0qNvf39+iI97soRIh4f3z58/u7du3SXX7Xt7Z2enevHmzfQe+oSN2apSAPj09TSrb+XKI/f379+08+A0cNRE2ANkupk+ACNPvkSPcAAEibACyXUyfABGm3yNHuAECRNgAZLuYPgEirKlHu7u7XdyytGwHAd8jjNyng4OD7vnz51dbPT8/7z58+NB9+/bt6jU/TI+AGWHEnrx48eJ/EsSmHzx40L18+fLyzxF3ZVMjEyDCiEDjMYZZS5wiPXnyZFbJaxMhQIQRGzHvWR7XCyOCXsOmiDAi1HmPMMQjDpbpEiDCiL358eNHurW/5SnWdIBbXiDCiA38/Pnzrce2YyZ4//59F3ePLNMl4PbpiL2J0L979+7yDtHDhw8vtzzvdGnEXdvUigSIsCLAWavHp/+qM0BcXMd/q25n1vF57TYBp0a3mUzilePj4+7k5KSLb6gt6ydAhPUzXnoPR0dHl79WGTNCfBnn1uvSCJdegQhLI1vvCk+fPu2ePXt2tZOYEV6/fn31dz+shwAR1sP1cqvLntbEN9MxA9xcYjsxS1jWR4AIa2Ibzx0tc44fYX/16lV6NDFLXH+YL32jwiACRBiEbf5KcXoTIsQSpzXx4N28Ja4BQoK7rgXiydbHjx/P25TaQAJEGAguWy0+2Q8PD6/Ki4R8EVl+bzBOnZY95fq9rj9zAkTI2SxdidBHqG9+skdw43borCXO/ZcJdraPWdv22uIEiLA4q7nvvCug8WTqzQveOH26fodo7g6uFe/a17W3+nFBAkRYENRdb1vkkz1CH9cPsVy/jrhr27PqMYvENYNlHAIesRiBYwRy0V+8iXP8+/fvX11Mr7L7ECueb/r48eMqm7FuI2BGWDEG8cm+7G3NEOfmdcTQw4h9/55lhm7DekRYKQPZF2ArbXTAyu4kDYB2YxUzwg0gi/41ztHnfQG26HbGel/crVrm7tNY+/1btkOEAZ2M05r4FB7r9GbAIdxaZYrHdOsgJ/wCEQY0J74TmOKnbxxT9n3FgGGWWsVdowHtjt9Nnvf7yQM2aZU/TIAIAxrw6dOnAWtZZcoEnBpNuTuObWMEiLAx1HY0ZQJEmHJ3HNvGCBBhY6jtaMoEiJB0Z29vL6ls58vxPcO8/zfrdo5qvKO+d3Fx8Wu8zf1dW4p/cPzLly/dtv9Ts/EbcvGAHhHyfBIhZ6NSiIBTo0LNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiEC/wGgKKC4YMA4TAAAAABJRU5ErkJggg==",Oe=o.memo(u=>o.createElement(X.Z,Pe(Je({fallback:ve,preview:!1,loading:"lazy"},u),{src:u.src?xe(u.src):void 0})));Oe.displayName="Image";function we(u){xe=u}var B=Object.defineProperty,b=Object.defineProperties,$=Object.getOwnPropertyDescriptors,G=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,H=(u,d,y)=>d in u?B(u,d,{enumerable:!0,configurable:!0,writable:!0,value:y}):u[d]=y,V=(u,d)=>{for(var y in d||(d={}))M.call(d,y)&&H(u,y,d[y]);if(G)for(var y of G(d))W.call(d,y)&&H(u,y,d[y]);return u},ee=(u,d)=>b(u,$(d)),ue=(u,d)=>{var y={};for(var Z in u)M.call(u,Z)&&d.indexOf(Z)<0&&(y[Z]=u[Z]);if(u!=null&&G)for(var Z of G(u))d.indexOf(Z)<0&&W.call(u,Z)&&(y[Z]=u[Z]);return y};const de=o.memo(u=>{const d=u,{isOnline:y}=d,Z=ue(d,["isOnline"]),oe=J(Z.src)?xe(Z.src):void 0,ne=(0,o.useMemo)(()=>C()(A()(Z.name)),[Z.name]),q=(0,o.useMemo)(()=>S()(oe)&&z()(Z.icon)?Y(Z.name):void 0,[oe,Z.icon,Z.name]),me=(0,o.useMemo)(()=>{const ce=ee(V({userSelect:"none"},Z.style),{backgroundColor:q,display:"flex",justifyContent:"center",alignItems:"center"});return x()(Z.size)&&(ce.width||(ce.width=F(Z.size)),ce.height||(ce.height=F(Z.size)),typeof ce.fontSize=="undefined"&&(ce.fontSize=F(Z.size*.4))),ce},[Z.style,Z.size,q]),Ee=o.createElement(i.C,ee(V({draggable:!1},T()(Z,["size"])),{src:oe,style:me}),ne);if(typeof y=="boolean"){const ce={bottom:0,top:"auto"};return y===!0?o.createElement(N.Z,{dot:!0,color:"green",style:ce},Ee):o.createElement(N.Z,{dot:!0,color:"#999",style:ce},Ee)}return Ee});de.displayName="Avatar";const fe=de;fe.Group=i.C.Group;var k=Object.defineProperty,le=Object.getOwnPropertySymbols,ie=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable,Qe=(u,d,y)=>d in u?k(u,d,{enumerable:!0,configurable:!0,writable:!0,value:y}):u[d]=y,Ze=(u,d)=>{for(var y in d||(d={}))ie.call(d,y)&&Qe(u,y,d[y]);if(le)for(var y of le(d))Re.call(d,y)&&Qe(u,y,d[y]);return u};const Te=o.memo(u=>{const[d,y]=(0,o.useState)(!1),Z=typeof u.src=="string";return o.createElement(o.Fragment,null,o.createElement("div",{style:{cursor:Z?"pointer":"auto"},onClick:()=>y(!d)},o.createElement(fe,Ze({},u))),Z&&o.createElement("div",{style:{display:"none"}},o.createElement(Oe,{preview:{visible:d,src:xe(String(u.src)),onVisibleChange:oe=>{y(oe)}}})))});Te.displayName="AvatarWithPreview";var Se=e(75283);const ge=o.memo(u=>{var d;return o.createElement(Se.Z.Text,{className:u.className,style:u.style,copyable:(d=u.config)!=null?d:!0},u.children)});ge.displayName="CopyableText";var ze=e(89022),_e=e.n(ze),xt=Object.defineProperty,nt=Object.getOwnPropertySymbols,Ut=Object.prototype.hasOwnProperty,Et=Object.prototype.propertyIsEnumerable,ft=(u,d,y)=>d in u?xt(u,d,{enumerable:!0,configurable:!0,writable:!0,value:y}):u[d]=y,ht=(u,d)=>{for(var y in d||(d={}))Ut.call(d,y)&&ft(u,y,d[y]);if(nt)for(var y of nt(d))Et.call(d,y)&&ft(u,y,d[y]);return u};const rt=o.memo(u=>{const{size:d=32,shape:y="circle"}=u,Z=_e()(u.items,4),oe=Z.length,ne=q=>{if(oe===1)return{};if(oe===2){if(q===0)return{width:"50%",overflow:"hidden",position:"absolute",left:0};if(q===1)return{width:"50%",overflow:"hidden",position:"absolute",right:0}}if(oe===3){if(q===0)return{width:"50%",overflow:"hidden",position:"absolute",left:0};if(q===1)return{transform:"scale(50%)",transformOrigin:"100% 0 0"};if(q===2)return{transform:"scale(50%)",transformOrigin:"100% 100% 0"}}if(oe===4){if(q===0)return{transform:"scale(50%)",transformOrigin:"0 0 0"};if(q===1)return{transform:"scale(50%)",transformOrigin:"100% 0 0"};if(q===2)return{transform:"scale(50%)",transformOrigin:"0 100% 0"};if(q===3)return{transform:"scale(50%)",transformOrigin:"100% 100% 0"}}return{}};return o.createElement("div",{className:`td-combined-avatar td-combined-avatar-${oe}`,style:{width:F(d),height:F(d),borderRadius:y==="circle"?"50%":3}},Z.map((q,me)=>o.createElement(fe,ht({key:me,className:"td-combined-avatar__item",style:ne(me),size:d},q))),Z.length>=2&&o.createElement("div",{className:"line1"}),Z.length>=3&&o.createElement("div",{className:"line2"}))});rt.displayName="CombinedAvatar";var Ft=e(95268),ot=Object.defineProperty,Mt=Object.getOwnPropertySymbols,Rt=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable,pe=(u,d,y)=>d in u?ot(u,d,{enumerable:!0,configurable:!0,writable:!0,value:y}):u[d]=y,Ne=(u,d)=>{for(var y in d||(d={}))Rt.call(d,y)&&pe(u,y,d[y]);if(Mt)for(var y of Mt(d))ae.call(d,y)&&pe(u,y,d[y]);return u};const lt=o.memo(u=>o.createElement(Ft.Z,Ne({mouseEnterDelay:1},u),u.children));lt.displayName="DelayTip";const Yt={highLight:"_-packages-design-components-Highlight-index-module__highLight--esAq-"},Bt=o.memo(u=>o.createElement("span",{className:Yt.highLight},u.children));Bt.displayName="Highlight";var gt=e(79555),Pn=Object.defineProperty,On=Object.defineProperties,Cn=Object.getOwnPropertyDescriptors,Kt=Object.getOwnPropertySymbols,Jt=Object.prototype.hasOwnProperty,jn=Object.prototype.propertyIsEnumerable,Zt=(u,d,y)=>d in u?Pn(u,d,{enumerable:!0,configurable:!0,writable:!0,value:y}):u[d]=y,Ht=(u,d)=>{for(var y in d||(d={}))Jt.call(d,y)&&Zt(u,y,d[y]);if(Kt)for(var y of Kt(d))jn.call(d,y)&&Zt(u,y,d[y]);return u},Tn=(u,d)=>On(u,Cn(d));const Sn={width:"1em",height:"1em"},it=o.memo(u=>{const[d,y]=(0,o.useState)(!1);return o.createElement(o.Fragment,null,o.createElement(gt.JO,Tn(Ht({},u),{onLoad:()=>y(!0)})),!d&&o.createElement("span",{style:Sn}))});it.displayName="Icon";const st=it;st.addIcon=gt.Ug,st.addCollection=gt.Hc;const $e=o.memo(u=>{const{className:d,text:y}=u,[Z,oe]=(0,o.useState)(!1);return o.createElement("div",{className:d,style:{display:"flex",alignItems:"center"}},Z?y:Dt(y),o.createElement(st,{style:{cursor:"pointer",marginLeft:4},icon:Z?"mdi:eye-off-outline":"mdi:eye-outline",onClick:()=>oe(ne=>!ne)}))});$e.displayName="SensitiveText";function Dt(u){const d=u.length;return d>2?`${u[0]}****${u[d-1]}`:d===2?`${u[0]}*`:"**"}const mt=o.memo(u=>{const d=(0,o.useRef)(null),y=(0,c.Z)(Z=>{u.onResize&&u.onResize(Z)});return(0,o.useEffect)(()=>{if(!d.current)return;const Z=new ResizeObserver(oe=>{oe.forEach(ne=>{const{target:q,contentRect:me}=ne;!q.parentElement||y({width:Math.round(me.width),height:Math.round(me.height)})})});return Z.observe(d.current),()=>{Z&&d.current&&(Z.unobserve(d.current),Z.disconnect())}},[]),o.createElement("div",{style:u.wrapperStyle,ref:d},u.children)});mt.displayName="ResizeWatcher";var wt=e(7744),Vt=e(37459),$t=e(14517),Ln=Object.defineProperty,kt=Object.defineProperties,Xt=Object.getOwnPropertyDescriptors,_t=Object.getOwnPropertySymbols,ct=Object.prototype.hasOwnProperty,zn=Object.prototype.propertyIsEnumerable,At=(u,d,y)=>d in u?Ln(u,d,{enumerable:!0,configurable:!0,writable:!0,value:y}):u[d]=y,qt=(u,d)=>{for(var y in d||(d={}))ct.call(d,y)&&At(u,y,d[y]);if(_t)for(var y of _t(d))zn.call(d,y)&&At(u,y,d[y]);return u},Qt=(u,d)=>kt(u,Xt(d));const qe={x:0,y:0},en=o.forwardRef((u,d)=>{var y,Z;const{scrollBehavior:oe="auto"}=u,ne=(0,o.useRef)(null),q=(0,o.useRef)(null),me=(0,o.useMemo)(()=>{var Ge;return((Ge=u.isLock)!=null?Ge:!1)?Qt(qt({},u.style),{overflow:"hidden"}):Qt(qt({},u.style),{overflow:"auto"})},[u.isLock]),Ee=(0,c.Z)(()=>ne.current?{x:ne.current.scrollLeft,y:ne.current.scrollTop}:qe),ce=(0,c.Z)(()=>ne.current?{x:ne.current.clientWidth,y:ne.current.clientHeight}:qe);(0,o.useImperativeHandle)(d,()=>({scrollTo:Ge=>{var at;(at=ne.current)==null||at.scrollTo({left:Ge.x,top:Ge.y,behavior:oe})},scrollToBottom:()=>{var Ge;(Ge=ne.current)==null||Ge.scrollTo({left:Ee().x,top:ne.current.scrollHeight-ce().y,behavior:oe})}}));const[tt,ke]=(0,o.useState)(!1),[Ot,hn]=(0,o.useState)(!1),{run:Kn}=(0,wt.Z)(Ge=>{ke(Ge)},{leading:!1,trailing:!0,wait:300}),{run:Jn}=(0,wt.Z)(()=>{ke(!1),u.onScrollEnd&&u.onScrollEnd(Ee())},{leading:!1,trailing:!0,wait:300}),Zn=(0,c.Z)(()=>{ke(!0),Kn(!1)}),Hn=(0,c.Z)(()=>{hn(!0)}),Dn=(0,c.Z)(()=>{hn(!1)}),Ct=(y=(0,Vt.Z)(Ee()))!=null?y:qe,An=(0,c.Z)(()=>{const Ge=tt||Ot,at=Ee(),$n={x:at.x>Ct.x,y:at.y>Ct.y};ke(!0),Jn(),u.onScroll&&u.onScroll(at,{forward:$n,isUserScrolling:Ge,isMouseDown:Ot})}),Vn=(0,c.Z)(()=>{u.onContainerResize&&u.onContainerResize({containerSize:ce(),position:Ee()})});return o.createElement(mt,{wrapperStyle:{height:"100%"},onResize:Vn},o.createElement("div",{key:"scroller",className:(0,$t.Z)(u.className,"scroller",{[(Z=u.scrollingClassName)!=null?Z:"scrolling"]:tt}),style:me,ref:ne,onWheel:Zn,onMouseDown:Hn,onMouseUp:Dn,onScroll:An},o.createElement("div",{className:"scroller-inner",key:"scroller-inner",style:u.innerStyle,ref:q},u.children)))});en.displayName="Scroller";var xn=e(52486),tn=Object.defineProperty,nn=Object.getOwnPropertySymbols,rn=Object.prototype.hasOwnProperty,Un=Object.prototype.propertyIsEnumerable,on=(u,d,y)=>d in u?tn(u,d,{enumerable:!0,configurable:!0,writable:!0,value:y}):u[d]=y,It=(u,d)=>{for(var y in d||(d={}))rn.call(d,y)&&on(u,y,d[y]);if(nn)for(var y of nn(d))Un.call(d,y)&&on(u,y,d[y]);return u};const sn={overflow:"hidden"},Fn={height:"100%"},Rn={height:"100%"},an=u=>{const d=(0,o.useRef)(null),y=(0,o.useMemo)(()=>new Map,[]),Z=(0,xn.Z)(),oe=(0,o.useMemo)(()=>It(It({},sn),u.style),[u.style]),ne=(0,o.useMemo)(()=>It(It({},Fn),u.innerStyle),[u.innerStyle]);return(0,o.useEffect)(()=>{var q;(q=d.current)==null||q.scrollToBottom()},[]),o.createElement("div",{className:"virtual-chat-list",style:oe},o.createElement(en,{ref:d,style:Rn,innerStyle:ne},u.items.map((q,me)=>o.createElement("div",{key:u.getItemKey?u.getItemKey(q):me,className:"virtual-chat-list__item",style:{height:y.get(q)}},o.createElement(mt,{onResize:Ee=>{y.set(q,Ee.height),Z()}},u.itemContent(q,me))))))},pt=o.memo(an);pt.displayName="VirtualChatList";var We=e(80768),be=e(579),Me=e(75526),Wt=e(79546);function Nt(u){return u===void 0||u===""?"":"error"}const un=o.memo(u=>{const{name:d,label:y,value:Z,onChange:oe,onBlur:ne,error:q,maxLength:me,placeholder:Ee}=u;return o.createElement(be.Z.Item,{label:y,validateStatus:Nt(q),help:q},o.createElement(Wt.Z,{name:d,size:"large",maxLength:me,placeholder:Ee,value:Z,onChange:ce=>oe(ce.target.value),onBlur:ne}))});un.displayName="FastifyFormText";const ln=o.memo(u=>{const{name:d,label:y,value:Z,onChange:oe,onBlur:ne,error:q,maxLength:me,placeholder:Ee}=u;return o.createElement(be.Z.Item,{label:y,validateStatus:Nt(q),help:q},o.createElement(Wt.Z.TextArea,{name:d,rows:4,maxLength:me,placeholder:Ee,value:Z,onChange:ce=>oe(ce.target.value),onBlur:ne}))});ln.displayName="FastifyFormTextArea";const bt=o.memo(u=>{const{name:d,label:y,value:Z,onChange:oe,onBlur:ne,error:q,maxLength:me,placeholder:Ee}=u;return o.createElement(be.Z.Item,{label:y,validateStatus:Nt(q),help:q},o.createElement(Wt.Z.Password,{name:d,type:"password",size:"large",maxLength:me,placeholder:Ee,value:Z,onChange:ce=>oe(ce.target.value),onBlur:ne}))});bt.displayName="FastifyFormPassword";var cn=e(73246),Bn=e(13546),dn=e.n(Bn);const et=cn.Z.Option,vt=o.memo(u=>{const{name:d,label:y,value:Z,onChange:oe,onBlur:ne,options:q}=u;return(0,o.useEffect)(()=>{(z()(Z)||Z==="")&&oe(dn()(q,[0,"value"]))},[]),o.createElement(be.Z.Item,{label:y},o.createElement(cn.Z,{size:"large",value:Z,onChange:me=>oe(me),onBlur:ne},q.map((me,Ee)=>o.createElement(et,{key:`${me.value}${Ee}`,value:me.value},me.label))))});vt.displayName="FastifyFormSelect";var wn=e(66990);const Gt=o.memo(u=>{const{name:d,label:y,value:Z,onChange:oe,error:ne}=u;return o.createElement(be.Z.Item,{label:y,validateStatus:Nt(ne),help:ne},o.createElement(wn.Z,{name:d,checked:Boolean(Z),onChange:q=>oe(q.target.checked)},y))});Gt.displayName="FastifyFormCheckbox";var yt=Object.defineProperty,fn=Object.getOwnPropertySymbols,Qn=Object.prototype.hasOwnProperty,Mn=Object.prototype.propertyIsEnumerable,gn=(u,d,y)=>d in u?yt(u,d,{enumerable:!0,configurable:!0,writable:!0,value:y}):u[d]=y,Wn=(u,d)=>{for(var y in d||(d={}))Qn.call(d,y)&&gn(u,y,d[y]);if(fn)for(var y of fn(d))Mn.call(d,y)&&gn(u,y,d[y]);return u};const mn=o.memo(u=>{const{label:d}=u;return o.createElement(be.Z.Item,{label:d},o.createElement(We.CustomField,Wn({},u)))});mn.displayName="FastifyFormCustom";var pn=Object.defineProperty,Pt=Object.getOwnPropertySymbols,bn=Object.prototype.hasOwnProperty,Gn=Object.prototype.propertyIsEnumerable,ye=(u,d,y)=>d in u?pn(u,d,{enumerable:!0,configurable:!0,writable:!0,value:y}):u[d]=y,vn=(u,d)=>{for(var y in d||(d={}))bn.call(d,y)&&ye(u,y,d[y]);if(Pt)for(var y of Pt(d))Gn.call(d,y)&&ye(u,y,d[y]);return u};(0,We.regField)("text",un),(0,We.regField)("textarea",ln),(0,We.regField)("password",bt),(0,We.regField)("select",vt),(0,We.regField)("checkbox",Gt),(0,We.regField)("custom",mn);let dt={submitLabel:"Submit"};function Yn(u){dt=vn(vn({},dt),u)}const yn=o.memo(u=>{const d=u.layout,y=(0,o.useMemo)(()=>{var Z;return o.createElement(be.Z.Item,{wrapperCol:d==="vertical"?{xs:24}:{sm:24,md:{span:16,offset:8}}},o.createElement(Me.Z,{loading:u.loading,type:"primary",size:"large",htmlType:"button",style:{width:"100%"},onClick:()=>u.handleSubmit(),disabled:u.canSubmit===!1},(Z=u.submitLabel)!=null?Z:dt.submitLabel))},[u.loading,u.handleSubmit,u.canSubmit,u.submitLabel,d]);return o.createElement(be.Z,{layout:d,labelCol:d==="vertical"?{xs:24}:{sm:24,md:8},wrapperCol:d==="vertical"?{xs:24}:{sm:24,md:16}},u.children,y)});yn.displayName="WebFastifyFormContainer",(0,We.regFormContainer)(yn);const En=We.FastifyForm;En.displayName="WebMetaForm"},72163:(U,O,e)=>{"use strict";e.d(O,{W:()=>S});var o=e(95326),c=e.n(o),a=e(13546),i=e.n(a),N=e(45563),p=e.n(N),A=e(19692),L=e(71205),C=e(49076),Q=(P,x,h)=>new Promise((T,E)=>{var m=R=>{try{K(h.next(R))}catch(Y){E(Y)}},g=R=>{try{K(h.throw(R))}catch(Y){E(Y)}},K=R=>R.done?T(R.value):Promise.resolve(R.value).then(m,g);K((h=h.apply(P,x)).next())});class z extends Error{}function j(){const P=c().create({baseURL:(0,C.qQ)()});return(0,C.A6)(x=>{P.defaults.baseURL=x()}),P.interceptors.request.use(x=>Q(this,null,function*(){return["post","get"].includes(String(x.method).toLowerCase())&&!x.headers["X-Token"]&&(x.headers["X-Token"]=yield(0,L.mx)()),x})),P.interceptors.response.use(x=>(x.data=i()(x.data,"data",x.data),x),x=>{var h;const T=(h=i()(x,"response.data"))!=null?h:{};let E=T.message;const m=T.code;if(T.type==="VALIDATION_ERROR"&&(E=(0,A.t)("\u8BF7\u6C42\u53C2\u6570\u6821\u9A8C\u5931\u8D25"),Array.isArray(T.data))){console.error(JSON.stringify(T.data));try{E+=`: ${T.data.map(g=>g.field).join(", ")}`}catch(g){}}if(p()(L.Jd)&&(0,L.Jd)(x)===!1)return{data:{result:!1,msg:E,code:m}};throw new z(E??x.message)}),P}const S=j()},62789:(U,O,e)=>{"use strict";e.d(O,{D6:()=>g,Ml:()=>R,U$:()=>Y,ct:()=>K,pG:()=>E,r5:()=>m,r7:()=>T});var o=e(22149),c=e(19478),a=e(75135),i=e(77100),N=e(58787),p=e(31672),A=Object.defineProperty,L=Object.defineProperties,C=Object.getOwnPropertyDescriptors,Q=Object.getOwnPropertySymbols,z=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable,S=(F,J,X)=>J in F?A(F,J,{enumerable:!0,configurable:!0,writable:!0,value:X}):F[J]=X,P=(F,J)=>{for(var X in J||(J={}))z.call(J,X)&&S(F,X,J[X]);if(Q)for(var X of Q(J))j.call(J,X)&&S(F,X,J[X]);return F},x=(F,J)=>L(F,C(J)),h=(F,J,X)=>new Promise((re,Ie)=>{var je=Ae=>{try{De(X.next(Ae))}catch(Le){Ie(Le)}},te=Ae=>{try{De(X.throw(Ae))}catch(Le){Ie(Le)}},De=Ae=>Ae.done?re(Ae.value):Promise.resolve(Ae.value).then(je,te);De((X=X.apply(F,J)).next())}),T=(F=>(F.user="user",F.converse="converse",F.baseGroupInfo="baseGroupInfo",F.groupInvite="groupInvite",F.pluginRegistry="pluginRegistry",F.userSettings="userSettings",F))(T||{});function E(F,J=!1){return h(this,null,function*(){return yield p.E.fetchQuery(["user",F],()=>(0,i.fetchUserInfo)(F),{staleTime:J?0:2*60*60*1e3})})}function m(F){return h(this,null,function*(){return yield p.E.fetchQuery(["converse",F],()=>(0,o.jW)(F))})}function g(F){return h(this,null,function*(){return yield p.E.fetchQuery(["baseGroupInfo",F],()=>(0,c.getGroupBasicInfo)(F))})}function K(F){return h(this,null,function*(){return yield p.E.fetchQuery(["groupInvite",F],()=>(0,c.findGroupInviteByCode)(F))})}function R(){return h(this,null,function*(){return yield p.E.fetchQuery(["pluginRegistry"],()=>Promise.all([(0,a.c0)().catch(()=>[]),(0,a.g3)().then(J=>J.map(X=>{const re=x(P({},X),{url:(0,N.A)(X.url)});return X.icon&&(re.icon=(0,N.A)(X.icon)),X.documentUrl&&(re.documentUrl=(0,N.A)(X.documentUrl)),re})).catch(()=>[]),(0,a.zd)().catch(()=>[])]).then(([J,X,re])=>[...J,...X,...re]),{staleTime:2*60*60*1e3})})}function Y(){return h(this,null,function*(){return yield p.E.fetchQuery(["userSettings"],()=>(0,i.getUserSettings)(),{staleTime:10*60*1e3})})}},31672:(U,O,e)=>{"use strict";e.d(O,{E:()=>i,L:()=>N});var o=e(56523),c=e(52500),a=e(54284);const i=new o.S({defaultOptions:{queries:{staleTime:10*1e3}}}),N=(0,c.S)({storage:{getItem:p=>(0,a.cF)().get(p),setItem:(p,A)=>(0,a.cF)().set(p,A),removeItem:p=>(0,a.cF)().remove(p)}})},96393:(U,O,e)=>{"use strict";e.d(O,{w:()=>c});var o=e(31672);function c(a,i,N){const p=(...C)=>o.E.fetchQuery([a,JSON.stringify(C)],()=>i(...C),N),A=()=>o.E.refetchQueries([a]),L=()=>{o.E.removeQueries([a])};return p.refetch=A,p.clearCache=L,p}},99852:(U,O,e)=>{"use strict";e.d(O,{A:()=>p,J:()=>A});var o=e(52983),c=e(40160),a=e(66932),i=e.n(a);const N=new a.EventEmitter,p={on(L,C){N.on(L,C)},off(L,C){N.off(L,C)},emit(L,...C){N.emit(L,...C)}};function A(L,C){const Q=(0,c.y)(C);(0,o.useEffect)(()=>{const z=(...j)=>{Q.current(...j)};return p.on(L,z),()=>{p.off(L,z)}},[])}},96228:(U,O,e)=>{"use strict";e.d(O,{No:()=>h,S8:()=>T,tx:()=>x});var o=e(30831),c=e(62789),a=e(19692),i=e(77100),N=Object.defineProperty,p=Object.defineProperties,A=Object.getOwnPropertyDescriptors,L=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable,z=(E,m,g)=>m in E?N(E,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):E[m]=g,j=(E,m)=>{for(var g in m||(m={}))C.call(m,g)&&z(E,g,m[g]);if(L)for(var g of L(m))Q.call(m,g)&&z(E,g,m[g]);return E},S=(E,m)=>p(E,A(m)),P=(E,m,g)=>new Promise((K,R)=>{var Y=X=>{try{J(g.next(X))}catch(re){R(re)}},F=X=>{try{J(g.throw(X))}catch(re){R(re)}},J=X=>X.done?K(X.value):Promise.resolve(X.value).then(Y,F);J((g=g.apply(E,m)).next())});function x(E,m){return P(this,null,function*(){const g=yield(0,c.r5)(E);if(g===null)throw new Error((0,a.t)("\u627E\u4E0D\u5230\u79C1\u4FE1\u4F1A\u8BDD"));if(!g.members.includes(m))throw new Error((0,a.t)("\u4F1A\u8BDD\u6CA1\u6709\u6743\u9650"));return yield(0,i.appendUserDMConverse)(E),g})}function h(E){return E.reduce((g,K)=>S(j({},g),{[K.id]:K.nickname}),{})}function T(E,m){return P(this,null,function*(){var g;if((0,o.YQu)(m.name))return m.name;const K=m.members.filter(re=>re!==E),R=yield Promise.all(K.map(re=>(0,c.pG)(re))),Y=(0,o.vIP)().getState().user.friends,F=h(Y),J=R.map(re=>{var Ie;return F[re._id]?F[re._id]:(Ie=re.nickname)!=null?Ie:""}),X=J.length;return X===1?(g=J[0])!=null?g:"":X===2?`${J[0]}, ${J[1]}`:`${J[0]}, ${J[1]} ...`})}},40160:(U,O,e)=>{"use strict";e.d(O,{y:()=>c});var o=e(52983);function c(a){const i=(0,o.useRef)(a);return i.current=a,i}},19692:(U,O,e)=>{"use strict";e.d(O,{$G:()=>x,G3:()=>j,Yt:()=>Q,lT:()=>P,m0:()=>z,t:()=>C,t4:()=>S});var o=e(21357),c=e(96605),a=e(23951),i=e(2773),N=e(74105),p=e(52983),A=e(35005),L=(h,T,E)=>new Promise((m,g)=>{var K=F=>{try{Y(E.next(F))}catch(J){g(J)}},R=F=>{try{Y(E.throw(F))}catch(J){g(J)}},Y=F=>F.done?m(F.value):Promise.resolve(F.value).then(K,R);Y((E=E.apply(h,T)).next())});o.ZP.use(N.lB).use(A.Z).use(c.Db).init({fallbackLng:N.X9,load:"currentOnly",backend:{loadPath:"/locales/{{lng}}/{{ns}}.json",allowMultiLoading:!1,addPath:(...h)=>{console.log("Lost translate:",...h)}},react:{hashTransKey(h){return`k${(0,i.kn)(h).toString(16)}`}}});const C=(h,T,E)=>{try{const m=`k${(0,i.kn)(h).toString(16)}`;let g=o.ZP.t(m,T,E);return g===m&&(g=h,console.info(`[i18n] \u7FFB\u8BD1\u7F3A\u5931: [${m}]${h}`)),g}catch(m){return console.error(m),h}};function Q(h){var T,E;const m=o.ZP.language;return(E=(T=h[m])!=null?T:h["zh-CN"])!=null?E:h["en-US"]}function z(h){return L(this,null,function*(){return new Promise((T,E)=>{o.ZP.changeLanguage(h,m=>{m?E(m):T()})})})}function j(){return o.ZP.language}function S(h){o.ZP.on("loaded",h)}function P(h){o.ZP.on("languageChanged",h)}function x(){const{t:h,ready:T}=(0,a.$)(),[E,m]=(0,p.useState)(()=>C);return(0,p.useEffect)(()=>{m(()=>(...g)=>C(...g))},[h]),{t:E,ready:T}}},74105:(U,O,e)=>{"use strict";e.d(O,{X9:()=>L,ZK:()=>z,lB:()=>S});var o=e(52983),c=e(14698),a=e.n(c),i=e(19692),N=e(54284),p=e(81281),A=(P,x,h)=>new Promise((T,E)=>{var m=R=>{try{K(h.next(R))}catch(Y){E(Y)}},g=R=>{try{K(h.throw(R))}catch(Y){E(Y)}},K=R=>R.done?T(R.value):Promise.resolve(R.value).then(m,g);K((h=h.apply(P,x)).next())});const L="en-US";function C(){return navigator.language?navigator.language.startsWith("zh")?"zh-CN":"en-US":L}function Q(){return A(this,null,function*(){return yield(0,N.cF)().get(p.Px,C())})}function z(){const[P,{save:x}]=(0,N.y$)(p.Px,L),h=(0,o.useRef)(),T=(0,o.useCallback)(m=>A(this,null,function*(){a()(h.current)&&(h.current=P),x(m),yield(0,i.m0)(m)}),[P,x]),E=(0,o.useMemo)(()=>a()(h.current)?!1:h.current!==P,[P]);return{language:P,setLanguage:T,isChanged:E}}function j(P){return A(this,null,function*(){yield(0,N.cF)().save(p.Px,P)})}const S={type:"languageDetector",async:!0,init:()=>{},detect:P=>A(void 0,null,function*(){try{const x=yield Q();P(x)}catch(x){P(L)}}),cacheUserLanguage(P){try{j(P)}catch(x){}}}},30831:(U,O,e)=>{"use strict";e.d(O,{lin:()=>Rs,gvw:()=>Yt,$Ib:()=>Dn,QEo:()=>Ze,AKk:()=>Et,f4G:()=>An,Xpe:()=>Be.GroupPanelType,NtG:()=>Ee,g3S:()=>Ce,m$Z:()=>yr.zt,q6$:()=>er.q6,IE7:()=>ae,cCv:()=>at,NDn:()=>Tr,vAN:()=>jr,rUo:()=>kt,m8p:()=>ce.m8,FcZ:()=>Bs,GM2:()=>Be.applyGroupInvite,x9K:()=>ze,Ntz:()=>K.Nt,_CB:()=>K._C,D3K:()=>K.D3,Kdd:()=>j,J3N:()=>Lr,ONy:()=>Me,YXr:()=>B.checkTokenValid,xuY:()=>B.claimTemporaryUser,L1i:()=>ce.L1,sSU:()=>Be.createGroup,fiB:()=>Be.createGroupInviteCode,XAi:()=>Be.createGroupPanel,Tzh:()=>xe,DW_:()=>B.createTemporaryUser,fA3:()=>Xr,u39:()=>zs,L4o:()=>Be.deleteGroupInvite,J9q:()=>Be.deleteGroupPanel,$Zg:()=>Vt,K_u:()=>Sr,Y4U:()=>kn,DtN:()=>Go,o9n:()=>B.forgetPassword,KJm:()=>Zr,vMv:()=>Jr,TcU:()=>Be.getAllGroupInviteCode,D6C:()=>ve.D6,r5V:()=>ve.r5,ct2:()=>ve.ct,Mlq:()=>ve.Ml,pGV:()=>ve.pG,U$y:()=>ve.U$,S8F:()=>gt.S8,Q$5:()=>Hr,HiA:()=>Cr,doy:()=>Be.getGroupBasicInfo,r3q:()=>Be.getGroupConfigWithInfo,G33:()=>g.G3,pZA:()=>tr,vIP:()=>Is,qQ$:()=>x.qQ,cF2:()=>_e.cF,hyC:()=>yt,TGs:()=>xs,jUY:()=>h,yGS:()=>E,VxZ:()=>Us,YQu:()=>b.YQ,Mo8:()=>Ns,YtP:()=>g.Yt,fZz:()=>B.loginWithEmail,ouS:()=>B.loginWithToken,o4J:()=>i,uRW:()=>Be.modifyGroupField,d89:()=>Be.modifyGroupPanel,jOv:()=>B.modifyUserField,MjZ:()=>B.modifyUserPassword,t4N:()=>g.t4,Awg:()=>Gs.A,XV6:()=>Be.quitGroup,peM:()=>wt,csP:()=>qn.cs,Kr1:()=>Lo,YiW:()=>B.registerWithEmail,tJD:()=>zr,WOV:()=>Xt,WY0:()=>S.W,c0U:()=>B.resetPassword,eGN:()=>B.searchUserWithUniqueName,bG5:()=>mt,brB:()=>re,J7p:()=>qn.J7,I5R:()=>je,YAW:()=>x.YA,poP:()=>_e.po,lx9:()=>Y,OvJ:()=>qn.Ov,cUn:()=>Es,Agn:()=>te.A,Nvc:()=>Ls,wp$:()=>X,hJM:()=>F,omK:()=>Ss,jiy:()=>J,lHp:()=>R,t:()=>g.t,AwB:()=>gn,cTq:()=>bs,cGl:()=>nt,TL5:()=>ye.TL,CGy:()=>ye.CG,r53:()=>st,ilX:()=>it,IxN:()=>Eo,CoE:()=>Xn,pHK:()=>to,aoI:()=>G,xzJ:()=>$,xMc:()=>Bt,tv4:()=>Rt,hoD:()=>ko,FNv:()=>Hn,Wfz:()=>Zo,Y84:()=>_o,zX9:()=>vr,TQq:()=>qo.T,tR0:()=>In,PlN:()=>us,iFL:()=>Tt,rE2:()=>Vn,aaJ:()=>Rr,Tgq:()=>ns,mWi:()=>ls,wY6:()=>rs,Ew8:()=>Br,EP:()=>ss,WHr:()=>Ms,VM1:()=>gs,eT7:()=>Qr,Yzt:()=>ho,GLd:()=>os,ZKp:()=>$n.ZK,nWw:()=>Ye,GCv:()=>lo,j$3:()=>Io,RxY:()=>No,coD:()=>Po,JtK:()=>te.J,cvI:()=>Mr,y$C:()=>_e.y$,$G7:()=>g.$G,wuX:()=>Fr,ysv:()=>tt.y,IIz:()=>Nn,Pc$:()=>Ur,FDf:()=>_n,OqL:()=>gr,Flu:()=>fr,R8f:()=>co,qoQ:()=>Oo,hIH:()=>qe,i83:()=>m});var o={};e.r(o),e.d(o,{addReaction:()=>kt,deleteMessage:()=>Vt,fetchConverseLastMessages:()=>$t,fetchConverseMessage:()=>Dt,fetchNearbyMessage:()=>Ln,recallMessage:()=>wt,removeReaction:()=>Xt,sendMessage:()=>mt});var c={};e.r(c),e.d(c,{acceptFriendRequest:()=>Tr,addFriendRequest:()=>jr,cancelFriendRequest:()=>Lr,denyFriendRequest:()=>Sr,removeFriend:()=>zr,setFriendNickname:()=>Yo});var a={};e.r(a),e.d(a,{clearInbox:()=>Jo,setInboxAck:()=>Ko});var i={};e.r(i),e.d(i,{Qr:()=>ce,r9:()=>c,ru:()=>Be,Ty:()=>a,yw:()=>o,EA:()=>B});var N=e(96319),p=e(39765),A=e(14698),L=e.n(A),C=e(86474),Q=e.n(C),z=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});function j(n){const t=new p.ZP({size:1e3,storageBackend:n,defaultExpires:1e3*3600*24,enableCache:!0});return{set:(s,l)=>z(this,null,function*(){try{!!s&&typeof s=="string"&&!Q()(l)&&(yield t.save({key:s,data:l}))}catch(v){console.error(v)}return l}),setWithExpires:(s,l,v)=>z(this,null,function*(){try{!!s&&typeof s=="string"&&!Q()(l)&&(yield t.save({key:s,data:l,expires:v}))}catch(I){console.error(I)}return l}),get:(s,l)=>z(this,null,function*(){let v;try{v=yield t.load({key:s,autoSync:!0,syncInBackground:!1})}catch(I){I instanceof p.dR||console.log(`get key ${s} error:`,String(I)),v=L()(l)?null:l}return v}),remove:s=>z(this,null,function*(){yield t.remove({key:s})}),save:(s,l)=>z(this,null,function*(){try{!!s&&typeof s=="string"&&!Q()(l)&&(yield t.save({key:s,data:l,expires:null}))}catch(v){console.error(v)}return l})}}var S=e(72163),P=e(78989),x=e(49076);const h=typeof window!="undefined",T=typeof navigator!="undefined",E=!1,m="nightly-202308281953";var g=e(19692),K=e(11318);const[R,Y]=(0,K.Nt)("toasts");function F(n){let t="";n instanceof Error?t=n.message:t=String(n),R(t,"error")}function J(n=(0,g.t)("\u64CD\u4F5C\u6210\u529F")){R(n,"success")}const[X,re]=(0,K.Nt)("alert"),[Ie,je]=(0,K.Nt)("global-loading",()=>()=>{});var te=e(99852),De=e(80527),Ae=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});class Le extends Error{constructor(){super(...arguments);this.name="SocketEventError"}}class Je{constructor(t){this.socket=t,this.listener=[],this.closeFn=null,t.onAny((r,s)=>{const l=this.listener.filter(([v])=>v===r);if(l.length===0){console.warn(`[Socket IO] Unhandler event: ${r}`,s);return}l.forEach(([,v])=>{v(s)})})}get connected(){return this.socket.connected}request(t){return Ae(this,arguments,function*(r,s={}){return new Promise((l,v)=>{this.socket.emit(r,s,I=>{I.result===!0?l(I.data):I.result===!1&&v(new Le(`[${r}]: ${I.message}: 
data: ${JSON.stringify(s)}`))})})})}listen(t,r){this.listener.push([`notify:${t}`,r])}removeListener(t,r){const s=this.listener.findIndex(l=>l[0]===`notify:${t}`&&l[1]===r);s>=0&&this.listener.splice(s,1)}mockReconnect(){this.socket.disconnect(),R("reconnect after 5s"),setTimeout(()=>{this.socket.io.skipReconnect=!1,this.socket.io.reconnect()},5*1e3)}onReconnect(t){this.socket.io.on("reconnect",t)}disconnect(){this.socket.disconnect()}setupSocketStatusTip(){const t=this.socket,r=()=>{this.closeFn||(this.closeFn=Ie((0,g.t)("\u6B63\u5728\u91CD\u65B0\u94FE\u63A5")))},s=()=>{this.closeFn&&typeof this.closeFn=="function"&&(this.closeFn(),this.closeFn=null)};t.on("connect",()=>{console.log("\u8FDE\u63A5\u6210\u529F"),s(),te.A.emit("updateNetworkStatus","connected")}),t.on("connecting",l=>{console.log("\u6B63\u5728\u8FDE\u63A5"),r(),te.A.emit("updateNetworkStatus","reconnecting")}),t.on("disconnect",l=>{console.log("\u4E0E\u670D\u52A1\u5668\u7684\u94FE\u63A5\u5DF2\u65AD\u5F00"),F((0,g.t)("\u4E0E\u670D\u52A1\u5668\u7684\u94FE\u63A5\u5DF2\u65AD\u5F00")),s(),te.A.emit("updateNetworkStatus","disconnected")}),t.on("connect_error",l=>{console.log("\u8FDE\u63A5\u5931\u8D25"),F((0,g.t)("\u8FDE\u63A5\u5931\u8D25")),s(),te.A.emit("updateNetworkStatus","disconnected")}),t.io.on("reconnect",l=>{console.log("\u91CD\u8FDE\u6210\u529F"),s(),te.A.emit("updateNetworkStatus","connected")}),t.io.on("reconnect_attempt",l=>{console.log("\u91CD\u8FDE\u4E2D..."),r(),te.A.emit("updateNetworkStatus","reconnecting")}),t.io.on("reconnect_error",l=>{console.error("\u91CD\u8FDE\u5C1D\u8BD5\u5931\u8D25...",l),r(),te.A.emit("updateNetworkStatus","reconnecting")}),t.io.on("reconnect_failed",()=>{console.error("\u91CD\u8FDE\u5931\u8D25..."),r(),te.A.emit("updateNetworkStatus","disconnected")}),t.io.on("error",l=>{console.error("\u7F51\u7EDC\u51FA\u73B0\u5F02\u5E38",l),F((0,g.t)("\u7F51\u7EDC\u51FA\u73B0\u5F02\u5E38")),s(),te.A.emit("updateNetworkStatus","disconnected")})}}let Pe;function xe(n){return L()(Pe)||Pe.close(),new Promise((t,r)=>{Pe=(0,P.io)((0,x.qQ)(),{transports:["websocket"],auth:{token:n},forceNew:!0,parser:De}),Pe.once("connect",()=>{const s=new Je(Pe);s.setupSocketStatusTip(),t(s)}),Pe.once("error",()=>{r()}),E&&Pe.onAny((...s)=>{console.debug("Receive Notify:",s)})})}var ve=e(62789),Oe=e(98258),we=e(43697),B=e(77100),b=e(518);function $(n,t=!1){const{data:r}=(0,Oe.a)(["user",n],()=>(0,b.YQ)(n)?(0,B.fetchUserInfo)(n):{},{staleTime:2*60*60*1e3,refetchOnMount:t?"always":!0});return r??{}}function G(n,t){const r=20*1e3,{data:s,isSuccess:l}=(0,Oe.a)(["onlineStatus",n.join(",")],()=>(0,B.getUserOnlineStatus)(n),{staleTime:r});return l&&Array.isArray(s)&&typeof t=="function"&&s&&t(s),s??n.map(()=>!1)}var M=e(52983),W=Object.defineProperty,H=Object.defineProperties,V=Object.getOwnPropertyDescriptors,ee=Object.getOwnPropertySymbols,ue=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable,fe=(n,t,r)=>t in n?W(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,k=(n,t)=>{for(var r in t||(t={}))ue.call(t,r)&&fe(n,r,t[r]);if(ee)for(var r of ee(t))de.call(t,r)&&fe(n,r,t[r]);return n},le=(n,t)=>H(n,V(t));class ie extends M.PureComponent{constructor(){super(...arguments);this.state={portals:[]},this.mount=(t,r)=>{this.setState(s=>({portals:[...s.portals,{key:t,children:r}]}))},this.update=(t,r)=>{this.setState(s=>({portals:s.portals.map(l=>l.key===t?le(k({},l),{children:r}):l)}))},this.unmount=t=>{this.setState(r=>({portals:r.portals.filter(s=>s.key!==t)}))}}render(){const{renderManagerView:t}=this.props;return this.state.portals.map(({key:r,children:s},l)=>M.createElement(M.Fragment,{key:r},t(s)))}}function Re(n){const t=M.createContext(null);return t.displayName="PortalContext-"+n,t}class Qe extends M.Component{componentDidMount(){if(!this.props.manager)throw new Error("Looks like you forgot to wrap your root component with `PortalHost` component.\n");this._key=this.props.manager.mount(this.props.hostName,this.props.children)}componentDidUpdate(){this.props.manager.update(this.props.hostName,this._key,this.props.children)}componentWillUnmount(){this.props.manager.unmount(this.props.hostName,this._key)}render(){return null}}class Ze{constructor(){this.listeners={}}emit(t,...r){if(!(t in this.listeners))return;const s=this.listeners[t];for(let l=0,v=s.length;l<v;l++){s[l].call(this,event);const I=s[l];typeof I=="function"&&I(...r)}}addListener(t,r){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(r)}removeListener(t,r){if(!(t in this.listeners))return;const s=this.listeners[t];for(let l=0,v=s.length;l<v;l++)if(s[l]===r)return s.splice(l,1),this.removeListener(t,r)}}const Te="ADD_PORTAL",Se="REMOVE_PORTAL",ge=n=>M.createElement(M.Fragment,null,n);function ze(n){const{hostName:t="default",eventEmitter:r=new Ze,renderManagerView:s=ge}=n;let l=1e4;const v=he=>{const se=l++;return r.emit(Te,t,he,se),se},I=he=>{r.emit(Se,t,he)},D=Re(t),f=M.memo(he=>{const se=(0,M.useRef)(),ut=(0,M.useRef)(0),Xe=(0,M.useRef)([]),St=(0,M.useRef)(t);(0,M.useEffect)(()=>{St.current=t},[t]);const Lt=(0,M.useCallback)((Fe,Ke,Ve)=>{if(Fe!==St.current)return;const zt=Ve||ut.current++;return se.current?se.current.mount(zt,Ke):Xe.current.push({type:"mount",key:zt,children:Ke}),zt},[]),nr=(0,M.useCallback)((Fe,Ke,Ve)=>{if(Fe===St.current)if(se.current)se.current.update(Ke,Ve);else{const zt={type:"mount",key:Ke,children:Ve},Vr=Xe.current.findIndex(rr=>rr.type==="mount"||rr.type==="update"&&rr.key===Ke);Vr>-1?Xe.current[Vr]=zt:Xe.current.push(zt)}},[]),Ue=(0,M.useCallback)((Fe,Ke)=>{Fe===St.current&&(se.current?se.current.unmount(Ke):Xe.current.push({type:"unmount",key:Ke}))},[]);return(0,M.useEffect)(()=>(r.addListener(Te,Lt),r.addListener(Se,Ue),()=>{r.removeListener(Te,Lt),r.removeListener(Se,Ue)}),[Lt,Ue]),(0,M.useEffect)(()=>{const Fe=Xe.current,Ke=se.current;for(;Fe.length&&Ke;){const Ve=Fe.pop();if(!!Ve)switch(Ve.type){case"mount":Ke.mount(Ve.key,Ve.children);break;case"update":Ke.update(Ve.key,Ve.children);break;case"unmount":Ke.unmount(Ve.key);break}}},[]),M.createElement(D.Provider,{value:{mount:Lt,update:nr,unmount:Ue}},M.createElement(M.Fragment,null,he.children),M.createElement(ie,{ref:se,renderManagerView:s}))});f.displayName="PortalHost-"+t;const w=M.memo(he=>{const se=(0,M.useContext)(D);return L()(se)?(console.error("Not find PortalContext"),null):M.createElement(Qe,{hostName:t,manager:se},he.children)});return w.displayName="PortalRender-"+t,{add:v,remove:I,PortalHost:f,PortalRender:w}}var _e=e(54284);const xt="alphaMode";function nt(){const[n,{save:t}]=(0,_e.y$)(xt,!1);return{isAlphaMode:n,setAlphaMode:t}}const Ut=M.memo(n=>{const{isAlphaMode:t}=nt();return t?M.createElement(M.Fragment,null,n.children):null});Ut.displayName="AlphaContainer";const Et=M.memo(n=>E?M.createElement(M.Fragment,null,n.children):null);Et.displayName="DevContainer";var ft=e(31672),ht=e(21974);const rt=M.memo(n=>M.createElement(ht.S,{client:ft.E,persistOptions:{persister:ft.L}},n.children));rt.displayName="CacheProvider";function Ft(n){if(n==="dark")return{isDarkMode:!0,extraSchemeName:null};if(n==="light")return{isDarkMode:!1,extraSchemeName:null};if(n==="auto")return{isDarkMode:window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)").matches:!0,extraSchemeName:null};{let[t,r]=n.split("+");return(0,b.YQ)(r)||(r=t,t="dark"),{isDarkMode:t==="dark",extraSchemeName:`theme-${r}`}}}const ot=M.createContext({colorScheme:"dark",setColorScheme:()=>{}});ot.displayName="ColorSchemeContext";const Mt=M.memo(n=>{const[t="dark",{save:r}]=(0,_e.y$)("colorScheme","dark");return(0,M.useEffect)(()=>{te.A.emit("loadColorScheme",t)},[t]),M.createElement(ot.Provider,{value:{colorScheme:t,setColorScheme:r}},n.children)});Mt.displayName="ColorSchemeContextProvider";function Rt(){const{colorScheme:n,setColorScheme:t}=(0,M.useContext)(ot),{isDarkMode:r,extraSchemeName:s}=Ft(n);return{colorScheme:n,setColorScheme:t,isDarkMode:r,extraSchemeName:s}}const ae=M.memo(n=>M.createElement(rt,null,M.createElement(Mt,null,n.children)));ae.displayName="TcProvider";var pe=e(71607),Ne=e.n(pe);const lt=M.createContext({replyMsg:null,setReplyMsg:Ne()});lt.displayName="ChatBoxContext";const Yt=M.memo(n=>{const[t,r]=(0,M.useState)(null);return M.createElement(lt.Provider,{value:{replyMsg:t,setReplyMsg:r}},n.children)});Yt.displayName="ChatBoxContextProvider";function Bt(){const n=(0,M.useContext)(lt),t=(0,M.useCallback)(()=>{n.setReplyMsg(null)},[n.setReplyMsg]);return{hasContext:n.setReplyMsg!==Ne(),replyMsg:n.replyMsg,setReplyMsg:n.setReplyMsg,clearReplyMsg:t}}var gt=e(96228);function Pn(){const n=(0,M.useRef)(!1),t=(0,M.useCallback)(()=>n.current,[]);return(0,M.useEffect)(()=>(n.current=!0,()=>{n.current=!1}),[]),t}var On=Object.defineProperty,Cn=Object.defineProperties,Kt=Object.getOwnPropertyDescriptors,Jt=Object.getOwnPropertySymbols,jn=Object.prototype.hasOwnProperty,Zt=Object.prototype.propertyIsEnumerable,Ht=(n,t,r)=>t in n?On(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Tn=(n,t)=>{for(var r in t||(t={}))jn.call(t,r)&&Ht(n,r,t[r]);if(Jt)for(var r of Jt(t))Zt.call(t,r)&&Ht(n,r,t[r]);return n},Sn=(n,t)=>Cn(n,Kt(t));function it(n,t=[],r={loading:!1}){const s=(0,M.useRef)(0),l=Pn(),[v,I]=(0,M.useState)(r),D=(0,M.useCallback)((...f)=>{const w=++s.current;return I(he=>Sn(Tn({},he),{loading:!0})),n(...f).then(he=>(l()&&w===s.current&&I({value:he,loading:!1}),he),he=>(l()&&w===s.current&&I({error:he,loading:!1}),he))},t);return[v,D]}function st(n,t=[]){const[r,s]=it(n,t,{loading:!0});return(0,M.useEffect)(()=>{s()},[s]),r}var $e=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});function Dt(n,t){return $e(this,null,function*(){const{data:r}=yield S.W.get("/api/chat/message/fetchConverseMessage",{params:{converseId:n,startId:t}});return r})}function mt(n){return $e(this,null,function*(){const{data:t}=yield S.W.post("/api/chat/message/sendMessage",n);return t})}function wt(n){return $e(this,null,function*(){const{data:t}=yield S.W.post("/api/chat/message/recallMessage",{messageId:n});return t})}function Vt(n){return $e(this,null,function*(){const{data:t}=yield S.W.post("/api/chat/message/deleteMessage",{messageId:n});return t})}function $t(n){return $e(this,null,function*(){const{data:t}=yield S.W.post("/api/chat/message/fetchConverseLastMessages",{converseIds:n});return t})}function Ln(n){return $e(this,null,function*(){const{data:t}=yield S.W.post("/api/chat/message/fetchNearbyMessage",n);return t})}function kt(n,t){return $e(this,null,function*(){const{data:r}=yield S.W.post("/api/chat/message/addReaction",{messageId:n,emoji:t});return r})}function Xt(n,t){return $e(this,null,function*(){const{data:r}=yield S.W.post("/api/chat/message/removeReaction",{messageId:n,emoji:t});return r})}var _t=e(2031),ct=e(47393),zn=e(26226),At=e.n(zn);const qt={info:null,friends:[],friendRequests:[]},Qt=(0,ct.oM)({name:"user",initialState:qt,reducers:{setUserInfo(n,t){n.info=t.payload},setUserInfoField(n,t){const{fieldName:r,fieldValue:s}=t.payload;n.info!==null&&At()(n.info,[r],s)},setUserInfoExtra(n,t){const{fieldName:r,fieldValue:s}=t.payload;n.info!==null&&At()(n.info,["extra",r],s)},setFriendList(n,t){n.friends=t.payload},setFriendRequests(n,t){n.friendRequests=t.payload},appendFriend(n,t){n.friends.some(r=>r===t.payload)||n.friends.push(t.payload)},removeFriend(n,t){const r=t.payload,s=n.friends.findIndex(l=>l.id===r);s>=0&&n.friends.splice(s,1)},appendFriendRequest(n,t){n.friendRequests.some(({_id:r})=>r===t.payload._id)||n.friendRequests.push(t.payload)},removeFriendRequest(n,t){const r=n.friendRequests.findIndex(({_id:s})=>s===t.payload);r>=0&&n.friendRequests.splice(r,1)},setFriendNickname(n,t){const{friendId:r,nickname:s}=t.payload,l=n.friends.find(v=>v.id===r);l&&(l.nickname=s)}}}),qe=Qt.actions,en=Qt.reducer;var xn=e(3010),tn=e.n(xn),nn=e(40916),rn=e.n(nn),Un=e(77875),on=e.n(Un),It=Object.defineProperty,sn=Object.getOwnPropertySymbols,Fn=Object.prototype.hasOwnProperty,Rn=Object.prototype.propertyIsEnumerable,an=(n,t,r)=>t in n?It(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,pt=(n,t)=>{for(var r in t||(t={}))Fn.call(t,r)&&an(n,r,t[r]);if(sn)for(var r of sn(t))Rn.call(t,r)&&an(n,r,t[r]);return n};const We={currentConverseId:null,converses:{},ack:{},inbox:[],lastMessageMap:{}},be=(0,ct.oM)({name:"chat",initialState:We,reducers:{updateCurrentConverseId(n,t){n.currentConverseId=t.payload},setConverseInfo(n,t){const r=t.payload._id,s=n.converses[r]?pt({},n.converses[r]):{messages:[],hasFetchedHistory:!1,hasMoreMessage:!0};n.converses[r]=pt(pt({},s),t.payload)},appendConverseMessage(n,t){var r;const{converseId:s,messages:l}=t.payload;if(!n.converses[s]){console.error("\u6CA1\u6709\u4F1A\u8BDD\u4FE1\u606F, \u8BF7\u5148\u8BBE\u7F6E\u4F1A\u8BDD\u4FE1\u606F");return}const v=rn()(tn()([...n.converses[s].messages,...l],"_id"),"_id","asc");if(n.converses[s].messages=v,n.currentConverseId!==s){const I=(r=on()(v.filter(D=>!(0,b.AJ)(D._id))))==null?void 0:r._id;(0,b.YQ)(I)&&(n.lastMessageMap[s]=I)}},appendLocalMessage(n,t){const{author:r,localMessageId:s,payload:l}=t.payload,{converseId:v,groupId:I,content:D,meta:f}=l;if(!n.converses[v]){console.error("\u6CA1\u6709\u4F1A\u8BDD\u4FE1\u606F, \u8BF7\u5148\u8BBE\u7F6E\u4F1A\u8BDD\u4FE1\u606F");return}const w={_id:s,author:r,groupId:I,converseId:v,content:D,meta:f,isLocal:!0},he=rn()(tn()([...n.converses[v].messages,w],"_id"),"_id","asc");n.converses[v].messages=he},initialHistoryMessage(n,t){const{converseId:r,historyMessages:s}=t.payload;if(!n.converses[r]){console.error("\u6CA1\u6709\u4F1A\u8BDD\u4FE1\u606F, \u8BF7\u5148\u8BBE\u7F6E\u4F1A\u8BDD\u4FE1\u606F");return}be.caseReducers.appendConverseMessage(n,be.actions.appendConverseMessage({converseId:r,messages:[...s]})),s.length<50&&(n.converses[r].hasMoreMessage=!1),n.converses[r].hasFetchedHistory=!0},appendHistoryMessage(n,t){const{converseId:r,historyMessages:s}=t.payload;if(!n.converses[r]){console.error("\u6CA1\u6709\u4F1A\u8BDD\u4FE1\u606F, \u8BF7\u5148\u8BBE\u7F6E\u4F1A\u8BDD\u4FE1\u606F");return}be.caseReducers.appendConverseMessage(n,be.actions.appendConverseMessage({converseId:r,messages:[...s]})),s.length<50&&(n.converses[r].hasMoreMessage=!1),n.converses[r].hasFetchedHistory=!0},clearAllConverses(n){n.converses={}},setConverseAck(n,t){const{converseId:r,lastMessageId:s}=t.payload;n.ack[r]=s},updateMessageInfo(n,t){var r;const{message:s}=t.payload,l=(r=t.payload.messageId)!=null?r:s._id,v=s.converseId;if(!v){console.warn("Not found converse id,",s);return}const I=n.converses[v];if(!I){console.warn("Not found converse,",v);return}const D=I.messages.findIndex(f=>f._id===l);D>=0&&(I.messages[D]=pt(pt({},I.messages[D]),s))},deleteMessageById(n,t){const{converseId:r,messageId:s}=t.payload,l=n.converses[r];if(!l){console.warn("Not found converse,",r);return}const v=l.messages.findIndex(I=>I._id===s);v>=0&&l.messages.splice(v,1)},setLastMessageMap(n,t){const r=t.payload;Array.isArray(r)&&r.forEach(s=>{n.lastMessageMap[s.converseId]=s.lastMessageId})},appendMessageReaction(n,t){const{converseId:r,messageId:s,reaction:l}=t.payload,v=n.converses[r];if(!v){console.warn("Not found converse,",r);return}const I=v.messages.find(D=>D._id===s);if(!I){console.warn("Not found message,",s);return}Array.isArray(I.reactions)||(I.reactions=[]),I.reactions.push(l)},removeMessageReaction(n,t){const{converseId:r,messageId:s,reaction:l}=t.payload,v=n.converses[r];if(!v){console.warn("Not found converse,",r);return}const I=v.messages.find(f=>f._id===s);if(!I){console.warn("Not found message,",s);return}Array.isArray(I.reactions)||(I.reactions=[]);const D=I.reactions.findIndex(f=>f.name===l.name&&f.author===l.author);I.reactions.splice(D,1)},setInboxList(n,t){const r=t.payload;n.inbox=r},appendInboxItem(n,t){n.inbox.push(t.payload)},setInboxItemAck(n,t){const r=t.payload,s=n.inbox.find(l=>l._id===r);s&&(s.readed=!0)}}}),Me=be.actions,Wt=be.reducer;var Nt=Object.defineProperty,un=Object.defineProperties,ln=Object.getOwnPropertyDescriptors,bt=Object.getOwnPropertySymbols,cn=Object.prototype.hasOwnProperty,Bn=Object.prototype.propertyIsEnumerable,dn=(n,t,r)=>t in n?Nt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,et=(n,t)=>{for(var r in t||(t={}))cn.call(t,r)&&dn(n,r,t[r]);if(bt)for(var r of bt(t))Bn.call(t,r)&&dn(n,r,t[r]);return n},vt=(n,t)=>un(n,ln(t));const wn={groups:{}},Gt=(0,ct.oM)({name:"group",initialState:wn,reducers:{appendGroups(n,t){const r=t.payload;for(const s of r)n.groups[s._id]=et(et({},n.groups[s._id]),s)},updateGroup(n,t){const r=t.payload,s=r._id;n.groups[s]&&(n.groups[s]=et(et({},n.groups[s]),r))},removeGroup(n,t){const r=t.payload;delete n.groups[r]},pinGroupPanel(n,t){const{groupId:r,panelId:s}=t.payload;n.groups[r]&&(n.groups[r]=vt(et({},n.groups[r]),{pinnedPanelId:s}))},unpinGroupPanel(n,t){const{groupId:r}=t.payload;n.groups[r]&&(n.groups[r]=vt(et({},n.groups[r]),{pinnedPanelId:void 0}))},updateGroupConfig(n,t){var r;const{groupId:s,configName:l,configValue:v}=t.payload,I=n.groups[s];I&&(n.groups[s]=vt(et({},I),{config:vt(et({},(r=I.config)!=null?r:{}),{[l]:v})}))}}}),yt=Gt.actions,fn=Gt.reducer,Qn={panelWinUrls:[]},Mn=(0,ct.oM)({name:"ui",initialState:Qn,reducers:{addPanelWindowUrl(n,t){const r=t.payload.url;n.panelWinUrls.push(r)},deletePanelWindowUrl(n,t){const r=t.payload.url,s=n.panelWinUrls.indexOf(r);n.panelWinUrls.splice(s,1)}}}),gn=Mn.actions,Wn=Mn.reducer,mn={networkStatus:"initial",reconnectNum:0},pn=(0,ct.oM)({name:"global",initialState:mn,reducers:{setNetworkStatus(n,t){n.networkStatus=t.payload},incReconnectNum(n){n.reconnectNum+=1}}}),Pt=pn.actions,bn=pn.reducer,Gn=(0,_t.UY)({global:bn,user:en,chat:Wt,group:fn,ui:Wn});var ye=e(84966),vn=e(13546),dt=e.n(vn),Yn=e(61422),yn=e.n(Yn),En=e(49335),u=e.n(En),d=Object.defineProperty,y=Object.getOwnPropertySymbols,Z=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable,ne=(n,t,r)=>t in n?d(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,q=(n,t)=>{for(var r in t||(t={}))Z.call(t,r)&&ne(n,r,t[r]);if(y)for(var r of y(t))oe.call(t,r)&&ne(n,r,t[r]);return n};const me=["_id","content","author"];class Ee{constructor(t){this.payload=q({},t)}hasReply(){const t=dt()(this.payload,["meta","reply"]);return L()(t)?!1:t}setReplyMsg(t){L()(t)||At()(this.payload,["meta","reply"],u()(t,me))}generatePayload(){return q({},this.payload)}}var ce=e(22149),tt=e(40160),ke=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});const Ot=()=>yn()("localMessage_");function hn(){const n=(0,ye.CG)(D=>{var f;return(f=D.user.info)==null?void 0:f._id}),t=(0,ye.TL)(),{hasContext:r,replyMsg:s,clearReplyMsg:l}=Bt(),v=(0,tt.y)(s);return vr(D=>{if(D.content===""){F((0,g.t)("\u65E0\u6CD5\u53D1\u9001\u7A7A\u6D88\u606F"));return}if(r===!0){const w=new Ee(D);L()(v.current)||(w.setReplyMsg(v.current),l()),D=w.generatePayload()}const f=Ot();t(Me.appendLocalMessage({author:n,localMessageId:f,payload:D})),mt(D).then(w=>{t(Me.deleteMessageById({converseId:D.converseId,messageId:f})),t(Me.appendConverseMessage({converseId:D.converseId,messages:[w]})),te.A.emit("sendMessage",D)}).catch(w=>{F(w),t(Me.updateMessageInfo({messageId:f,message:{sendFailed:!0}}))})})}function Kn(n){var t,r;const{converseId:s,isGroup:l}=n,v=(0,ye.CG)(Ue=>Ue.chat.converses[s]),I=(0,ye.CG)(Ue=>Ue.global.reconnectNum),D=(t=v==null?void 0:v.hasMoreMessage)!=null?t:!0,f=(0,ye.TL)(),w=(r=v==null?void 0:v.messages)!=null?r:[],he=(0,ye.CG)(Ue=>{var Fe;return(Fe=Ue.user.info)==null?void 0:Fe._id});(0,M.useEffect)(()=>(f(Me.updateCurrentConverseId(s)),()=>{f(Me.updateCurrentConverseId(null))}),[s]);const{loading:se,error:ut}=st(()=>ke(this,null,function*(){if(!!he)if(v){if(!v.hasFetchedHistory){const Ue=L()(v.messages[0])?void 0:v.messages[0]._id,Fe=yield Dt(s,Ue);f(Me.initialHistoryMessage({converseId:s,historyMessages:Fe}))}}else{if(l)f(Me.setConverseInfo({_id:s,name:"",type:ce.tv.Group,members:[]}));else{const Fe=yield(0,gt.tx)(s,he);f(Me.setConverseInfo(Fe))}const Ue=yield Dt(s);f(Me.initialHistoryMessage({converseId:s,historyMessages:Ue}))}}),[s,I,he]),[{loading:Xe},St]=Xn(()=>ke(this,null,function*(){const Ue=dt()(w,[0,"_id"]);if(!(0,b.YQ)(Ue)||D===!1)return;const Fe=yield Dt(s,Ue);f(Me.appendHistoryMessage({converseId:s,historyMessages:Fe}))}),[s,D,dt()(w,[0,"_id"])]),Lt=Ye(()=>ke(this,null,function*(){Xe||(yield St())})),nr=hn();return{messages:w,loading:se,error:ut,isLoadingMore:Xe,hasMoreMessage:D,handleFetchMoreMessage:Lt,handleSendMessage:nr}}function Jn(n){const t=M.createContext(n.defaultValue);t.displayName=n.displayName;function r(){return M.useContext(t)}return{Context:t,useContext:r}}const{Context:Zn,useContext:Hn}=Jn({defaultValue:{},displayName:"ConverseMessageContext"}),Dn=M.memo(n=>{const{converseId:t,isGroup:r}=n,{messages:s,loading:l,error:v,isLoadingMore:I,hasMoreMessage:D,handleFetchMoreMessage:f,handleSendMessage:w}=Kn({converseId:t,isGroup:r});return M.createElement(Zn.Provider,{value:{messages:s,loading:l,error:v,isLoadingMore:I,hasMoreMessage:D,fetchMoreMessage:f,sendMessage:w}},n.children)});Dn.displayName="ConverseMessageProvider";const Ct=M.createContext({groupInfo:null});Ct.displayName="GroupInfoContext";const An=M.memo(n=>M.createElement(Ct.Provider,{value:{groupInfo:n.groupInfo}},n.children));An.displayName="GroupInfoContextProvider";function Vn(){return(0,M.useContext)(Ct).groupInfo}var Ge=e(13432);const at=M.memo(n=>M.createElement(Ge.c,null,n.children));at.displayName="Trans";var $n=e(74105),$r=e(45563),ur=e.n($r);function Ye(n){const t=(0,M.useRef)(n);t.current=(0,M.useMemo)(()=>n,[n]);const r=(0,M.useRef)();return r.current||(r.current=function(...s){return t.current.apply(this,s)}),r.current}const kr=(n=>(t,r)=>{const s=(0,M.useRef)(!1);n(()=>()=>{s.current=!1},[]),n(()=>{if(!s.current)s.current=!0;else return t()},r)})(M.useEffect);function Xr(n){function t(r,s){let l;try{l=n()}catch(se){console.error(se)}const v=se=>(s==null?void 0:s.serializer)?s==null?void 0:s.serializer(se):JSON.stringify(se),I=se=>(s==null?void 0:s.deserializer)?s==null?void 0:s.deserializer(se):JSON.parse(se);function D(){try{const se=l==null?void 0:l.getItem(r);if(se)return I(se)}catch(se){console.error(se)}return ur()(s==null?void 0:s.defaultValue)?s==null?void 0:s.defaultValue():s==null?void 0:s.defaultValue}const[f,w]=(0,M.useState)(()=>D());return kr(()=>{w(D())},[r]),[f,Ye(se=>{const ut=ur()(se)?se(f):se;if(w(ut),Q()(ut))l==null||l.removeItem(r);else try{l==null||l.setItem(r,v(ut))}catch(Xe){console.error(Xe)}})]}return t}var _r=e(96393),qr=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});const kn=(0,_r.w)("fetchAvailableServices",()=>qr(void 0,null,function*(){const{data:n}=yield S.W.get("/api/gateway/health");return n.services}));var eo=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});function to(){const[{loading:n,value:t},r]=it(()=>kn());(0,M.useEffect)(()=>{r()},[]);const s=Ye(()=>eo(this,null,function*(){kn.clearCache(),r()}));return{loading:n,availableServices:t,refetch:s}}var no=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});function Xn(n,t=[]){const[{loading:r,value:s},l]=it((...v)=>no(this,null,function*(){try{return yield n(...v)}catch(I){F(I),console.error("[useAsyncRequest] error:",I)}}),t);return[{loading:r,value:s},l]}var ro=e(92238),oo=e.n(ro),so=Object.defineProperty,lr=Object.getOwnPropertySymbols,ao=Object.prototype.hasOwnProperty,uo=Object.prototype.propertyIsEnumerable,ir=(n,t,r)=>t in n?so(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,cr=(n,t)=>{for(var r in t||(t={}))ao.call(t,r)&&ir(n,r,t[r]);if(lr)for(var r of lr(t))uo.call(t,r)&&ir(n,r,t[r]);return n},dr=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});function fr(){const n=(0,we.NL)(),{data:t,isLoading:r}=(0,Oe.a)([ve.r7.userSettings],()=>(0,B.getUserSettings)(),{staleTime:10*60*1e3}),[{loading:s},l]=Xn(v=>dr(this,null,function*(){n.setQueryData([ve.r7.userSettings],()=>cr(cr({},t),v));const I=yield(0,B.setUserSettings)(v);n.setQueryData([ve.r7.userSettings],()=>I),te.A.emit("userSettingsUpdate",I)}),[n]);return{settings:t??{},setSettings:l,loading:r||s}}function Mr(n,t){var r;const{settings:s,setSettings:l,loading:v}=fr();return{value:(r=s[n])!=null?r:t,setValue:I=>dr(this,null,function*(){return l({[n]:I})}),loading:v}}function gr(){const{value:n=[],setValue:t}=Mr("messageNotificationMuteList",[]),r=Ye(I=>{t([...n,I])}),s=Ye(I=>{t(oo()(n,I))}),l=Ye(I=>{n.includes(I)?s(I):r(I)}),v=Ye((I,D)=>D?n.includes(I)||n.includes(D):n.includes(I));return{mutedList:n,mute:r,unmute:s,toggleMute:l,checkIsMuted:v}}function lo(){const{checkIsMuted:n}=gr();(0,te.J)("receiveMessage",t=>{!t||n(t.converseId,t.groupId)||te.A.emit("receiveUnmutedMessage",t)})}var io=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});function _n(n=[]){const{value:t=[]}=st(()=>io(this,null,function*(){return yield Promise.all(n.map(s=>(0,ve.pG)(s)))}),[n.join(",")]);return t}function co(n){return _n(n).map(r=>r.nickname)}var fo=Object.defineProperty,Mo=Object.defineProperties,go=Object.getOwnPropertyDescriptors,mr=Object.getOwnPropertySymbols,mo=Object.prototype.hasOwnProperty,po=Object.prototype.propertyIsEnumerable,pr=(n,t,r)=>t in n?fo(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,vo=(n,t)=>{for(var r in t||(t={}))mo.call(t,r)&&pr(n,r,t[r]);if(mr)for(var r of mr(t))po.call(t,r)&&pr(n,r,t[r]);return n},yo=(n,t)=>Mo(n,go(t));function Eo(n,t=[]){const[r,s]=it(n,t,{loading:!0});(0,M.useEffect)(()=>{s()},[s]);const l=(0,M.useCallback)(()=>s(),[s]);return yo(vo({},r),{refresh:l})}function Ks(n,t=0){const r=useRef(!1),s=useRef(),l=useRef(n),v=useCallback(()=>r.current,[]),I=useCallback(()=>{r.current=!1,s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{r.current=!0,l.current()},t)},[t]),D=useCallback(()=>{r.current=null,s.current&&clearTimeout(s.current)},[]);return useEffect(()=>{l.current=n},[n]),useEffect(()=>(I(),D),[t]),[v,D,I]}function Js(n,t=0,r=[]){const[s,l,v]=useTimeoutFn(n,t);return useEffect(v,r),[s,l]}const vr=Ye;function ho(n,t,r){const s=r==null?void 0:r.immediate,l=(0,tt.y)(n),v=(0,M.useRef)();return(0,M.useEffect)(()=>{if(!(typeof t!="number"||t<0))return s&&l.current(),v.current=window.setInterval(()=>{l.current()},t),()=>{v.current&&window.clearInterval(v.current)}},[t]),(0,M.useCallback)(()=>{v.current&&window.clearInterval(v.current)},[])}function Zs(n){const t=useRef();return useEffect(()=>{t.current=n}),t.current}const Do=n=>{(0,M.useEffect)(n,[])},Ao=n=>{const t=(0,M.useRef)(n);t.current=n,Do(()=>()=>t.current())},Io=n=>{const t=(0,M.useRef)(0),[r,s]=(0,M.useState)(n),l=(0,M.useCallback)(v=>{cancelAnimationFrame(t.current),t.current=requestAnimationFrame(()=>{s(v)})},[]);return Ao(()=>{cancelAnimationFrame(t.current)}),[r,l]};function No(n){const{dataSource:t,filterFn:r}=n,[s,l]=(0,M.useState)(""),v=s!=="",I=(0,M.useMemo)(()=>t.filter(D=>r(D,s)),[t,s]);return{searchText:s,setSearchText:l,isSearching:v,searchResult:I}}var yr=e(99698);function Po(n){const[t,r]=(0,M.useState)(n);return(0,M.useLayoutEffect)(()=>{(0,yr.wU)(t,n)||r(n)},[n]),t}function Oo(n,t){const r=Ye(t);(0,M.useLayoutEffect)(()=>{r()},n)}var Hs=e(31676),Vs=e(85466),Co=Object.defineProperty,Er=Object.getOwnPropertySymbols,jo=Object.prototype.hasOwnProperty,To=Object.prototype.propertyIsEnumerable,hr=(n,t,r)=>t in n?Co(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Dr=(n,t)=>{for(var r in t||(t={}))jo.call(t,r)&&hr(n,r,t[r]);if(Er)for(var r of Er(t))To.call(t,r)&&hr(n,r,t[r]);return n};function $s(n,t,{onChangeFound:r,onNoChangeFound:s}={}){const l=useRef(t);useEffect(()=>{if(!isDevelopment)return;const v=Object.keys(Dr(Dr({},l.current),t)),I={};v.forEach(D=>{l.current[D]!==t[D]&&(I[D]={from:l.current[D],to:t[D],changedKeys:t[D]&&typeof t[D]=="object"?Object.keys(l.current[D]).map(f=>_get(l.current,[D,f])===_get(t,[D,f])?"":f).filter(Boolean):void 0,isDeepEqual:_isEqual(l.current[D],t[D])})}),Object.keys(I).length?r?r({changesObj:I}):console.log("[why-did-you-update]",n,{changes:parse(stringify(I)),props:{from:l.current,to:t}}):s&&s(),l.current=t})}var qn=e(71205);const[So,Lo]=(0,K._C)();var zo=e(36350),xo=e(61506),er=e(81281),Uo=Object.defineProperty,Ar=Object.getOwnPropertySymbols,Fo=Object.prototype.hasOwnProperty,Ro=Object.prototype.propertyIsEnumerable,Ir=(n,t,r)=>t in n?Uo(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Bo=(n,t)=>{for(var r in t||(t={}))Fo.call(t,r)&&Ir(n,r,t[r]);if(Ar)for(var r of Ar(t))Ro.call(t,r)&&Ir(n,r,t[r]);return n};const In=(0,zo.create)()((0,xo.tJ)(n=>Bo({},er.Xb),{name:"globalConfigStore"}));var wo=Object.defineProperty,Nr=Object.getOwnPropertySymbols,Qo=Object.prototype.hasOwnProperty,Wo=Object.prototype.propertyIsEnumerable,Pr=(n,t,r)=>t in n?wo(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Or=(n,t)=>{for(var r in t||(t={}))Qo.call(t,r)&&Pr(n,r,t[r]);if(Nr)for(var r of Nr(t))Wo.call(t,r)&&Pr(n,r,t[r]);return n},bo=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});function Cr(){return In.getState()}function Go(){return bo(this,null,function*(){const{data:n}=yield S.W.get("/api/config/client");return In.setState(Or(Or({},er.Xb),n)),n})}var jt=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});function jr(n){return jt(this,null,function*(){const{data:t}=yield S.W.post("/api/friend/request/add",{to:n});return t})}function Tr(n){return jt(this,null,function*(){yield S.W.post("/api/friend/request/accept",{requestId:n})})}function Sr(n){return jt(this,null,function*(){yield S.W.post("/api/friend/request/deny",{requestId:n})})}function Lr(n){return jt(this,null,function*(){yield S.W.post("/api/friend/request/cancel",{requestId:n})})}function zr(n){return jt(this,null,function*(){yield S.W.post("/api/friend/removeFriend",{friendUserId:n})})}function Yo(n,t){return jt(this,null,function*(){yield S.W.post("/api/friend/setFriendNickname",{targetId:n,nickname:t})})}var Be=e(19478),ks=e(75135),xr=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});function Ko(n){return xr(this,null,function*(){yield S.W.post("/api/chat/inbox/ack",{inboxItemIds:n})})}function Jo(){return xr(this,null,function*(){yield S.W.post("/api/chat/inbox/clear")})}function Zo(){const n=(0,ye.CG)(s=>s.chat.converses),t=(0,ye.CG)(s=>s.chat.lastMessageMap),r=(0,M.useMemo)(()=>Object.entries(n).filter(([,s])=>[ce.tv.DM,ce.tv.Multi].includes(s.type)).map(([,s])=>s),[n]);return(0,M.useMemo)(()=>r.sort((s,l)=>{var v,I;return((v=t[s._id])!=null?v:"")<((I=t[l._id])!=null?I:"")?1:-1}),[r,t])}var Ho=e(77837),Vo=e.n(Ho);const $o=Vo()((n,t)=>{(0,ce.g3)(n,t)},1e3,{leading:!0,trailing:!0});function ko(n){const t=(0,ye.TL)(),r=(0,ye.CG)(D=>D.chat.lastMessageMap[n]),s=(0,M.useRef)("");s.current=(0,ye.CG)(D=>{var f;return(f=D.chat.ack[n])!=null?f:""});const l=Ye((D,f)=>{(0,b.AJ)(f)||(0,b.YQ)(s.current)&&f<=s.current||(t(Me.setConverseAck({converseId:D,lastMessageId:f})),$o(D,f),s.current=f)}),v=Ye(D=>{l(n,D)}),I=Ye(()=>{v(r)});return{updateConverseAck:v,markConverseAllAck:I}}function Ur(){return(0,ye.CG)(n=>n.user.info)}function Nn(){var n;return(n=Ur())==null?void 0:n._id}var Xo=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});function _o(n){const t=Nn(),r=(0,ye.CG)(l=>l.user.friends),{value:s=""}=st(()=>Xo(this,null,function*(){return(0,b.YQ)(t)?(0,gt.S8)(t,n):""}),[t,n.name,n.members.join(","),r]);return s}var qo=e(95850);function Fr(n){const t=(0,ye.CG)(s=>s.chat.ack),r=(0,ye.CG)(s=>s.chat.lastMessageMap);return n.map(s=>t[s]===void 0&&r[s]!==void 0?!0:r[s]>t[s])}var es=e(6494),ts=e.n(es);function Tt(n){var t;return(t=(0,ye.CG)(r=>r.group.groups[n]))!=null?t:null}function Rr(n){var t;const r=Tt(n),s=(t=r==null?void 0:r.members)!=null?t:[];return(0,M.useMemo)(()=>s.map(v=>v.userId),[s])}function ns(n){const t=Rr(n),r=_n(t);return ts()(r)}function Br(n){const t=Tt(n);return(0,M.useMemo)(()=>{var r;return(r=t==null?void 0:t.panels)!=null?r:[]},[t])}function rs(n,t){const r=Br(n);return(0,M.useMemo)(()=>{var s;return(s=r.find(l=>l.id===t))!=null?s:null},[n,t,r])}function os(n,t){const r=Tt(n),s=Nn();return(0,b.YQ)(t)?(r==null?void 0:r.owner)===t:typeof s=="string"&&(r==null?void 0:r.owner)===s}function ss(n){return Fr([n])[0]}function as(n){return n.type===Be.GroupPanelType.TEXT}function us(n){const t=Tt(n),r=(0,ye.CG)(v=>v.chat.lastMessageMap),s=(0,ye.TL)();return{markGroupAllAck:Ye(()=>{var v;const I=((v=t==null?void 0:t.panels)!=null?v:[]).filter(as);for(const D of I){const f=D.id,w=r[f];f&&w&&(s(Me.setConverseAck({converseId:f,lastMessageId:w})),(0,ce.g3)(f,w))}})}}function ls(n,t){const r=(0,ye.CG)(s=>{var l,v;return(v=(l=s.group.groups[n])==null?void 0:l.members.find(I=>I.userId===t))==null?void 0:v.muteUntil});return!r||new Date(r).valueOf()<new Date().valueOf()?!1:r}var is=e(90292),cs=e.n(is),ds=e(62923),wr=e.n(ds);function fs(n){var t,r;const s=Tt(n),l=Nn();if(!s||!l)return[];if(s.owner===l)return tr().map(w=>w.key);const v=s.members,I=s.roles,D=(r=(t=v.find(w=>w.userId===l))==null?void 0:t.roles)!=null?r:[],f=cs()([...wr()(D.map(w=>{var he,se;return(se=(he=I.find(ut=>String(ut._id)===w))==null?void 0:he.permissions)!=null?se:[]})),...s.fallbackPermissions]);return(0,M.useDebugValue)({groupRoles:I,userRoles:D,userPermissions:f,fallbackPermissions:s.fallbackPermissions}),f}function Ms(n,t){const r=fs(n),s=(0,M.useMemo)(()=>t.map(l=>r.includes(l)),[r.join(","),t.join(",")]);return(0,M.useDebugValue)({groupId:n,userPermissions:r,checkedPermissions:t,result:s}),s}function Qr(){return(0,ye.CG)(n=>{var t;return(t=n.chat.inbox)!=null?t:[]})}function gs(n){var t;return(t=Qr().find(s=>s._id===n))!=null?t:null}var ms=Object.defineProperty,Wr=Object.getOwnPropertySymbols,ps=Object.prototype.hasOwnProperty,vs=Object.prototype.propertyIsEnumerable,br=(n,t,r)=>t in n?ms(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Gr=(n,t)=>{for(var r in t||(t={}))ps.call(t,r)&&br(n,r,t[r]);if(Wr)for(var r of Wr(t))vs.call(t,r)&&br(n,r,t[r]);return n},ys=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});function Es(n,t){t.dispatch(Pt.setNetworkStatus("initial")),Yr(n,t),hs(n,t),n.onReconnect(()=>{console.warn("\u56E0\u4E3A\u65AD\u7EBF\u91CD\u8FDE\u89E6\u53D1\u91CD\u65B0\u540C\u6B65\u8FDC\u7A0B\u6570\u636E"),Yr(n,t),t.dispatch(Me.clearAllConverses()),t.dispatch(Pt.incReconnectNum())}),te.A.on("updateNetworkStatus",r=>{t.dispatch(Pt.setNetworkStatus(r))})}function Yr(n,t){console.log("\u521D\u59CB\u5316Redux\u4E0A\u4E0B\u6587...");const r=n.request("chat.converse.findAndJoinRoom").catch(s=>{throw console.error(s),R((0,g.t)("\u65E0\u6CD5\u52A0\u5165\u623F\u95F4, \u60A8\u5C06\u65E0\u6CD5\u83B7\u53D6\u5230\u6700\u65B0\u7684\u4FE1\u606F, \u8BF7\u5237\u65B0\u9875\u9762\u540E\u91CD\u8BD5"),"error"),new Error("findAndJoinRoom failed")});Promise.all([r,(0,ce.LB)()]).then(([{dmConverseIds:s,textPanelIds:l},v])=>{v.forEach(D=>{t.dispatch(Me.setConverseAck({converseId:D.converseId,lastMessageId:D.lastMessageId}))});const I=[...s,...l];$t(I).then(D=>{t.dispatch(Me.setLastMessageMap(D))})}),n.request("friend.getAllFriends").then(s=>{t.dispatch(qe.setFriendList(s))}),n.request("friend.request.allRelated").then(s=>{t.dispatch(qe.setFriendRequests(s))}),n.request("user.dmlist.getAllConverse").then(s=>{(s??[]).forEach(l=>ys(this,null,function*(){try{const v=yield(0,ve.r5)(l);t.dispatch(Me.setConverseInfo(v))}catch(v){console.error(v)}}))}),n.request("group.getUserGroups").then(s=>{t.dispatch(yt.appendGroups(s))}),n.request("chat.inbox.all").then(s=>{t.dispatch(Me.setInboxList(s))})}function hs(n,t){n.listen("friend.add",({userId:r})=>{if(typeof r!="string"){console.error("\u9519\u8BEF\u7684\u4FE1\u606F",r);return}t.dispatch(qe.appendFriend({id:r}))}),n.listen("friend.request.add",r=>{t.dispatch(qe.appendFriendRequest(r))}),n.listen("friend.request.remove",({requestId:r})=>{t.dispatch(qe.removeFriendRequest(r))}),n.listen("chat.message.add",r=>{const s=r.converseId,l=t.getState().chat.converses[s],v=()=>{t.dispatch(Me.appendConverseMessage({converseId:s,messages:[r]}))};l?v():r.groupId?t.dispatch(Me.setLastMessageMap([{converseId:s,lastMessageId:r._id}])):(0,ve.r5)(s).then(I=>{[ce.tv.DM,ce.tv.Multi].includes(I.type)&&(0,B.appendUserDMConverse)(I._id),t.dispatch(Me.setConverseInfo(I)),v()}),te.A.emit("receiveMessage",r)}),n.listen("chat.message.update",r=>{t.dispatch(Me.updateMessageInfo({message:r}))}),n.listen("chat.message.delete",({converseId:r,messageId:s})=>{t.dispatch(Me.deleteMessageById({converseId:r,messageId:s}))}),n.listen("chat.message.addReaction",({converseId:r,messageId:s,reaction:l})=>{t.dispatch(Me.appendMessageReaction({converseId:r,messageId:s,reaction:l}))}),n.listen("chat.message.removeReaction",({converseId:r,messageId:s,reaction:l})=>{t.dispatch(Me.removeMessageReaction({converseId:r,messageId:s,reaction:l}))}),n.listen("chat.converse.updateDMConverse",r=>{t.dispatch(Me.setConverseInfo(r))}),n.listen("group.add",r=>{t.dispatch(yt.appendGroups([r]))}),n.listen("group.updateInfo",r=>{t.dispatch(yt.updateGroup(r))}),n.listen("group.remove",({groupId:r})=>{t.dispatch(yt.removeGroup(r))}),n.listen("chat.inbox.append",r=>{t.dispatch(Me.appendInboxItem(r))}),n.listen("chat.inbox.updated",()=>{n.request("chat.inbox.all").then(r=>{t.dispatch(Me.setInboxList(r))})}),n.listen("config.updateClientConfig",r=>{In.setState(s=>Gr(Gr({},s),r))}),So.forEach(({eventName:r,eventFn:s})=>{n.listen(r,s)})}function Ds(){return(0,ct.xC)({reducer:Gn,middleware:t=>t({serializableCheck:!1}),devTools:!1})}const As=Ds();function Is(){return As}function Ns(n,t){return wr()(n.map((r,s)=>s===0?[r]:[t,r]))}var Ps=e(35708),He=e.n(Ps),Os=e(79201),Cs=e.n(Os),js=e(58104),Ts=e.n(js),Xs=e(57570);He().extend(Cs()),He().extend(Ts()),He().locale("zh-cn"),(0,g.lT)(n=>{if(n==="en-US"){He().locale("en");return}He().locale("zh-cn")});function Kr(n){return He()(n).isSame(He()(),"d")}function _s(n){const t=dayjs(n);return Kr(t)?t.fromNow():t.format("YYYY-MM-DD HH:mm:ss")}function Ss(n){const t=He()(n);return Kr(t)?Jr(t):Zr(t)}function Ls(n,t){return Math.abs(n.valueOf()-t.valueOf())>15*60*1e3}function Jr(n){return He()(n).format("HH:mm")}function Zr(n){return He()(n).format("YYYY-MM-DD HH:mm:ss")}function qs(n){return dayjs(n).toNow()}function zs(n){return He()(n).fromNow()}function xs(n){return He().duration(n,"ms").humanize()}function Us(n){if(typeof n!="string")return!1;try{return JSON.parse(n),!0}catch(t){return!1}}var Fs=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});const Rs=Symbol("AllPermission"),Ce={core:{message:"core.message",invite:"core.invite",unlimitedInvite:"core.unlimitedInvite",editInvite:"core.editInvite",groupDetail:"core.groupDetail",groupConfig:"core.groupConfig",manageUser:"core.manageUser",managePanel:"core.managePanel",manageInvite:"core.manageInvite",manageRoles:"core.manageRoles",deleteMessage:"core.deleteMessage"}},tr=()=>[{key:Ce.core.message,title:(0,g.t)("\u53D1\u9001\u6D88\u606F"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u5728\u6587\u5B57\u9891\u9053\u53D1\u9001\u6D88\u606F"),default:!0},{key:Ce.core.invite,title:(0,g.t)("\u9080\u8BF7\u94FE\u63A5"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u521B\u5EFA\u9080\u8BF7\u94FE\u63A5"),default:!1},{key:Ce.core.unlimitedInvite,title:(0,g.t)("\u4E0D\u9650\u65F6\u9080\u8BF7\u94FE\u63A5"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u521B\u5EFA\u4E0D\u9650\u65F6\u9080\u8BF7\u94FE\u63A5"),default:!1,required:[Ce.core.invite]},{key:Ce.core.editInvite,title:(0,g.t)("\u7F16\u8F91\u9080\u8BF7\u94FE\u63A5"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u7F16\u8F91\u9080\u8BF7\u94FE\u63A5"),default:!1,required:[Ce.core.unlimitedInvite]},{key:Ce.core.groupDetail,title:(0,g.t)("\u67E5\u770B\u7FA4\u7EC4\u8BE6\u60C5"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u67E5\u770B\u7FA4\u7EC4\u8BE6\u60C5"),default:!1},{key:Ce.core.groupConfig,title:(0,g.t)("\u4FEE\u6539\u7FA4\u7EC4\u914D\u7F6E"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u4FEE\u6539\u7FA4\u7EC4\u914D\u7F6E"),default:!1,required:[Ce.core.groupDetail]},{key:Ce.core.manageUser,title:(0,g.t)("\u5141\u8BB8\u7BA1\u7406\u7528\u6237"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u7BA1\u7406\u7528\u6237\uFF0C\u5982\u7981\u8A00\u3001\u79FB\u9664\u7528\u6237\u7B49\u64CD\u4F5C"),default:!1,required:[Ce.core.groupDetail]},{key:Ce.core.managePanel,title:(0,g.t)("\u5141\u8BB8\u7BA1\u7406\u9891\u9053"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u67E5\u770B\u7BA1\u7406\u9891\u9053"),default:!1,required:[Ce.core.groupDetail]},{key:Ce.core.manageInvite,title:(0,g.t)("\u5141\u8BB8\u7BA1\u7406\u9080\u8BF7\u94FE\u63A5"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u7BA1\u7406\u9080\u8BF7\u94FE\u63A5"),default:!1,required:[Ce.core.groupDetail]},{key:Ce.core.manageRoles,title:(0,g.t)("\u5141\u8BB8\u7BA1\u7406\u8EAB\u4EFD\u7EC4"),desc:(0,g.t)("\u5141\u8BB8\u6210\u5458\u7BA1\u7406\u8EAB\u4EFD\u7EC4"),default:!1,required:[Ce.core.groupDetail]},{key:Ce.core.deleteMessage,title:(0,g.t)("\u5220\u9664\u6D88\u606F"),desc:(0,g.t)("\u5141\u8BB8\u5220\u9664\u7528\u6237\u4FE1\u606F"),default:!1,required:[Ce.core.groupDetail]}];function Hr(){return tr().filter(n=>n.default).map(n=>n.key)}function Bs(n){return Fs(this,null,function*(){yield Be.modifyGroupField(n,"fallbackPermissions",Hr())})}var ws=e(85848),Qs=e.n(ws),Ws=(n,t,r)=>new Promise((s,l)=>{var v=f=>{try{D(r.next(f))}catch(w){l(w)}},I=f=>{try{D(r.throw(f))}catch(w){l(w)}},D=f=>f.done?s(f.value):Promise.resolve(f.value).then(v,I);D((r=r.apply(n,t)).next())});function bs(n){return Ws(this,arguments,function*(t,r={}){const s=new FormData;s.append("file",t);const l=Cr().uploadFileLimit;if(t.size>l)throw F(`${(0,g.t)("\u4E0A\u4F20\u5931\u8D25, \u652F\u6301\u7684\u6587\u4EF6\u6700\u5927\u5927\u5C0F\u4E3A:")} ${Qs()(l,{base:2})}`),new Error("File Too Large");try{const{data:v}=yield S.W.post("/upload",s,{onUploadProgress(I){I.lengthComputable&&typeof r.onProgress=="function"&&r.onProgress(I.loaded/I.total,I)}});return v}catch(v){throw R(`${(0,g.t)("\u4E0A\u4F20\u5931\u8D25")}: ${(0,g.t)("\u53EF\u80FD\u662F\u6587\u4EF6\u4F53\u79EF\u8FC7\u5927")}`,"error"),console.error(`${(0,g.t)("\u4E0A\u4F20\u5931\u8D25")}: ${dt()(v,"message")}`),v}})}var Gs=e(58787)},11318:(U,O,e)=>{"use strict";e.d(O,{D3:()=>z,MG:()=>A,Nt:()=>p,_C:()=>Q,g9:()=>C});var o=e(45563),c=e.n(o),a=e(85466),i=e.n(a),N=(j,S,P)=>new Promise((x,h)=>{var T=g=>{try{m(P.next(g))}catch(K){h(K)}},E=g=>{try{m(P.throw(g))}catch(K){h(K)}},m=g=>g.done?x(g.value):Promise.resolve(g.value).then(T,E);m((P=P.apply(j,S)).next())});function p(j,S){let P;return[(...T)=>{if(!P){if(c()(S))return S(...T);throw new Error(`${j} not regist`)}return P(...T)},T=>{P=T}]}function A(j,S){const[P,x]=p(j,S),h=[];return[P,m=>{x(m),h.forEach(g=>g(m))},m=>{h.push(m)}]}function L(j,S){const[P,x]=p(j,S);let h=null,T;function E(R){return h!==null&&_isEqual(R,T)}const m=(...R)=>{if(E(R))return h;{const Y=P(...R);return h=Y??null,T=R,Y}},g=()=>{h=null};return[m,R=>{x(R),g()},g]}function C(j,S){const[P,x]=p(j,S);let h=null,T;function E(R){return h!==null&&i()(R,T)}const m=(...R)=>N(this,null,function*(){if(E(R))return h;{const Y=yield P(...R);return h=Y??null,T=R,Y}}),g=()=>{h=null};return[m,R=>{x(R),g()},g]}function Q(){const j=[];return[j,P=>{j.push(P)}]}function z(){const j={};return[j,(P,x)=>{j[P]&&console.warn("[buildRegMap] \u91CD\u590D\u6CE8\u518C:",P),j[P]=x}]}},71205:(U,O,e)=>{"use strict";e.d(O,{J7:()=>a,Jd:()=>c,Ov:()=>N,cs:()=>p,mx:()=>i});var o=e(11318);const[c,a]=(0,o.Nt)("requestErrorHook",()=>!0),[i,N,p]=(0,o.g9)("requestTokenGetter")},49076:(U,O,e)=>{"use strict";e.d(O,{A6:()=>i,YA:()=>a,qQ:()=>c});var o=e(11318);const[c,a,i]=(0,o.MG)("serverUrl",()=>window.location.origin)},54284:(U,O,e)=>{"use strict";e.d(O,{cF:()=>a,po:()=>i,y$:()=>p});var o=e(11318),c=e(52983);const[a,i]=(0,o.Nt)("storage"),N=new Map;function p(A,L){var C;const[Q,z]=(0,c.useState)((C=N.get(A))!=null?C:L);(0,c.useLayoutEffect)(()=>{a().get(A).then(P=>{z(P??L),N.set(A,P??L)})},[A]);const j=(0,c.useCallback)(P=>{z(P),a().set(A,P),N.set(A,P)},[A]),S=(0,c.useCallback)(P=>{z(P),a().save(A,P),N.set(A,P)},[A]);return[Q,{set:j,save:S}]}},22149:(U,O,e)=>{"use strict";e.d(O,{L1:()=>i,LB:()=>L,g3:()=>A,jW:()=>p,m8:()=>N,tv:()=>a});var o=e(72163),c=(C,Q,z)=>new Promise((j,S)=>{var P=T=>{try{h(z.next(T))}catch(E){S(E)}},x=T=>{try{h(z.throw(T))}catch(E){S(E)}},h=T=>T.done?j(T.value):Promise.resolve(T.value).then(P,x);h((z=z.apply(C,Q)).next())}),a=(C=>(C.DM="DM",C.Multi="Multi",C.Group="Group",C))(a||{});function i(C){return c(this,null,function*(){const{data:Q}=yield o.W.post("/api/chat/converse/createDMConverse",{memberIds:C});return Q})}function N(C,Q){return c(this,null,function*(){const{data:z}=yield o.W.post("/api/chat/converse/appendDMConverseMembers",{converseId:C,memberIds:Q});return z})}function p(C){return c(this,null,function*(){const{data:Q}=yield o.W.get("/api/chat/converse/findConverseInfo",{params:{converseId:C}});return Q})}function A(C,Q){return c(this,null,function*(){yield o.W.post("/api/chat/ack/update",{converseId:C,lastMessageId:Q})})}function L(){return c(this,null,function*(){const{data:C}=yield o.W.get("/api/chat/ack/all");return Array.isArray(C)?C:[]})}},19478:(U,O,e)=>{"use strict";e.r(O),e.d(O,{GroupPanelType:()=>j,appendGroupMemberRoles:()=>K,applyGroupInvite:()=>re,createGroup:()=>x,createGroupInviteCode:()=>Y,createGroupPanel:()=>je,createGroupRole:()=>Ae,deleteGroupInvite:()=>Ie,deleteGroupMember:()=>ve,deleteGroupPanel:()=>De,deleteGroupRole:()=>Le,editGroupInvite:()=>F,findGroupInviteByCode:()=>X,getAllGroupInviteCode:()=>J,getGroupBasicInfo:()=>h,getGroupConfigWithInfo:()=>P,getGroupPanelExtraData:()=>Oe,groupConfigNames:()=>S,isMember:()=>g,modifyGroupConfig:()=>E,modifyGroupField:()=>T,modifyGroupPanel:()=>te,muteGroupMember:()=>xe,quitGroup:()=>m,removeGroupMemberRoles:()=>R,saveGroupPanelExtraData:()=>we,updateGroupRoleName:()=>Je,updateGroupRolePermission:()=>Pe});var o=e(72163),c=Object.defineProperty,a=Object.defineProperties,i=Object.getOwnPropertyDescriptors,N=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,L=(B,b,$)=>b in B?c(B,b,{enumerable:!0,configurable:!0,writable:!0,value:$}):B[b]=$,C=(B,b)=>{for(var $ in b||(b={}))p.call(b,$)&&L(B,$,b[$]);if(N)for(var $ of N(b))A.call(b,$)&&L(B,$,b[$]);return B},Q=(B,b)=>a(B,i(b)),z=(B,b,$)=>new Promise((G,M)=>{var W=ee=>{try{V($.next(ee))}catch(ue){M(ue)}},H=ee=>{try{V($.throw(ee))}catch(ue){M(ue)}},V=ee=>ee.done?G(ee.value):Promise.resolve(ee.value).then(W,H);V(($=$.apply(B,b)).next())}),j=(B=>(B[B.TEXT=0]="TEXT",B[B.GROUP=1]="GROUP",B[B.PLUGIN=2]="PLUGIN",B))(j||{});const S=["hideGroupMemberDiscriminator","disableCreateConverseFromGroup","groupBackgroundImage"];function P(B){var b,$,G;const M=(b=B==null?void 0:B.config)!=null?b:{};return Q(C({},M),{hideGroupMemberDiscriminator:($=M.hideGroupMemberDiscriminator)!=null?$:!1,disableCreateConverseFromGroup:(G=M.disableCreateConverseFromGroup)!=null?G:!1})}function x(B,b){return z(this,null,function*(){const{data:$}=yield o.W.post("/api/group/createGroup",{name:B,panels:b});return $})}function h(B){return z(this,null,function*(){const{data:b}=yield o.W.get("/api/group/getGroupBasicInfo",{params:{groupId:B}});return b})}function T(B,b,$){return z(this,null,function*(){yield o.W.post("/api/group/updateGroupField",{groupId:B,fieldName:b,fieldValue:$})})}function E(B,b,$){return z(this,null,function*(){yield o.W.post("/api/group/updateGroupConfig",{groupId:B,configName:b,configValue:$})})}function m(B){return z(this,null,function*(){yield o.W.post("/api/group/quitGroup",{groupId:B})})}function g(B){return z(this,null,function*(){const{data:b}=yield o.W.post("/api/group/isMember",{groupId:B});return b})}function K(B,b,$){return z(this,null,function*(){yield o.W.post("/api/group/appendGroupMemberRoles",{groupId:B,memberIds:b,roles:$})})}function R(B,b,$){return z(this,null,function*(){yield o.W.post("/api/group/removeGroupMemberRoles",{groupId:B,memberIds:b,roles:$})})}function Y(B,b){return z(this,null,function*(){const{data:$}=yield o.W.post("/api/group/invite/createGroupInvite",{groupId:B,inviteType:b});return $})}function F(B,b,$,G){return z(this,null,function*(){yield o.W.post("/api/group/invite/editGroupInvite",{groupId:B,code:b,expiredAt:$,usageLimit:G})})}function J(B){return z(this,null,function*(){const{data:b}=yield o.W.get("/api/group/invite/getAllGroupInviteCode",{params:{groupId:B}});return b})}function X(B){return z(this,null,function*(){const{data:b}=yield o.W.get("/api/group/invite/findInviteByCode",{params:{code:B}});return b})}function re(B){return z(this,null,function*(){yield o.W.post("/api/group/invite/applyInvite",{code:B})})}function Ie(B,b){return z(this,null,function*(){yield o.W.post("/api/group/invite/deleteInvite",{groupId:B,inviteId:b})})}function je(B,b){return z(this,null,function*(){yield o.W.post("/api/group/createGroupPanel",Q(C({},b),{groupId:B}))})}function te(B,b,$){return z(this,null,function*(){yield o.W.post("/api/group/modifyGroupPanel",Q(C({},$),{groupId:B,panelId:b}))})}function De(B,b){return z(this,null,function*(){yield o.W.post("/api/group/deleteGroupPanel",{groupId:B,panelId:b})})}function Ae(B,b,$){return z(this,null,function*(){yield o.W.post("/api/group/createGroupRole",{groupId:B,roleName:b,permissions:$})})}function Le(B,b){return z(this,null,function*(){yield o.W.post("/api/group/deleteGroupRole",{groupId:B,roleId:b})})}function Je(B,b,$){return z(this,null,function*(){yield o.W.post("/api/group/updateGroupRoleName",{groupId:B,roleId:b,roleName:$})})}function Pe(B,b,$){return z(this,null,function*(){yield o.W.post("/api/group/updateGroupRolePermission",{groupId:B,roleId:b,permissions:$})})}function xe(B,b,$){return z(this,null,function*(){yield o.W.post("/api/group/muteGroupMember",{groupId:B,memberId:b,muteMs:$})})}function ve(B,b){return z(this,null,function*(){yield o.W.post("/api/group/deleteGroupMember",{groupId:B,memberId:b})})}function Oe(B,b,$){return z(this,null,function*(){var G;const{data:M}=yield o.W.post("/api/group/extra/getPanelData",{groupId:B,panelId:b,name:$});return(G=M.data)!=null?G:null})}function we(B,b,$,G){return z(this,null,function*(){yield o.W.post("/api/group/extra/savePanelData",{groupId:B,panelId:b,name:$,data:typeof G=="string"?G:JSON.stringify(G)})})}},75135:(U,O,e)=>{"use strict";e.d(O,{c0:()=>a,g3:()=>i,zd:()=>N});var o=e(72163),c=(p,A,L)=>new Promise((C,Q)=>{var z=P=>{try{S(L.next(P))}catch(x){Q(x)}},j=P=>{try{S(L.throw(P))}catch(x){Q(x)}},S=P=>P.done?C(P.value):Promise.resolve(P.value).then(z,j);S((L=L.apply(p,A)).next())});function a(){return c(this,null,function*(){const{data:p}=yield o.W.get("/api/plugin/registry/list");return p})}function i(){return c(this,null,function*(){const{data:p}=yield o.W.get("/registry-be.json");return p})}function N(){return c(this,null,function*(){const{data:p}=yield o.W.get("/registry.json",{baseURL:""});return p})}},77100:(U,O,e)=>{"use strict";e.r(O),e.d(O,{appendUserDMConverse:()=>ve,checkTokenValid:()=>$,claimTemporaryUser:()=>De,createTemporaryUser:()=>te,fetchUserInfo:()=>Je,forgetPassword:()=>Ie,getUserOnlineStatus:()=>xe,getUserSettings:()=>B,loginWithEmail:()=>R,loginWithToken:()=>Y,modifyUserExtra:()=>we,modifyUserField:()=>Oe,modifyUserPassword:()=>re,pickUserBaseInfo:()=>g,registerWithEmail:()=>X,resetPassword:()=>je,searchUserWithUniqueName:()=>Ae,setUserSettings:()=>b,verifyEmail:()=>F,verifyEmailWithOTP:()=>J});var o=e(72163),c=e(96393),a=e(99852),i=e(81281),N=e(11286),p=e.n(N),A=e(62923),L=e.n(A),C=(G,M,W)=>new Promise((H,V)=>{var ee=fe=>{try{de(W.next(fe))}catch(k){V(k)}},ue=fe=>{try{de(W.throw(fe))}catch(k){V(k)}},de=fe=>fe.done?H(fe.value):Promise.resolve(fe.value).then(ee,ue);de((W=W.apply(G,M)).next())});function Q(G,M=200){let W=[],H=null;function V(){return C(this,null,function*(){H=null;const ee=[...W];W=[];try{const ue=yield G(ee.map(de=>de.params));ee.forEach((de,fe)=>{de.resolve(ue[fe])})}catch(ue){ee.forEach(de=>{de.reject(ue)})}})}return ee=>(H||(H=window.setTimeout(()=>{V()},M)),new Promise((ue,de)=>{W.push({params:ee,resolve:ue,reject:de})}))}function z(G,M,W=100){return H=>C(this,null,function*(){const V=p()(H,W);if(M==="serial"){const ee=[];for(const ue of V){const de=yield G(ue);Array.isArray(de)?ee.push(...de):console.warn("[createAutoSplitRequest] fn should be return array")}return ee}else if(M==="parallel"){const ee=yield Promise.all(V.map(ue=>G(ue)));return L()(ee)}return[]})}var j=e(49335),S=e.n(j),P=e(90292),x=e.n(P),h=e(54142),T=e.n(h),E=e(19692),m=(G,M,W)=>new Promise((H,V)=>{var ee=fe=>{try{de(W.next(fe))}catch(k){V(k)}},ue=fe=>{try{de(W.throw(fe))}catch(k){V(k)}},de=fe=>fe.done?H(fe.value):Promise.resolve(fe.value).then(ee,ue);de((W=W.apply(G,M)).next())});function g(G){return S()(G,["_id","email","nickname","discriminator","avatar","temporary","emailVerified","banned"])}const K={[i.q6]:()=>({_id:i.q6,email:"admin@msgbyte.com",nickname:(0,E.t)("\u7CFB\u7EDF"),discriminator:"0000",avatar:null,temporary:!1,emailVerified:!1,banned:!1})};function R(G,M){return m(this,null,function*(){const{data:W}=yield o.W.post("/api/user/login",{email:G,password:M});return a.A.emit("loginSuccess",g(W)),W})}function Y(G){return m(this,null,function*(){const{data:M}=yield o.W.post("/api/user/resolveToken",{token:G});return a.A.emit("loginSuccess",g(M)),M})}function F(G){return m(this,null,function*(){const{data:M}=yield o.W.post("/api/user/verifyEmail",{email:G});return M})}function J(G){return m(this,null,function*(){const{data:M}=yield o.W.post("/api/user/verifyEmailWithOTP",{emailOTP:G});return M})}function X(G){return m(this,arguments,function*({email:M,password:W,nickname:H,emailOTP:V}){const{data:ee}=yield o.W.post("/api/user/register",{email:M,nickname:H,password:W,emailOTP:V});return ee})}function re(G,M){return m(this,null,function*(){yield o.W.post("/api/user/modifyPassword",{oldPassword:G,newPassword:M})})}function Ie(G){return m(this,null,function*(){yield o.W.post("/api/user/forgetPassword",{email:G})})}function je(G,M,W){return m(this,null,function*(){yield o.W.post("/api/user/resetPassword",{email:G,password:M,otp:W})})}function te(G){return m(this,null,function*(){const{data:M}=yield o.W.post("/api/user/createTemporaryUser",{nickname:G});return M})}function De(G,M,W,H){return m(this,null,function*(){const{data:V}=yield o.W.post("/api/user/claimTemporaryUser",{userId:G,email:M,password:W,emailOTP:H});return V})}function Ae(G){return m(this,null,function*(){const{data:M}=yield o.W.post("/api/user/searchUserWithUniqueName",{uniqueName:G});return M})}const Le=Q(z(G=>m(void 0,null,function*(){const{data:M}=yield o.W.post("/api/user/getUserInfoList",{userIds:G});return M}),"serial",1e3));function Je(G){return m(this,null,function*(){return K[G]&&typeof K[G]=="function"?K[G]():yield Le(G)})}const Pe=Q(z(G=>m(void 0,null,function*(){const M=x()(L()(G)),{data:W}=yield o.W.post("/api/gateway/checkUserOnline",{userIds:M}),H=T()(M,W);return G.map(V=>V.map(ee=>{var ue;return(ue=H[ee])!=null?ue:!1}))}),"serial",1e3));function xe(G){return m(this,null,function*(){return Pe(G)})}function ve(G){return m(this,null,function*(){const{data:M}=yield o.W.post("/api/user/dmlist/addConverse",{converseId:G});return M})}function Oe(G,M){return m(this,null,function*(){const{data:W}=yield o.W.post("/api/user/updateUserField",{fieldName:G,fieldValue:M});return W})}function we(G,M){return m(this,null,function*(){const{data:W}=yield o.W.post("/api/user/updateUserExtra",{fieldName:G,fieldValue:M});return W})}function B(){return m(this,null,function*(){const{data:G}=yield o.W.get("/api/user/getUserSettings");return a.A.emit("userSettingsUpdate",G),G})}function b(G){return m(this,null,function*(){const{data:M}=yield o.W.post("/api/user/setUserSettings",{settings:G});return M})}const $=(0,c.w)("tokenValid",G=>m(void 0,null,function*(){const{data:M}=yield o.W.post("/api/user/checkTokenValid",{token:G});return M}))},84966:(U,O,e)=>{"use strict";e.d(O,{CG:()=>c,TL:()=>a});var o=e(99698);function c(N,p){return(0,o.v9)(N,p)}const a=o.I0;function i(){return useStore()}},95850:(U,O,e)=>{"use strict";e.d(O,{T:()=>N,x:()=>p});var o=e(52983),c=e(96228),a=e(518),i=e(84966);function N(A){const L=(0,i.CG)(C=>{var Q;return(Q=C.user.friends.find(z=>z.id===A))==null?void 0:Q.nickname});return(0,a.YQ)(L)?L:null}function p(){const A=(0,i.CG)(C=>C.user.friends);return(0,o.useMemo)(()=>(0,c.No)(A),[A])}},81281:(U,O,e)=>{"use strict";e.d(O,{Px:()=>c,Xb:()=>i,q6:()=>a});const o=/^([0-9a-zA-Z]{1,2}|[\u4e00-\u9eff]|[\u3040-\u309F]|[\u30A0-\u30FF]){1,8}$/,c="i18n:language",a="000000000000000000000000",i={uploadFileLimit:1*1024*1024,emailVerification:!1,serverName:"Tailchat",disableUserRegister:!1,disableGuestLogin:!1,disableCreateGroup:!1,disablePluginStore:!1,disableAddFriend:!1,announcement:!1}},518:(U,O,e)=>{"use strict";e.d(O,{AJ:()=>z,YQ:()=>Q});var o=e(76705),c=e.n(o),a=e(66659),i=e.n(a);function N(j){return typeof j=="string"&&j.length>0}function p(j){return urlRegex({exact:!0}).test(j)}const A=j=>_isString(j)&&j.startsWith("blob:"),L=j=>{var S;return(S=j.match(urlRegex()))!=null?S:[]};function C(j){return!!j&&j!=="0"&&j!=="false"}function Q(j){return typeof j=="string"&&j!==""}function z(j){return typeof j!="string"?!1:j.startsWith("localMessage_")}},58787:(U,O,e)=>{"use strict";e.d(O,{A:()=>c});var o=e(49076);function c(a){return String(a).replace("{BACKEND}",(0,o.qQ)())}},70877:(U,O,e)=>{"use strict";e.d(O,{_:()=>i,c:()=>a});var o=e(52983),c=e(54782);let a=()=>{throw new Error("route navigate not init")};const i=o.memo(()=>(a=(0,c.useNavigate)(),null));i.displayName="AppRouterApi"},67706:(U,O,e)=>{"use strict";e.d(O,{S:()=>p});var o=e(75526),c=e(52983),a=e(30831),i=e(6739);const N={error:void 0,info:{componentStack:""}};class p extends c.Component{constructor(){super(...arguments);this.state=N,this.reset=()=>{this.setState(N)}}componentDidCatch(L,C){this.setState({error:L,info:C})}render(){const{message:L,description:C,children:Q}=this.props,{error:z,info:j}=this.state,S=j&&j.componentStack?j.componentStack:null,P=typeof L=="undefined"?(z||"").toString():L,x=typeof C=="undefined"?S:C;return z?c.createElement(i.t,{text:c.createElement(c.Fragment,null,c.createElement("h3",null,(0,a.t)("\u9875\u9762\u51FA\u73B0\u4E86\u4E00\u4E9B\u95EE\u9898")),c.createElement("p",{title:x??""},P),c.createElement(o.Z,{size:"small",onClick:this.reset},(0,a.t)("\u91CD\u8BD5")))}):Q}}},80474:(U,O,e)=>{"use strict";e.d(O,{P:()=>T});var o=e(52983),c=e(2697),a=e(23463),i=e(38887),N=e(30831),p=e(170),A=e(61422),L=e.n(A),C=Object.defineProperty,Q=Object.getOwnPropertySymbols,z=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable,S=(E,m,g)=>m in E?C(E,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):E[m]=g,P=(E,m)=>{for(var g in m||(m={}))z.call(m,g)&&S(E,g,m[g]);if(Q)for(var g of Q(m))j.call(m,g)&&S(E,g,m[g]);return E};function x(E,m){const g=new Date().valueOf();return E.then(K=>{const R=new Date().valueOf();return console.debug(`[Loadable] load ${m} usage: ${R-g}ms`),K})}function h(E){const m=L()("Loadable");return p.ZP.loading({content:(0,N.t)("\u52A0\u8F7D\u4E2D..."),key:m,duration:0}),E.then(g=>(p.ZP.destroy(m),g))}function T(E,m){return(0,c.ZP)(g=>{let K=E(g);return(0,N.YQu)(m==null?void 0:m.componentName)&&(K=x(K,String(m==null?void 0:m.componentName))),(m==null?void 0:m.showLoading)===!0&&(K=h(K)),(0,a.Z)(K,200,{delayRejection:!1})},P({fallback:o.createElement(i.T,null)},m))}},38887:(U,O,e)=>{"use strict";e.d(O,{T:()=>i});var o=e(52983),c=e(30831),a=e(67434);const i=o.memo(N=>{var p;return o.createElement("div",null,o.createElement(a.$,null),(p=N.tip)!=null?p:(0,c.t)("\u52A0\u8F7D\u4E2D..."))});i.displayName="LoadingSpinner"},84208:(U,O,e)=>{"use strict";e.d(O,{AB:()=>M,Mr:()=>Oe,VW:()=>b,_5:()=>B,aW:()=>$,h7:()=>we,vR:()=>G});var o=e(52983),c=e(45563),a=e.n(c),i=e(14698),N=e.n(i),p=e(77875),A=e.n(p),L=e(69966),C=e.n(L),Q=e(76705),z=e.n(Q),j=e(71607),S=e.n(j),P=e(442),x=e(75526),h=e(75283),T=e(93540),E=e(29603),m=e(14517),g=e(89935),K=e(22398),R=e(67706),Y=e(30831),F=Object.defineProperty,J=Object.defineProperties,X=Object.getOwnPropertyDescriptors,re=Object.getOwnPropertySymbols,Ie=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable,te=(W,H,V)=>H in W?F(W,H,{enumerable:!0,configurable:!0,writable:!0,value:V}):W[H]=V,De=(W,H)=>{for(var V in H||(H={}))Ie.call(H,V)&&te(W,V,H[V]);if(re)for(var V of re(H))je.call(H,V)&&te(W,V,H[V]);return W},Ae=(W,H)=>J(W,X(H)),Le=(W,H,V)=>new Promise((ee,ue)=>{var de=le=>{try{k(V.next(le))}catch(ie){ue(ie)}},fe=le=>{try{k(V.throw(le))}catch(ie){ue(ie)}},k=le=>le.done?ee(le.value):Promise.resolve(le.value).then(de,fe);k((V=V.apply(W,H)).next())});const Je=(W,H)=>W.addEventListener("transitionend",H,!1),Pe=o.createContext({closeModal:S()}),xe=o.memo(W=>{const{visible:H,onChangeVisible:V,closable:ee=!1,maskClosable:ue=!0}=W,[de,fe]=(0,o.useState)(!0),k=(0,o.useCallback)(()=>{fe(!1)},[]),le=(0,o.useCallback)(()=>{ue!==!1&&k()},[ue,k]);return H===!1?null:o.createElement(E.Z,{in:de,classNames:"modal-anim",timeout:200,addEndListener:Je,onExited:()=>{de===!1&&a()(V)&&V(!1)},appear:!0},o.createElement("div",{className:"absolute left-0 right-0 top-0 bottom-0 bg-black bg-opacity-60 flex justify-center items-center z-10",onClick:le,"data-tc-role":"modal-mask"},o.createElement(Pe.Provider,{value:{closeModal:k}},o.createElement("div",{className:"modal-inner bg-content-light dark:bg-content-dark rounded overflow-auto relative z-10",style:{maxHeight:"80vh",maxWidth:"80vw"},onClick:K.UW,"data-tc-role":"modal"},ee===!0&&o.createElement(T.JO,{className:"absolute right-2.5 top-3.5 text-xl z-10 cursor-pointer",icon:"mdi:close",onClick:k}),o.createElement(R.S,null,W.children)))))});xe.displayName="Modal";const ve=[];function Oe(W){N()(W)&&(W=A()(ve)),typeof W=="number"&&(C()(ve,W),(0,P.i6)(W))}function we(W,H){const V=(0,P.rk)(o.createElement(xe,Ae(De({},H),{visible:!0,onChangeVisible:ee=>Le(this,null,function*(){ee===!1&&(typeof(H==null?void 0:H.onCloseModal)=="function"&&(yield H.onCloseModal()),Oe(V))})}),W));return ve.push(V),V}function B(W){var H;const V=we(o.createElement(M,{title:(H=W.title)!=null?H:(0,Y.t)("\u786E\u8BA4\u64CD\u4F5C")},o.createElement("h3",{className:"text-center pb-6"},W.content),o.createElement("div",{className:"space-x-2 text-right"},o.createElement(x.Z,{onClick:()=>{var ee;(ee=W.onCancel)==null||ee.call(W),Oe(V)}},(0,Y.t)("\u53D6\u6D88")),o.createElement(x.Z,{type:"primary",onClick:()=>{W.onConfirm(),Oe(V)}},(0,Y.t)("\u786E\u8BA4")))),{onCloseModal:W.onCancel})}function b(W){var H,V;B({onConfirm:W.onConfirm,onCancel:W.onCancel,title:(H=W.title)!=null?H:(0,Y.t)("\u786E\u8BA4\u8981\u8FDB\u884C\u8BE5\u64CD\u4F5C\u4E48?"),content:(V=W.content)!=null?V:(0,Y.t)("\u8BE5\u64CD\u4F5C\u65E0\u6CD5\u88AB\u64A4\u56DE")})}function $(W){return new Promise(H=>{b(Ae(De({},W),{onConfirm:()=>H(!0),onCancel:()=>H(!1)}))})}function G(){const{closeModal:W}=(0,o.useContext)(Pe);return{closeModal:W}}const M=o.memo(W=>{const H=(0,g.d)(),V=z()(W.title)?o.createElement(h.Z.Title,{level:4,className:"text-center mb-4"},W.title):null;return o.createElement("div",{className:(0,m.Z)("tc-modal","p-4",W.className),style:De({minWidth:H?290:420},W.style)},V,W.children)});M.displayName="ModalWrapper"},442:(U,O,e)=>{"use strict";e.d(O,{$2:()=>i,i6:()=>A,rk:()=>p});var o=e(52983),c=e(30831);const a=new c.QEo,{PortalHost:i,PortalRender:N,add:p,remove:A}=(0,c.x9K)({hostName:"default",eventEmitter:a,renderManagerView:L=>o.createElement("div",{className:"z-10"},L)})},6739:(U,O,e)=>{"use strict";e.d(O,{t:()=>N});var o=e(52983);const c="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8cGF0aCBkPSJNMjE1Ljc1MSAxMzMuOTM4TDIxNS41NzcgMTM0LjA3N0wyMTUuNDM4IDEzNC4yNTFDMjEzLjg0OCAxMzYuMjM4IDIxMS4yNSAxMzkuMDA0IDIwOC40NDggMTQxLjI1M0MyMDcuMDQ5IDE0Mi4zNzYgMjA1LjY0MiAxNDMuMzM1IDIwNC4zMiAxNDQuMDA2QzIwMi45NzcgMTQ0LjY4NyAyMDEuODU5IDE0NSAyMDEgMTQ1QzE5OC43NTcgMTQ1IDE5Ny4zNTMgMTQ0LjQ3MiAxOTYuMjgzIDE0My43MzFDMTk1LjE0IDE0Mi45MzkgMTk0LjIzOSAxNDEuODE4IDE5My4xIDE0MC4zQzE5Mi4xNDYgMTM5LjAyNyAxOTAuNDUxIDEzNy42MjcgMTg4LjUxMSAxMzYuMzAyQzE4Ni41MjIgMTM0Ljk0MyAxODQuMTA2IDEzMy41NSAxODEuNTU0IDEzMi4zMjNDMTc5LjAwNSAxMzEuMDk3IDE3Ni4yODEgMTMwLjAxNiAxNzMuNjc1IDEyOS4zMDVDMTcxLjEwMiAxMjguNjAyIDE2OC40OTIgMTI4LjIxNyAxNjYuMjM2IDEyOC41MThDMTU5LjU1OCAxMjkuNDA4IDE1NS45NTQgMTI5LjM3NiAxNTQuMDEgMTI5LjA3MkMxNTMuMDU0IDEyOC45MjMgMTUyLjU5OCAxMjguNzIxIDE1Mi4zOTkgMTI4LjYwNUMxNTIuMjQ4IDEyOC41MTcgMTUyLjIxMSAxMjguNDYxIDE1Mi4xNjYgMTI4LjM5NEwxNTIuMTY0IDEyOC4zOTFMMTUxLjg5MSAxMjcuOThMMTUxLjQ1OCAxMjcuNzQ0QzE1MS4xMjQgMTI3LjU2MiAxNTAuNjY1IDEyNy4wMzggMTUwLjMyNyAxMjUuNTdDMTUwIDEyNC4xNDkgMTQ5Ljg4NyAxMjIuMjg0IDE0OS44NSAxMjAuMDY2QzE0OS44MzYgMTE5LjI1OCAxNDkuODM0IDExOC40MDIgMTQ5LjgzMSAxMTcuNTE2QzE0OS44MjEgMTEzLjg3MyAxNDkuODA5IDEwOS43MjYgMTQ5LjAxMSAxMDYuMzA4QzE0OS4wMjUgMTA1LjY0MiAxNDguOTMgMTA0Ljc1NiAxNDguNDM2IDEwMy45OUMxNDguMTA1IDEwMy40NzcgMTQ3LjU4OSAxMDMuMDE1IDE0Ni44NzMgMTAyLjc5M0MxNDYuMTg3IDEwMi41ODEgMTQ1LjUxMyAxMDIuNjUxIDE0NC45NDIgMTAyLjgyMUMxNDMuODY0IDEwMy4xNDIgMTQyLjczMyAxMDMuOTQ1IDE0MS41MjYgMTA1LjA3QzE0MC4yNzMgMTA2LjIzNyAxMzguNzYgMTA3LjkyMyAxMzYuOTI1IDExMC4yNjdDMTI5LjU3IDExOS42NjUgMTIwLjY4OSAxMzcuMTUyIDExNy4xODggMTQ0LjY1NEwxMTcuMTMgMTQ0Ljc3N0wxMTcuMDkgMTQ0LjkwNkMxMTYuNzUgMTQ1Ljk5OCAxMTYuMzAyIDE0Ny4yODggMTE1LjggMTQ4LjcyOUMxMTQuNjkgMTUxLjkyMSAxMTMuMzIxIDE1NS44NTYgMTEyLjMwNyAxNjAuMDI4QzExMC44MTEgMTY2LjE4MiAxMDkuOTU1IDE3My4yNjggMTExLjU0OCAxODAuNDM0QzExNC4yMSAxOTIuNDE3IDEyMy4zODQgMjAzLjU4OCAxMzAuODg1IDIxMC4zMDJDMTMwLjE1OSAyMTUuMjQ1IDEyNy45MiAyMTkuNzUxIDEyNC45NzMgMjI0LjY0OUMxMjQuMTEgMjI2LjA4NCAxMjMuMTggMjI3LjU2MSAxMjIuMjE2IDIyOS4wOUMxMTkuNzMzIDIzMy4wMzQgMTE3LjAzMSAyMzcuMzI0IDExNC43MDEgMjQyLjEyN0MxMTAuNjMgMjUwLjUxNyAxMDYuNjg3IDI1OC40MzUgMTAyLjkxIDI2Ni4wMTlDOTIuMTYxNyAyODcuNjAxIDgyLjc2MSAzMDYuNDc3IDc1LjYyMzggMzI1LjgwN0M2My41Mjk1IDM1OC41NjMgNjAuNDcxMiAzOTQuMzgzIDYyLjUxNDYgNDExLjI0MUM2NC41NzE5IDQyOC4yMTQgNzUuMzQ5OCA0NTQuNDExIDEwMy4xMDYgNDY4LjI4OUMxMjQuMTEgNDc4Ljc5MSAxNDEuNjEzIDQ4MS40NzQgMTQ4Ljc0OSA0ODEuNTA4QzE1NS4zOTYgNDg3LjI0OSAxNzIuOTE4IDQ5Ny40NzUgMTk1LjkxNSA0OTcuNUMyMTAuMzE3IDQ5OC43MDkgMjI5LjQwNCA0OTMuOTE4IDIzNy4xMiA0OTEuNDAxTDIzNy4yMzQgNDkxLjM2NEwyMzcuMzQzIDQ5MS4zMTRMMzA4LjI5NyA0NTguMzM1QzMxMy45MjQgNDU2LjA1NiAzMjMuMjYyIDQ1My4xNDQgMzMyLjkzMSA0NTEuODMyQzM0Mi43MTYgNDUwLjUwNCAzNTIuMzk0IDQ1MC44NzkgMzU4Ljk5MiA0NTQuNzI4QzM2Ny45MDEgNDU5LjkyNCAzNzEuNDg5IDQ2My4yNTIgMzczLjU1OCA0NjYuMTZDMzc0LjYwNiA0NjcuNjMyIDM3NS4zMDcgNDY5LjA1NCAzNzYuMTMxIDQ3MC43NDlMMzc2LjE4MyA0NzAuODU2QzM3Ni45ODkgNDcyLjUxNiAzNzcuOTAzIDQ3NC4zOTUgMzc5LjMyMSA0NzYuNTg3QzM4Mi4yNzkgNDgxLjE1OCAzODYuNjc0IDQ4NC44MDMgMzkxLjg1OSA0ODYuMDFDMzk3LjEzNyA0ODcuMjM5IDQwMi45MTUgNDg1Ljg2NyA0MDguMzM4IDQ4MC45ODdDNDEyLjk1OSA0NzYuODI3IDQxMy44NzggNDcxLjUwOSA0MTMuMjMyIDQ2Ni43NzlDNDEyLjYxNCA0NjIuMjYgNDEwLjU2NSA0NTguMTI4IDQwOC43OTUgNDU1LjU3NkM0MDYuMjYyIDQ0OC41NDcgMzk1LjkxMiA0MzIuODcyIDM3My40MiA0MjEuMjI0QzM2MS42NjYgNDE1LjEzNyAzNDYuMDc3IDQxNC44MjYgMzMxLjY1MSA0MTYuNzNDMzE3LjE1OCA0MTguNjQyIDMwMy40NyA0MjIuODQxIDI5NS4yNTQgNDI2LjE0NEwyOTUuMTczIDQyNi4xNzdMMjk1LjA5NiA0MjYuMjE2QzI4MC45NzEgNDMzLjM3OCAyNjMuOTExIDQ0MC43MjYgMjQ4LjYzMyA0NDYuNTk2QzIzMy4zMDMgNDUyLjQ4NSAyMTkuOTQgNDU2LjgxOCAyMTMuMTQ4IDQ1OC4wMzFDMjEyLjUzNiA0NTguMTQxIDIxMS45NjMgNDU4LjI1NSAyMTEuMzk1IDQ1OC4zNjdDMjA5LjUyNSA0NTguNzM5IDIwNy43MTggNDU5LjA5OSAyMDQuNzgxIDQ1OS4yMzdDMjAxLjI3OCA0NTkuNDAyIDE5Ni4xODcgNDU5LjI0MiAxODcuNzcyIDQ1OC4zMDdDMTkwLjQwMyA0NTAuNDk0IDE5MS4zNDQgNDQwLjE0OSAxOTEuNDk4IDQzNS41ODlDMTkyLjAwMyA0MjYuNDcyIDE5MS40OTkgNDE5Ljk1NyAxOTAuNzI0IDQxNS4yMzhDMTkwLjA5NCA0MTEuNDA4IDE4OS4yOCA0MDguNzU5IDE4OC43NDQgNDA3LjAxNUMxODguNjIgNDA2LjYxMyAxODguNTExIDQwNi4yNTkgMTg4LjQyMyA0MDUuOTUxQzE4Ni41NDEgMzk5LjM2MiAxNzcuNDQyIDM2OS41MSAxNzIuNDE1IDM1NS40MTVDMTcwLjk5NiAzNDkuODU4IDE2OS4yNzYgMzQ0LjAxNyAxNjcuNDU0IDMzNy44MzFDMTYzLjYyMSAzMjQuODE4IDE1OS4zNCAzMTAuMjggMTU2LjQ3MSAyOTMuNjZDMTU1Ljk1MyAyOTAuNjYxIDE1NS40NTEgMjg3LjkwNCAxNTQuOTc4IDI4NS4zMDRDMTUyLjgwMyAyNzMuMzY1IDE1MS4yMjkgMjY0LjcyIDE1MS41IDI1MS4wNEMxNTEuNjg1IDI0MS42NyAxNTIuNDk2IDIzMi43NSAxNTMuNzM3IDIyNy40NTdDMTU0LjM1NyAyMjQuODE0IDE1NS4wMTMgMjIzLjQ3MyAxNTUuNjM4IDIyMi43MjlDMTU2LjE0OCAyMjIuMTIxIDE1Ni43NDYgMjIxLjc4MSAxNTcuNzI2IDIyMS41MDlDMTcyLjYzNSAyMjEuOTk5IDE4Ny42ODUgMjIxLjk4NiAyMDIuMiAyMTEuMUMyMDguMTY1IDIwNi42MjYgMjEyLjY3IDE5OS43NiAyMTUuODc0IDE5My4xNjFDMjE5LjA5IDE4Ni41MzcgMjIxLjA5MSAxNzkuOTgyIDIyMS45NTYgMTc1LjkxNkwyMjEuOTcxIDE3NS44NDdMMjIxLjk4MSAxNzUuNzc2QzIyMi45NzUgMTY4LjY1IDIyNSAxNTIuNDY3IDIyNSAxNDUuNUMyMjUgMTQyLjAxIDIyNC43NDQgMTM5LjUgMjI0LjQgMTM3Ljc1MUMyMjQuMjI4IDEzNi44NzggMjI0LjAyOSAxMzYuMTY2IDIyMy44MTQgMTM1LjYwNEMyMjMuNjI0IDEzNS4xMDggMjIzLjM0NyAxMzQuNTE4IDIyMi45MTQgMTM0LjA4NkMyMjEuNTk3IDEzMi43NjggMjIwLjAxNSAxMzIuNDggMjE4LjY4MSAxMzIuNjdDMjE3LjQzNSAxMzIuODQ3IDIxNi4zODUgMTMzLjQzMSAyMTUuNzUxIDEzMy45MzhaIiBmaWxsPSIjNDIzQzNDIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjQiLz4NCjxwYXRoIGQ9Ik0zOTYuMjkzIDE4OS44MjJMMzk2LjMwMSAxODkuODE2TDM5Ni4zMDkgMTg5LjgxQzQwMC44MDcgMTg2LjU1NCA0MDQuODk0IDE4Mi41ODIgNDA4LjU3NSAxNzcuOTA4QzQxMi40MTggMTczLjEzIDQxNS42MDEgMTY3LjQ1OSA0MTguMTQxIDE2MC45MjNDNDIxLjQ0MyAxNTIuNDMxIDQyMi42NDEgMTQzLjg1OSA0MjEuNzA4IDEzNS4yM0M0MjAuODY1IDEyNi42NjQgNDE4LjEyMiAxMTguNTY2IDQxMy41IDExMC45NTJDNDA4LjkxNyAxMDMuMjU3IDQwMi41OTUgOTYuMjY1IDM5NC41NzggODkuOTY2QzM4Ni42NjEgODMuNTk3MSAzNzcuMzI0IDc4LjMzNDEgMzY2LjU5MSA3NC4xNjE2QzM1OS43NjggNzEuNTA5NCAzNTIuNDAyIDY5Ljc4MjggMzQ0LjUwMyA2OC45NzFMMzQ0LjQ5NiA2OC45NzAzQzMzNi42NDQgNjguMTg5MSAzMjkuMDE4IDY4LjYzNjYgMzIxLjYyNyA3MC4zMjE1QzMxNC4yMTUgNzEuOTMxMyAzMDcuNDM0IDc0Ljk5MjQgMzAxLjI5OSA3OS40OTYyTDMwMS4yOTEgNzkuNTAyN0wzMDEuMjgyIDc5LjUwOTJDMjk1LjEyNSA4NC4xMzM2IDI5MC41MjMgOTAuNDQxNCAyODcuNDQ5IDk4LjM0ODNDMjg1LjI4NiAxMDMuOTEzIDI4NC4xNDIgMTA4Ljk3NiAyODQuMTExIDExMy41MDZMMjg0LjExMSAxMTMuNTI2TDI4NC4xMTIgMTEzLjU0N0MyODQuMTcyIDExNy45MDkgMjg0LjYyOSAxMjEuNzI5IDI4NS41MTYgMTI0Ljk3NkwyODUuNTI3IDEyNS4wMTZMMjg1LjU0IDEyNS4wNTZDMjg2LjUxOCAxMjguMTI1IDI4Ny42IDEzMC42MjYgMjg4LjgyMyAxMzIuNDdMMjg4Ljg0NSAxMzIuNTA0TDI4OC44NjggMTMyLjUzN0MyODkuNDI2IDEzMy4zMDggMjg5Ljg2NSAxMzMuOTExIDI5MC4xODUgMTM0LjM0NEMyOTAuMzcyIDEzNC41OTYgMjkwLjU1MSAxMzQuODM3IDI5MC42OTYgMTM1LjAyQzI5MS4yMTggMTM1Ljk3OCAyOTEuODU4IDEzNi44MyAyOTIuNjY3IDEzNy40NDNMMjkyLjY5NCAxMzcuNDY0TDI5Mi43MjEgMTM3LjQ4M0MyOTMuNDgxIDEzOC4wMjEgMjk0LjI5IDEzOC40NTkgMjk1LjE0NiAxMzguNzkyQzI5Ny41NzQgMTM5LjczNSAzMDAuMDExIDEzOS42MzggMzAyLjMgMTM4LjQ1NEMzMDQuNTQ4IDEzNy4zNjggMzA2LjE5MSAxMzUuNjk0IDMwNy4wNjkgMTMzLjQzNUMzMDguMzY4IDEzMC4wOTUgMzA3LjQ5OCAxMjYuNjMyIDMwNS4xODMgMTIzLjI5MkMzMDUuMDc4IDEyMy4xMDcgMzA0Ljk1NSAxMjIuOTIzIDMwNC44NzMgMTIyLjgwMUwzMDQuODYzIDEyMi43ODVDMzA0LjcwNyAxMjIuNTUzIDMwNC41IDEyMi4yNTIgMzA0LjI0MyAxMjEuODg1QzMwMy45MTkgMTIxLjIyNiAzMDMuNTc0IDEyMC4xOTYgMzAzLjI0NiAxMTguNzE1QzMwMi45NTMgMTE3LjE2MiAzMDIuODA4IDExNS4yNTcgMzAyLjgzMyAxMTIuOThDMzAyLjk3MyAxMTAuODA1IDMwMy42MDggMTA4LjE4NyAzMDQuODA5IDEwNS4wOTdDMzA2LjExNCAxMDEuNzM5IDMwOC4yMDkgOTguNzA1OCAzMTEuMTM4IDk1Ljk5NDFDMzE0LjE5OSA5My4yNzYxIDMxNy42MDcgOTEuMTI1OSAzMjEuMzcgODkuNTM4NUwzMjEuMzcxIDg5LjUzODFDMzI1LjI1MyA4Ny44OTc5IDMyOS4yOTUgODYuOTQyMSAzMzMuNTA2IDg2LjY2ODlDMzM3Ljc2MyA4Ni40MzIgMzQxLjcwMSA4Ny4wMzM0IDM0NS4zNDUgODguNDVDMzUwLjc5OSA5MC41NzA1IDM1NS41MTcgOTMuNTEzOSAzNTkuNTE4IDk3LjI3NDNMMzU5LjUyNyA5Ny4yODI1QzM2My42MjQgMTAxLjA4NiAzNjYuNzI1IDEwNS40MDMgMzY4Ljg1MiAxMTAuMjM3TDM2OC44NTcgMTEwLjI0OEwzNjguODYyIDExMC4yNTlDMzcxLjA3NiAxMTUuMTMyIDM3Mi4yNzcgMTIwLjQzNyAzNzIuNDUgMTI2LjE5NEMzNzIuNjIyIDEzMS45MDQgMzcxLjU2MyAxMzcuNzQxIDM2OS4yMzggMTQzLjcyM0MzNjYuNDkgMTUwLjc5MSAzNjMuNTY5IDE1Ni41MTcgMzYwLjQ5MiAxNjAuOTQyQzM1Ny4zODEgMTY1LjQxNSAzNTQuMTI0IDE2OS4wMzkgMzUwLjczMiAxNzEuODQ0TDM1MC43MTkgMTcxLjg1NkwzNTAuNzA1IDE3MS44NjdDMzQ3LjM2MyAxNzQuNzM0IDM0My44ODUgMTc2Ljk4OCAzNDAuMjczIDE3OC42NDdMMzQwLjI1OCAxNzguNjUzTDM0MC4yNDMgMTc4LjY2MUMzMzYuNTc1IDE4MC40MTkgMzMyLjgzNiAxODIuMSAzMjkuMDI3IDE4My43MDZDMzI1LjMwNSAxODUuMTI0IDMyMS43MDcgMTg2Ljc0NiAzMTguMjMzIDE4OC41NjlMMzE4LjIxNyAxODguNTc4TDMxOC4yMDEgMTg4LjU4N0MzMTQuNzcyIDE5MC40NyAzMTEuNTQyIDE5Mi42MzkgMzA4LjUxMiAxOTUuMDkzQzMwNS40NTMgMTk3LjU3MSAzMDIuNjc1IDIwMC40MTQgMzAwLjE3OCAyMDMuNjE3TDMwMC4xNjQgMjAzLjYzNUwzMDAuMTUgMjAzLjY1NEMyOTcuNzE1IDIwNi45MzEgMjk1LjcwNyAyMTAuNjE3IDI5NC4xMTggMjE0LjcwMkMyOTMuNjI5IDIxNS45NjIgMjkzLjI1NCAyMTcuMDU5IDI5My4wMDkgMjE3Ljk3OEMyOTIuNzg2IDIxOC44MTcgMjkyLjY1MiAyMTkuMjUgMjkyLjU5NyAyMTkuMzkyTDI5Mi41NjEgMjE5LjQ4NUwyOTIuNTM0IDIxOS41ODFDMjkxLjg4NSAyMjEuOTE2IDI5Mi4xNzMgMjI0LjIyNyAyOTMuMzE1IDIyNi40MTZMMjkzLjMzMiAyMjYuNDQ4TDI5My4zNSAyMjYuNDhDMjk0LjU2MSAyMjguNjA1IDI5Ni40MjggMjMwLjExOCAyOTguODEzIDIzMS4wNDVMMjk4LjkwNiAyMzEuMDgxTDI5OS4wMDIgMjMxLjEwOEMzMDEuMzAxIDIzMS43NDcgMzAzLjU1NiAyMzEuNTE0IDMwNS42NTggMjMwLjQwNkMzMDcuODIzIDIyOS4yNzQgMzA5LjM5NiAyMjcuNTgyIDMxMC4yNjIgMjI1LjM1NEwzMTEuNjM4IDIyMS44MTVDMzEzLjAyNiAyMTguMjQ1IDMxNC40NjQgMjE1LjU1OSAzMTUuOTIgMjEzLjY3OEMzMTcuMzYyIDIxMS44MTUgMzE5LjA2OCAyMTAuNCAzMjEuMDQyIDIwOS40MDRDMzIzLjA3MSAyMDguMzggMzI1LjU0NyAyMDcuNjE0IDMyOC41MDQgMjA3LjEzOEMzMzEuNTU2IDIwNi42NDggMzM1LjI1MyAyMDYuMTk5IDMzOS42MDQgMjA1Ljc5M0MzNDMuNjY5IDIwNS40NTcgMzQ4LjA2MSAyMDUuMDQ4IDM1Mi43ODIgMjA0LjU2NkwzNTIuNzk5IDIwNC41NjRMMzUyLjgxNiAyMDQuNTYyQzM1Ny42MjcgMjAzLjk4NiAzNjIuNDc3IDIwMy4xNzEgMzY3LjM2NSAyMDIuMTE5TDM2Ny4zOCAyMDIuMTE2TDM2Ny4zOTYgMjAyLjExM0MzNzIuMzU4IDIwMC45NjMgMzc3LjI2IDE5OS40MzMgMzgyLjEwMiAxOTcuNTIzTDM4Mi4xMDMgMTk3LjUyMkMzODcuMTI3IDE5NS41MzUgMzkxLjg1OCAxOTIuOTY4IDM5Ni4yOTMgMTg5LjgyMlpNMzAxLjExMyAyNzcuOTMyQzMwMy44OTIgMjc2LjcwOSAzMDYuMzY5IDI3NC45ODggMzA4LjUzNyAyNzIuNzgyQzMxMC44MzEgMjcwLjU3MiAzMTIuNTcgMjY3LjkzMSAzMTMuNzU1IDI2NC44ODNDMzE0LjkwOSAyNjEuOTE0IDMxNS4zOSAyNTguODM1IDMxNS4xOTEgMjU1LjY2NUMzMTUuMDgxIDI1Mi41NjUgMzE0LjM5NiAyNDkuNjUgMzEzLjEyNCAyNDYuOTRDMzExLjg2MiAyNDQuMjUzIDMxMC4xMjIgMjQxLjgzIDMwNy45MjIgMjM5LjY3MkMzMDUuNjg2IDIzNy40NzkgMzAzLjA4MSAyMzUuODA2IDMwMC4xMjUgMjM0LjY1NkMyOTcuMTY4IDIzMy41MDcgMjk0LjExNyAyMzIuOTgxIDI5MC45ODcgMjMzLjA4OEMyODcuOTA3IDIzMy4xOTMgMjg0Ljk4NyAyMzMuODA2IDI4Mi4yNDIgMjM0LjkzNUMyNzkuNDY0IDIzNi4wNzcgMjc2Ljk4MyAyMzcuNzcyIDI3NC44MDQgMjM5Ljk5NEMyNzIuNjExIDI0Mi4yMyAyNzAuOTM4IDI0NC44MzUgMjY5Ljc4OCAyNDcuNzkyQzI2OC42MDggMjUwLjgyNyAyNjguMDYyIDI1My45MjEgMjY4LjE2OSAyNTcuMDZDMjY4LjI3NSAyNjAuMTYyIDI2OC45MzkgMjYzLjExNCAyNzAuMTY2IDI2NS45MDFDMjcxLjM5MyAyNjguNjg5IDI3My4xMjEgMjcxLjE3MiAyNzUuMzM3IDI3My4zNDZDMjc3LjU3MyAyNzUuNTM4IDI4MC4xNzggMjc3LjIxMSAyODMuMTM1IDI3OC4zNjFDMjg2LjA5MSAyNzkuNTEgMjg5LjE0MiAyODAuMDM2IDI5Mi4yNzIgMjc5LjkyOUMyOTUuMzc0IDI3OS44MjMgMjk4LjMyNiAyNzkuMTU5IDMwMS4xMTMgMjc3LjkzMloiIGZpbGw9IiMyOTJBMkUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iNCIvPg0KPC9zdmc+DQo=";var a=e(30831),i=e(14517);const N=o.memo(p=>{var A;return o.createElement("div",{className:(0,i.Z)("text-center w-full",p.className),style:p.style},o.createElement("img",{className:"w-32 h-32 m-auto mb-2",src:c}),o.createElement("div",null,(A=p.text)!=null?A:(0,a.t)("\u51FA\u73B0\u4E86\u4E00\u4E9B\u95EE\u9898")))});N.displayName="Problem"},67434:(U,O,e)=>{"use strict";e.d(O,{$:()=>a});var o=e(93540),c=e(52983);const a=c.memo(()=>c.createElement(o.JO,{className:"animate-spin mr-3 inline",icon:"mdi:loading"}));a.displayName="Spinner"},50842:(U,O,e)=>{"use strict";e.d(O,{A:()=>a,b:()=>i});var o=e(52983);const c=o.createContext("");c.displayName="GroupIdContext";const a=c.Provider;function i(){return(0,o.useContext)(c)}},85478:(U,O,e)=>{"use strict";e.d(O,{D:()=>a,x:()=>c});var o=e(52983);const c=o.createContext(null);c.displayName="GroupPanelContext";function a(){return(0,o.useContext)(c)}},96857:(U,O,e)=>{"use strict";e.d(O,{Z:()=>a,i:()=>i});var o=e(52983);const c=o.createContext({});c.displayName="SocketContext";const a=o.memo(N=>o.createElement(c.Provider,{value:N.socket},N.children));a.displayName="SocketContextProvider";function i(){return(0,o.useContext)(c)}},89935:(U,O,e)=>{"use strict";e.d(O,{d:()=>i});var o=e(30831),c=e(52983);const a=(N=1/0,p=1/0)=>{const[A,L]=(0,o.j$3)({width:o.jUY?window.innerWidth:N,height:o.jUY?window.innerHeight:p});return(0,c.useEffect)(()=>{if(o.jUY){const C=()=>{L({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",C),()=>{window.removeEventListener("resize",C)}}},[]),A};function i(){const{width:N}=a();return N<768}},81070:(U,O,e)=>{"use strict";var o=e(170),c=e(18370),a=e(52983),i=e(30831),N=e(22398),p=e(87450),A=e(13546),L=e.n(A),C=e(82335),Q=e(89408),z=e(93540),j=(k,le,ie)=>new Promise((Re,Qe)=>{var Ze=ge=>{try{Se(ie.next(ge))}catch(ze){Qe(ze)}},Te=ge=>{try{Se(ie.throw(ge))}catch(ze){Qe(ze)}},Se=ge=>ge.done?Re(ge.value):Promise.resolve(ge.value).then(Ze,Te);Se((ie=ie.apply(k,le)).next())});(0,C.CN)("init"),(0,Q.S)("init"),i.yGS&&e.e(528).then(e.bind(e,7528)).then(({start:k})=>k());const S=(0,i.Kdd)(window.localStorage);(0,i.poP)(()=>S),(0,i.OvJ)(()=>j(void 0,null,function*(){return yield(0,p.pT)()}));const P=window.localStorage.getItem("serviceUrl");P?(0,i.YAW)(()=>P):(0,i.YAW)(()=>String("https://ssdcc.online:11443")),(0,i.lx9)((k,le="info")=>{o.ZP.open({type:le,duration:3,content:a.createElement("span",{"data-testid":"toast"},String(k))})}),(0,i.brB)(k=>{c.Z.confirm({content:k.message,onOk:()=>j(void 0,null,function*(){typeof k.onConfirm=="function"&&(yield k.onConfirm())}),getContainer:N.Gr})}),(0,i.I5R)(k=>o.ZP.loading(k,0)),(0,z.Yk)(i.Awg),(0,i.t4N)(()=>{(0,z.YE)({submitLabel:(0,i.t)("\u63D0\u4EA4")})});const x=(()=>{let k;return()=>{k||window.location.pathname.startsWith("/entry")||window.location.pathname.startsWith("/invite")||(console.warn("\u8D26\u53F7\u6388\u6743\u5DF2\u8FC7\u671F, 2\u79D2\u540E\u81EA\u52A8\u8DF3\u8F6C\u5230\u767B\u5F55\u9875"),(0,i.lHp)((0,i.t)("\u8D26\u53F7\u6388\u6743\u5DF2\u8FC7\u671F, 2\u79D2\u540E\u81EA\u52A8\u8DF3\u8F6C\u5230\u767B\u5F55\u9875"),"warning"),k=window.setTimeout(()=>{window.clearTimeout(k),window.location.href="/entry/login"},2e3))}})();(0,i.J7p)(k=>L()(k,"response.data.code")===401?(x(),!1):!0),(0,i.DtN)().catch(k=>{(0,i.hJM)((0,i.t)("\u5168\u5C40\u914D\u7F6E\u52A0\u8F7D\u5931\u8D25")),console.error("\u5168\u5C40\u914D\u7F6E\u52A0\u8F7D\u5931\u8D25",k)}),i.yGS===!0&&(window.DEBUG={request:i.WY0,version:i.i83,measure:C.L8});var h=e(78520),T=e(10330),E=e(54782),m=e(14517),g=e(80474),K=e(13474),R=e(94343),Y=e(38887),F=e(7975),J=e(442),X=e(30547),re=e.n(X),Ie=e(70877),je=e(98992),te=e(21940),De=e(67706),Ae=e(83824),Le=(k,le,ie)=>new Promise((Re,Qe)=>{var Ze=ge=>{try{Se(ie.next(ge))}catch(ze){Qe(ze)}},Te=ge=>{try{Se(ie.throw(ge))}catch(ze){Qe(ze)}},Se=ge=>ge.done?Re(ge.value):Promise.resolve(ge.value).then(Ze,Te);Se((ie=ie.apply(k,le)).next())});const Je=re()()?T.UT:T.VK,Pe=(0,g.P)(()=>Promise.all([e.e(850),e.e(807),e.e(175),e.e(899),e.e(260),e.e(771),e.e(258),e.e(179)]).then(e.bind(e,5995))),xe=(0,g.P)(()=>e.e(497).then(e.bind(e,84850))),ve=(0,g.P)(()=>Promise.all([e.e(850),e.e(807),e.e(771),e.e(258),e.e(212)]).then(e.bind(e,85603))),Oe=(0,g.P)(()=>e.e(152).then(e.bind(e,49002))),we=a.memo(k=>{const{value:le}=(0,i.r53)(()=>Le(void 0,null,function*(){return(0,i.G33)()==="zh-CN"?e.e(579).then(e.bind(e,42342)).then(Re=>Re.default):Ae.Z}),[]);return a.createElement(K.ZP,{getPopupContainer:N.Gr,locale:le},k.children)});we.displayName="TcAntdProvider";const B=a.memo(k=>a.createElement(a.Suspense,{fallback:a.createElement(Y.T,null)},a.createElement(Je,null,a.createElement(i.IE7,null,a.createElement(je.W,{backend:te.PD},a.createElement(we,null,k.children))))));B.displayName="AppProvider";const b=a.memo(k=>{const{isDarkMode:le,extraSchemeName:ie}=(0,i.tv4)();return a.createElement("div",{id:"tailchat-app",className:(0,m.Z)("tailchat-app","absolute inset-0 select-none overflow-hidden",{dark:le},ie),onContextMenu:N.PF},k.children)});b.displayName="AppContainer";const $=a.memo(()=>{const{language:k}=(0,i.ZKp)(),{serverName:le,serverEntryImage:ie}=(0,i.tR0)(Re=>({serverName:Re.serverName,serverEntryImage:Re.serverEntryImage}));return a.createElement(R.q,null,a.createElement("meta",{httpEquiv:"Content-Language",content:k}),a.createElement("title",null,le),ie&&a.createElement("style",{type:"text/css"},`
              #tailchat-app {
                --tc-background-image: url(${(0,i.Awg)(ie)});
              }
            `))});$.displayName="AppHeader";const G=a.memo(()=>((0,C.bw)("appRenderStart"),(0,a.useEffect)(()=>{i.Agn.emit("appLoaded")},[]),a.createElement(B,null,a.createElement($,null),a.createElement(b,null,a.createElement(Ie._,null),a.createElement(De.S,null,a.createElement(E.Routes,null,a.createElement(E.Route,{path:"/entry/*",element:a.createElement(J.$2,null,a.createElement(xe,null))}),a.createElement(E.Route,{path:"/main/*",element:a.createElement(Pe,null)}),a.createElement(E.Route,{path:"/panel/*",element:a.createElement(ve,null)}),a.createElement(E.Route,{path:"/invite/:inviteCode",element:a.createElement(Oe,null)}),a.createElement(E.Route,{path:"/plugin/*",element:a.createElement(J.$2,null,a.createElement(E.Routes,null,F.pluginRootRoute.map((k,le)=>{var ie;return a.createElement(E.Route,{key:k.name,path:(ie=k.path)!=null?ie:`/fallback${le}`,element:a.createElement(k.component)})})))}),a.createElement(E.Route,{path:"/*",element:a.createElement(E.Navigate,{to:"/entry",replace:!0})})))))));G.displayName="App";var M=e(45165),W=e(99631),H=(k,le,ie)=>new Promise((Re,Qe)=>{var Ze=ge=>{try{Se(ie.next(ge))}catch(ze){Qe(ze)}},Te=ge=>{try{Se(ie.throw(ge))}catch(ze){Qe(ze)}},Se=ge=>ge.done?Re(ge.value):Promise.resolve(ge.value).then(Ze,Te);Se((ie=ie.apply(k,le)).next())});function V(){return H(this,null,function*(){ee(),ue(),yield W.E.initPlugins()})}function ee(){(0,M.vf)("react",()=>Promise.resolve().then(e.t.bind(e,52983,19))),(0,M.vf)("react-router",()=>Promise.resolve().then(e.bind(e,54782))),(0,M.vf)("axios",()=>Promise.resolve().then(e.t.bind(e,95326,23))),(0,M.vf)("styled-components",()=>Promise.all([e.e(899),e.e(236)]).then(e.bind(e,56899))),(0,M.vf)("zustand",()=>Promise.resolve().then(e.bind(e,36350))),(0,M.vf)("zustand/middleware/immer",()=>e.e(748).then(e.bind(e,50748)))}function ue(){(0,M.h7)("@capital/common",()=>Promise.resolve().then(e.bind(e,7975))),(0,M.h7)("@capital/component",()=>Promise.all([e.e(850),e.e(175),e.e(771),e.e(329)]).then(e.bind(e,84165)))}var de=e(77569),fe=e(10430);(0,de.Fv)(),(0,C.CN)("initPluginsStart"),V().then(()=>{(0,C.CN)("initPluginsEnd"),(0,Q.S)("loaded"),(0,h.s)(document.querySelector("#app")).render(a.createElement(a.StrictMode,null,a.createElement(G,null)))}).catch(()=>{(0,i.hJM)((0,i.t)("MiniStar \u5E94\u7528\u521D\u59CB\u5316\u5931\u8D25"))})},72824:(U,O,e)=>{"use strict";e.d(O,{Y:()=>i});var o=e(6494),c=e.n(o);const a=["nightly.paw.msgbyte.com"].includes(location.host),i=c()([{label:"Web Panel Plugin","label.zh-CN":"\u7F51\u9875\u9762\u677F\u63D2\u4EF6",name:"com.msgbyte.webview",url:"/plugins/com.msgbyte.webview/index.js",version:"0.0.0",author:"msgbyte",description:"Provides groups with the ability to create web panels","description.zh-CN":"\u4E3A\u7FA4\u7EC4\u63D0\u4F9B\u521B\u5EFA\u7F51\u9875\u9762\u677F\u7684\u529F\u80FD",documentUrl:"/plugins/com.msgbyte.webview/README.md",requireRestart:!1},{label:"BBCode Mmessage Interpreter","label.zh-CN":"BBCode \u6D88\u606F\u89E3\u91CA\u5668",name:"com.msgbyte.bbcode",url:"/plugins/com.msgbyte.bbcode/index.js",version:"0.0.0",author:"msgbyte",description:"A plugin for supporting bbcode syntax to interpret rich text messages","description.zh-CN":"\u4E00\u4E2A\u7528\u4E8E\u652F\u6301bbcode\u8BED\u6CD5\u89E3\u91CA\u5BCC\u6587\u672C\u6D88\u606F\u7684\u63D2\u4EF6",requireRestart:!0},{label:"Message notification plugin","label.zh-CN":"\u6D88\u606F\u901A\u77E5\u63D2\u4EF6",name:"com.msgbyte.notify",url:"/plugins/com.msgbyte.notify/index.js",version:"0.0.0",author:"msgbyte",description:"Ability to add notifications to apps","description.zh-CN":"\u4E3A\u5E94\u7528\u589E\u52A0\u901A\u77E5\u7684\u80FD\u529B",requireRestart:!0},{label:"Intro plugin","label.zh-CN":"\u521D\u59CB\u5F15\u5BFC\u63D2\u4EF6",name:"com.msgbyte.intro",url:"/plugins/com.msgbyte.intro/index.js",version:"0.0.0",author:"msgbyte",description:"Turn on the ability to introduce the app for the first time for the app","description.zh-CN":"\u4E3A\u5E94\u7528\u9996\u6B21\u6253\u5F00\u4ECB\u7ECD\u5E94\u7528\u7684\u80FD\u529B",requireRestart:!0},{label:"Markdown Panel","label.zh-CN":"Markdown \u9762\u677F",name:"com.msgbyte.mdpanel",url:"/plugins/com.msgbyte.mdpanel/index.js",version:"0.0.0",author:"moonrailgun",description:"Add markdown panel support","description.zh-CN":"\u589E\u52A0 Markdown \u9762\u677F\u652F\u6301",requireRestart:!0},{label:"Identity and Access Management","label.zh-CN":"IAM \u63D2\u4EF6",name:"com.msgbyte.iam",url:"{BACKEND}/plugins/com.msgbyte.iam/index.js",documentUrl:"https://tailchat.msgbyte.com/docs/advanced-usage/plugins/com.msgbyte.iam",version:"0.0.0",author:"moonrailgun",description:"Provide Tailchat with the function of conveniently accessing external account systems","description.zh-CN":"\u4E3ATailchat\u63D0\u4F9B\u65B9\u4FBF\u7684\u63A5\u5165\u5916\u90E8\u8D26\u6237\u7CFB\u7EDF\u7684\u529F\u80FD",requireRestart:!0},{label:"Offline Icons","label.zh-CN":"\u79BB\u7EBF\u56FE\u6807",name:"com.msgbyte.offline-icons",url:"/plugins/com.msgbyte.offline-icons/index.js",version:"0.0.0",author:"moonrailgun",description:"Add prefetched icons which need run in intranet environment","description.zh-CN":"\u589E\u52A0\u9884\u83B7\u53D6\u7684\u56FE\u6807\uFF0C\u9002\u7528\u4E8E\u5185\u7F51\u73AF\u5883",requireRestart:!0},{label:"Discover","label.zh-CN":"\u53D1\u73B0\u7FA4\u7EC4",name:"com.msgbyte.discover",url:"{BACKEND}/plugins/com.msgbyte.discover/index.js",version:"0.0.0",author:"moonrailgun",description:"Add Discover panel which can help user found groups","description.zh-CN":"\u589E\u52A0\u4E00\u4E2A\u53D1\u73B0\u9762\u677F\uFF0C\u7528\u4E8E\u63A2\u7D22\u516C\u5F00\u7684\u7FA4\u7EC4",requireRestart:!0},{label:"Agora","label.zh-CN":"\u58F0\u7F51\u97F3\u89C6\u9891",name:"com.msgbyte.agora",url:"{BACKEND}/plugins/com.msgbyte.agora/index.js",icon:"{BACKEND}/plugins/com.msgbyte.agora/assets/icon.png",version:"0.0.0",author:"moonrailgun",description:"Add the Agora audio and video communication feature to Tailchat","description.zh-CN":"\u4E3ATailchat\u589E\u52A0\u58F0\u7F51\u97F3\u89C6\u9891\u901A\u4FE1\u529F\u80FD",requireRestart:!1},{label:"SSDC\u89C6\u9891\u6D88\u606F\u652F\u6301\u63D2\u4EF6",name:"cn.ssdcc.tailchat.video",url:"https://ssdcc.github.io/tailchat-plugin/dist/plugins/cn.ssdcc.tailchat.video/index.js",version:"0.0.0",author:"ssdcc",description:"\u63D0\u4F9B\u89C6\u9891\u6D88\u606F\u80FD\u529B",requireRestart:!0},a&&{label:"Posthog",name:"com.msgbyte.posthog",url:"/plugins/com.msgbyte.posthog/index.js",icon:"/plugins/com.msgbyte.posthog/assets/icon.png",version:"0.0.0",author:"moonrailgun",description:"Posthog Statistics","description.zh-CN":"Posthog \u6570\u636E\u7EDF\u8BA1",requireRestart:!0},a&&{label:"Sentry",name:"com.msgbyte.sentry",url:"/plugins/com.msgbyte.sentry/index.js",icon:"/plugins/com.msgbyte.sentry/assets/icon.png",version:"0.0.0",author:"moonrailgun",description:"Sentry error handling","description.zh-CN":"Sentry \u9519\u8BEF\u5904\u7406",requireRestart:!0},a&&{label:"User Location","label.zh-CN":"\u7528\u6237\u5730\u7406\u4F4D\u7F6E",name:"com.msgbyte.user.location",url:"/plugins/com.msgbyte.user.location/index.js",version:"0.0.0",author:"moonrailgun",description:"Add geographic location records for user information","description.zh-CN":"\u4E3A\u7528\u6237\u4FE1\u606F\u589E\u52A0\u5730\u7406\u4F4D\u7F6E\u8BB0\u5F55",requireRestart:!0},a&&{label:"AI Assistant",name:"com.msgbyte.ai-assistant",url:"/plugins/com.msgbyte.ai-assistant/index.js",icon:"/plugins/com.msgbyte.ai-assistant/assets/icon.png",version:"0.0.0",author:"moonrailgun",description:"Add chatgpt into Tailchat",requireRestart:!0}])},7975:(U,O,e)=>{"use strict";e.r(O),e.d(O,{Loadable:()=>Se.P,ModalWrapper:()=>Te.AB,appendUrlSearch:()=>nt.no,closeModal:()=>Te.Mr,createFastFormSchema:()=>rt._D,createPluginRequest:()=>Mt,dataUrlToFile:()=>xt.Bo,fetchAvailableServices:()=>a.Y4U,fieldSchema:()=>rt._6,getCachedBaseGroupInfo:()=>a.D6C,getCachedConverseInfo:()=>a.r5V,getCachedUserInfo:()=>a.pGV,getCachedUserSettings:()=>a.U$y,getGlobalState:()=>ze.MO,getJWTUserInfo:()=>_e.Yt,getLanguage:()=>a.G33,getMessageRender:()=>h,getMessageTextDecorators:()=>K,getServiceUrl:()=>a.qQ$,getServiceWorkerRegistration:()=>Ut.Op,getTextColorHex:()=>rt.Yy,isDevelopment:()=>a.yGS,isValidStr:()=>a.YQu,joinArray:()=>a.Mo8,localTrans:()=>a.YtP,loginWithToken:()=>a.ouS,messageInterpreter:()=>P,navigate:()=>ft.c,openConfirmModal:()=>Te._5,openModal:()=>Te.h7,openReconfirmModal:()=>Te.VW,parseUrlStr:()=>a.Awg,pluginCardItemMap:()=>ee,pluginChatInputActions:()=>R,pluginChatInputButtons:()=>F,pluginColorScheme:()=>X,pluginCustomPanel:()=>Q,pluginGroupConfigItems:()=>de,pluginGroupPanel:()=>j,pluginGroupPanelBadges:()=>Oe,pluginGroupTextPanelExtraMenus:()=>B,pluginInboxItemMap:()=>H,pluginInspectServices:()=>Ie,pluginLoginAction:()=>k,pluginMessageExtraParsers:()=>te,pluginPanelActions:()=>Je,pluginPermission:()=>xe,pluginRootRoute:()=>Ae,pluginSettings:()=>M,pluginUserExtraInfo:()=>$,postMessageEvent:()=>Et.S,postRequest:()=>Rt,regChatInputAction:()=>Y,regChatInputButton:()=>J,regCustomPanel:()=>z,regGroupPanel:()=>S,regGroupPanelBadge:()=>we,regInspectService:()=>je,regLoginAction:()=>le,regMessageExtraParser:()=>De,regMessageInterpreter:()=>x,regMessageRender:()=>T,regMessageTextDecorators:()=>g,regPluginCardItem:()=>ue,regPluginColorScheme:()=>re,regPluginGroupConfigItem:()=>fe,regPluginGroupTextPanelExtraMenu:()=>b,regPluginInboxItemMap:()=>V,regPluginPanelAction:()=>Pe,regPluginPermission:()=>ve,regPluginRootRoute:()=>Le,regPluginSettings:()=>W,regSocketEventListener:()=>a.Kr1,regUserExtraInfo:()=>G,sendMessage:()=>a.bG5,setUserJWT:()=>_e._H,sharedEvent:()=>a.Agn,showErrorToasts:()=>a.hJM,showMessageTime:()=>a.omK,showSuccessToasts:()=>a.jiy,showToasts:()=>a.lHp,uploadFile:()=>a.cTq,urlSearchParse:()=>nt.qp,urlSearchStringify:()=>nt.a,useAsync:()=>a.r53,useAsyncFn:()=>a.ilX,useAsyncRefresh:()=>a.IxN,useAsyncRequest:()=>a.CoE,useConverseMessageContext:()=>a.FNv,useCurrentUserInfo:()=>Ft,useEvent:()=>a.zX9,useGlobalSocketEvent:()=>ze.s0,useGroupIdContext:()=>ie.b,useGroupPanelContext:()=>Re.D,useGroupPanelInfo:()=>a.wY6,useGroupPanelParams:()=>Ze.PO,useIsMobile:()=>ge.d,useLocation:()=>ht.useLocation,useModalContext:()=>Te.vR,useNavigate:()=>ht.useNavigate,useSocketContext:()=>Qe.i,useUpdateRef:()=>a.ysv,useWatch:()=>a.qoQ});var o=e(49335),c=e.n(o),a=e(30831),i=Object.defineProperty,N=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,L=(ae,pe,Ne)=>pe in ae?i(ae,pe,{enumerable:!0,configurable:!0,writable:!0,value:Ne}):ae[pe]=Ne,C=(ae,pe)=>{for(var Ne in pe||(pe={}))p.call(pe,Ne)&&L(ae,Ne,pe[Ne]);if(N)for(var Ne of N(pe))A.call(pe,Ne)&&L(ae,Ne,pe[Ne]);return ae};const[Q,z]=(0,a._CB)(),[j,S]=(0,a._CB)(),[P,x]=(0,a._CB)(),[h,T]=(0,a.Ntz)("message-render",ae=>ae),E={url:(ae,pe)=>ae,image:(ae,pe)=>ae,card:(ae,pe)=>ae,mention:(ae,pe)=>`@${pe}`,emoji:ae=>ae,serialize:ae=>ae},[m,g]=(0,a.Ntz)("message-text-decorators",()=>E);function K(){return C(C({},E),m())}const[R,Y]=(0,a._CB)(),[F,J]=(0,a._CB)(),[X,re]=(0,a._CB)(),[Ie,je]=(0,a._CB)(),[te,De]=(0,a._CB)(),[Ae,Le]=(0,a._CB)(),[Je,Pe]=(0,a._CB)(),[xe,ve]=(0,a._CB)(),[Oe,we]=(0,a._CB)(),[B,b]=(0,a._CB)(),[$,G]=(0,a._CB)(),[M,W]=(0,a._CB)(),[H,V]=(0,a.D3K)(),[ee,ue]=(0,a.D3K)(),[de,fe]=(0,a._CB)(),[k,le]=(0,a._CB)();var ie=e(50842),Re=e(85478),Qe=e(96857),Ze=e(22215),Te=e(84208),Se=e(80474),ge=e(89935),ze=e(5198),_e=e(87450),xt=e(74774),nt=e(72297),Ut=e(77569),Et=e(89408),ft=e(70877),ht=e(54782),rt=e(93540);function Ft(){const ae=(0,a.Pc$)();return c()(ae,["email","nickname","discriminator","avatar"])}function ot(ae){if(!!ae)return c()(ae,["transformRequest","transformResponse","headers","params","data","timeout","withCredentials","xsrfCookieName","xsrfHeaderName"])}function Mt(ae){return{get(pe,Ne){return a.WY0.get(`/api/plugin:${ae}/${pe.replace(/\./g,"/")}`,ot(Ne))},post(pe,Ne,lt){return a.WY0.post(`/api/plugin:${ae}/${pe.replace(/\./g,"/")}`,Ne,ot(lt))}}}function Rt(ae,pe,Ne){return a.WY0.post(`/api${ae}`,pe,ot(Ne))}},99631:(U,O,e)=>{"use strict";e.d(O,{E:()=>K});var o=e(30831),c=e(45165),a=e(47020),i=e.n(a),N=e(72824),p=e(43991),A=e(52983);function L(R){p.Z.warn({message:A.createElement("div",null,A.createElement("p",null,(0,o.t)("\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"),":"),R.map(Y=>A.createElement("p",{key:Y},"- ",Y))),duration:2})}function C(R,Y){window.tailchat||(window.tailchat={}),window.tailchat[R]=Y}var Q=e(3010),z=e.n(Q),j=Object.defineProperty,S=Object.getOwnPropertySymbols,P=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,h=(R,Y,F)=>Y in R?j(R,Y,{enumerable:!0,configurable:!0,writable:!0,value:F}):R[Y]=F,T=(R,Y)=>{for(var F in Y||(Y={}))P.call(Y,F)&&h(R,F,Y[F]);if(S)for(var F of S(Y))x.call(Y,F)&&h(R,F,Y[F]);return R},E=(R,Y,F)=>new Promise((J,X)=>{var re=te=>{try{je(F.next(te))}catch(De){X(De)}},Ie=te=>{try{je(F.throw(te))}catch(De){X(De)}},je=te=>te.done?J(te.value):Promise.resolve(te.value).then(re,Ie);je((F=F.apply(R,Y)).next())});const m=class{constructor(){this.initPlugins=i()(()=>E(this,null,function*(){const Y=z()([...N.Y,...yield this.getInstalledPlugins()],"name").map(({name:J,url:X})=>({name:J,url:(0,o.Awg)(X)})),F=new Set;yield(0,c.FV)({plugins:Y,onPluginLoadError:J=>{console.error("Plugin load error:",J),F.add(J.pluginName)}}),F.size>0&&L(Array.from(F))})),this.getRegistryPlugins=i()(()=>E(this,null,function*(){const R=yield(0,o.Mlq)();return this.updatePluginsInfo(R),R}))}getInstalledPlugins(){return E(this,null,function*(){return yield(0,o.cF2)().get(m.STORE_KEY,[])})}updatePluginsInfo(R){return E(this,null,function*(){const Y=yield this.getInstalledPlugins();yield this.saveInstalledPlugins(Y.map(F=>{const J=R.find(X=>X.name===F.name);return J?T(T({},F),J):F}))})}installPlugin(R){return E(this,null,function*(){const Y=yield this.getInstalledPlugins(),F=Y.findIndex(J=>J.name===R.name);F>=0?Y[F]=R:Y.push(R),yield this.saveInstalledPlugins(Y),yield(0,c.dZ)({name:R.name,url:R.url})})}uninstallPlugin(R){return E(this,null,function*(){const Y=yield(0,o.cF2)().get(m.STORE_KEY),F=Y.findIndex(J=>J.name===R);F>=0&&(Y.splice(F,1),yield this.saveInstalledPlugins(Y))})}saveInstalledPlugins(R){return E(this,null,function*(){yield(0,o.cF2)().save(m.STORE_KEY,R)})}};let g=m;g.STORE_KEY="$TailchatInstalledPlugins";const K=new g;C("installPlugin",K.installPlugin.bind(K))},22215:(U,O,e)=>{"use strict";e.d(O,{PO:()=>L,Sp:()=>C,rF:()=>Q});var o=e(7975),c=e(89889),a=e(52983),i=e(54782),N=e(93540),p=e(30831),A=e(52486);function L(){const{groupId:z="",panelId:j=""}=(0,i.useParams)();return{groupId:z,panelId:j}}function C(z){const j=(0,a.useMemo)(()=>{var S,P;return z.type===p.Xpe.TEXT?o.pluginGroupTextPanelExtraMenus:(0,p.YQu)(z.pluginPanelName)?(P=(S=(0,c.S)(z.pluginPanelName))==null?void 0:S.menus)!=null?P:[]:[]},[z.type,z.pluginPanelName]);return Array.isArray(j)&&j.length>0?[{type:"divider"},...j.map(S=>({key:S.name,label:S.label,icon:S.icon?a.createElement(N.JO,{icon:S.icon}):void 0,onClick:()=>S.onClick(z)}))]:[]}function Q(z,j,S){const P=(0,A.Z)();return(0,p.JtK)("groupPanelBadgeUpdate",()=>{P()}),o.pluginGroupPanelBadges.filter(h=>h.panelType===S).map(h=>{const T=h.render;return a.createElement(a.Fragment,{key:j+h.name},a.createElement(T,{groupId:z,panelId:j}))})}},22398:(U,O,e)=>{"use strict";e.d(O,{Gr:()=>o,PF:()=>a,SQ:()=>N,UW:()=>c,g$:()=>i});function o(){const p=document.querySelector("#tailchat-app");return p||document.body}function c(p){p.stopPropagation()}function a(p){p.preventDefault()}function i(p){const A=[];let L=p.parentElement;for(;L;)A.unshift(L),L=L.parentElement;return A}function N(p){let A=!1;const L=(...C)=>{A!==!1&&(p(...C),requestAnimationFrame(()=>{L(...C)}))};return{start:(...C)=>{A=!0,L(...C)},end:()=>{requestAnimationFrame(()=>{A=!1})}}}},89408:(U,O,e)=>{"use strict";e.d(O,{S:()=>o});function o(c,a){window.postMessage({_isTailchat:!0,type:c,payload:a},"*")}},74774:(U,O,e)=>{"use strict";e.d(O,{Bo:()=>p,DQ:()=>P,Fy:()=>N,GR:()=>z,NV:()=>Q,ZB:()=>S,hv:()=>x});var o=e(13546),c=e.n(o),a=e(30831),i=(h,T,E)=>new Promise((m,g)=>{var K=F=>{try{Y(E.next(F))}catch(J){g(J)}},R=F=>{try{Y(E.throw(F))}catch(J){g(J)}},Y=F=>F.done?m(F.value):Promise.resolve(F.value).then(K,R);Y((E=E.apply(h,T)).next())});function N(h){return new Promise((T,E)=>{const m=new FileReader;m.addEventListener("load",()=>{var g;return T(String((g=m.result)!=null?g:""))}),m.addEventListener("error",()=>E(m.error)),m.readAsDataURL(h)})}function p(h,T="file"){const E=h.split(","),m=c()(E[0].match(/:(.*?);/),[1]),g=atob(E[1]);let K=g.length;const R=new Uint8Array(K);for(;K--;)R[K]=g.charCodeAt(K);return new File([R],T,{type:m})}function A(h){return new Promise((T,E)=>{const m=new FileReader;m.addEventListener("load",()=>{var g;return T(String((g=m.result)!=null?g:""))}),m.addEventListener("error",()=>E(m.error)),m.readAsText(h)})}function L(h){return new Promise((T,E)=>{const m=new XMLHttpRequest;m.responseType="blob",m.onload=()=>{T(m.response)},m.onerror=()=>{E(m.responseText)},m.open("get",h),m.send()})}function C(h,T){return new File([h],T,{lastModified:new Date().valueOf(),type:h.type})}function Q(h,T="image.jpg"){return i(this,null,function*(){const E=yield L(h);return C(E,T)})}function z(h,T){const E=document.createElement("a");E.href=(0,a.Awg)(h),E.download=T,E.target="_blank",E.click()}function j(h,T){const E=String(URL.createObjectURL(h));z(E,T),URL.revokeObjectURL(E)}function S(h){return i(this,null,function*(){return new Promise(T=>{const E=document.createElement("input");E.setAttribute("type","file"),typeof(h==null?void 0:h.accept)=="string"&&(E.accept=h.accept),E.addEventListener("change",function(m){const g=c()(this,["files",0],null);T(g),E.remove()}),E.click()})})}const P=h=>h.type==="image/gif";function x(h,T){return i(this,null,function*(){const{default:E}=yield e.e(538).then(e.t.bind(e,17538,23));return new Promise((m,g)=>{var K,R,Y;new E(h,{quality:(K=T==null?void 0:T.quality)!=null?K:.6,maxWidth:(R=T==null?void 0:T.maxWidth)!=null?R:1920,maxHeight:(Y=T==null?void 0:T.maxHeight)!=null?Y:1080,success(F){m(F)},error(F){g(F)}})})})}},5198:(U,O,e)=>{"use strict";e.d(O,{Kj:()=>L,MO:()=>p,_3:()=>N,s0:()=>Q});var o=e(52983),c=e(30831),a=(j,S,P)=>new Promise((x,h)=>{var T=g=>{try{m(P.next(g))}catch(K){h(K)}},E=g=>{try{m(P.throw(g))}catch(K){h(K)}},m=g=>g.done?x(g.value):Promise.resolve(g.value).then(T,E);m((P=P.apply(j,S)).next())});let i;function N(j){i=j}function p(){return i?i.getState():null}let A;function L(j){A=j}function C(){return A||null}function Q(j,S){const P=(0,c.zX9)(S);(0,o.useEffect)(()=>(A&&A.listen(j,P),()=>{A&&A.removeListener(j,P)}),[])}function z(j,S){return a(this,null,function*(){if(!A)throw new Error("socket not inited");return yield A.request(j,S)})}},87450:(U,O,e)=>{"use strict";e.d(O,{Yt:()=>j,_H:()=>Q,pT:()=>z});var o=e(93702),c=e.n(o),a=e(7534),i=e.n(a),N=e(61006),p=e(30831),A=(S,P,x)=>new Promise((h,T)=>{var E=K=>{try{g(x.next(K))}catch(R){T(R)}},m=K=>{try{g(x.throw(K))}catch(R){T(R)}},g=K=>K.done?h(K.value):Promise.resolve(K.value).then(E,m);g((x=x.apply(S,P)).next())});function L(S){try{return(0,N.Z)(S)}catch(P){console.error(`getJWTInfo Error: [jwt: ${S}]`,P)}return{}}let C=null;function Q(S){return A(this,null,function*(){C=S,yield(0,p.cF2)().save("jsonwebtoken",S),(0,p.csP)()})}function z(){return A(this,null,function*(){if(i()(C)){const S=yield(0,p.cF2)().get("jsonwebtoken");return C=S,S}return C})}function j(){return A(this,null,function*(){try{const S=yield z(),P=L(S);if(c()(P))return P}catch(S){console.error("getJWTInfo Error:",S)}return{}})}},82335:(U,O,e)=>{"use strict";e.d(O,{CN:()=>j,L8:()=>P,bw:()=>S});var o=e(52983),c=e(84184),a=Object.defineProperty,i=Object.getOwnPropertySymbols,N=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,A=(x,h,T)=>h in x?a(x,h,{enumerable:!0,configurable:!0,writable:!0,value:T}):x[h]=T,L=(x,h)=>{for(var T in h||(h={}))N.call(h,T)&&A(x,T,h[T]);if(i)for(var T of i(h))p.call(h,T)&&A(x,T,h[T]);return x};const C={},Q={},z=x=>{Q[x.name]||(Q[x.name]=x.value)};(0,c.mw)(z),(0,c.a4)(z),(0,c.Fu)(z),(0,c.Yn)(z),(0,c.NO)(z),(0,c.mr)(z);function j(x){C[x]||(performance.mark(`tailchat:${x}`),C[x]=performance.now())}function S(x){(0,o.useLayoutEffect)(()=>{j(x)},[]),(0,o.useEffect)(()=>{j(x+"Mounted")},[])}const P={getVitals:()=>L({},Q),getRecord:()=>L({},C),getTimeUsage(){let x=performance.timing;const h={dnsUsage:x.domainLookupEnd-x.domainLookupStart,tcpUsage:x.connectEnd-x.connectStart,requestUsage:x.responseEnd-x.responseStart,parseDOMUsage:x.domComplete-x.domInteractive,firstPaintTime:x.responseStart-x.navigationStart,domReadyTime:x.domContentLoadedEventEnd-x.navigationStart,onloadTime:x.loadEventEnd-x.navigationStart};return(x=performance.memory)&&(h.jsHeapRatio=x.usedJSHeapSize/x.totalJSHeapSize),h}}},89889:(U,O,e)=>{"use strict";e.d(O,{S:()=>c,g:()=>a});var o=e(7975);function c(i){return o.pluginGroupPanel.find(N=>N.name===i)}function a(i){if(typeof i!="string")throw new Error("Plugin Name must be string");return i.startsWith("plugin:")?i:`plugin:${i}`}},77569:(U,O,e)=>{"use strict";e.d(O,{Wc:()=>h,Op:()=>P,Fv:()=>S,ud:()=>x});var o=e(43991),c=e(52983),a=e(47020),i=e.n(a),N=e(30831),p=e(58761),A=e(75526);const L=c.memo(()=>c.createElement(p.Z,null,c.createElement(A.Z,{type:"primary",size:"small",onClick:()=>window.location.reload()},(0,N.t)("\u7ACB\u5373\u5237\u65B0"))));L.displayName="UpdateNotificationBtn";const C=i()(()=>{setTimeout(()=>{o.Z.open({message:(0,N.t)("\u66F4\u65B0\u7248\u672C"),description:(0,N.t)("\u68C0\u6D4B\u5230\u6709\u65B0\u7248\u672C, \u662F\u5426\u7ACB\u5373\u5237\u65B0\u4EE5\u5347\u7EA7\u5230\u6700\u65B0\u5185\u5BB9"),duration:0,btn:c.createElement(L)})},2e3)});let Q=null,z;function j(T){if(console.log("registered",T),T.waiting){console.log("updated",T),C();return}T.onupdatefound=()=>{console.log("updatefound",T);const E=T.installing;E!==null&&(E.onstatechange=()=>{E.state==="installed"&&(navigator.serviceWorker.controller?(console.log("updated",T),C()):console.log("cached",T))})}}function S(){"serviceWorker"in navigator&&(window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(T=>{console.log("SW registered: ",T),Q=T,j(T)}).catch(T=>{console.log("SW registration failed: ",T)})}),window.addEventListener("beforeinstallprompt",T=>{z=T}))}function P(){return Q}function x(){if(!z){(0,N.hJM)((0,N.t)("\u65E0\u6CD5\u5B89\u88C5"));return}z.prompt()}function h(){return!!z}},72297:(U,O,e)=>{"use strict";e.d(O,{W8:()=>C,a:()=>o.stringify,no:()=>Q,po:()=>z,qp:()=>o.parse});var o=e(46163),c=e.n(o),a=Object.defineProperty,i=Object.getOwnPropertySymbols,N=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,A=(j,S,P)=>S in j?a(j,S,{enumerable:!0,configurable:!0,writable:!0,value:P}):j[S]=P,L=(j,S)=>{for(var P in S||(S={}))N.call(S,P)&&A(j,P,S[P]);if(i)for(var P of i(S))p.call(S,P)&&A(j,P,S[P]);return j};function C(j){return new URL(j,location.href).href}function Q(j){return(0,o.stringify)(L(L({},(0,o.parse)(window.location.search,{ignoreQueryPrefix:!0})),j),{skipNulls:!0})}function z(j){return`${location.origin}/invite/${j}`}},65710:()=>{}},sr={};function _(U){var O=sr[U];if(O!==void 0)return O.exports;var e=sr[U]={id:U,loaded:!1,exports:{}};return or[U].call(e.exports,e,e.exports,_),e.loaded=!0,e.exports}_.m=or,(()=>{var U=[];_.O=(O,e,o,c)=>{if(e){c=c||0;for(var a=U.length;a>0&&U[a-1][2]>c;a--)U[a]=U[a-1];U[a]=[e,o,c];return}for(var i=1/0,a=0;a<U.length;a++){for(var[e,o,c]=U[a],N=!0,p=0;p<e.length;p++)(c&!1||i>=c)&&Object.keys(_.O).every(j=>_.O[j](e[p]))?e.splice(p--,1):(N=!1,c<i&&(i=c));if(N){U.splice(a--,1);var A=o();A!==void 0&&(O=A)}}return O}})(),(()=>{_.n=U=>{var O=U&&U.__esModule?()=>U.default:()=>U;return _.d(O,{a:O}),O}})(),(()=>{var U=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,O;_.t=function(e,o){if(o&1&&(e=this(e)),o&8||typeof e=="object"&&e&&(o&4&&e.__esModule||o&16&&typeof e.then=="function"))return e;var c=Object.create(null);_.r(c);var a={};O=O||[null,U({}),U([]),U(U)];for(var i=o&2&&e;typeof i=="object"&&!~O.indexOf(i);i=U(i))Object.getOwnPropertyNames(i).forEach(N=>a[N]=()=>e[N]);return a.default=()=>e,_.d(c,a),c}})(),(()=>{_.d=(U,O)=>{for(var e in O)_.o(O,e)&&!_.o(U,e)&&Object.defineProperty(U,e,{enumerable:!0,get:O[e]})}})(),(()=>{_.f={},_.e=U=>Promise.all(Object.keys(_.f).reduce((O,e)=>(_.f[e](U,O),O),[]))})(),(()=>{_.u=U=>""+({"152":"invite","179":"main","497":"entry"}[U]||U)+"."+{"20":"74346ca71ba5832bd3d9","151":"00a06c97436c92c965b5","152":"04eaaafc1cf7ac90cc3b","175":"eaf772e7b99557f6ddc3","179":"d42970b14d3f5f159f3e","212":"32fd097e1d8af293b21c","236":"a3f78a40f5f37656199d","258":"4c8aecd3aa182657a554","260":"7a384533a437d5ddf40e","329":"1564b17f476656c4c267","497":"d08b989011c455bcc8b9","528":"ac69d20cfc6300fc3c90","538":"65d05a13d61982b8ebaa","579":"de13c3c70ec5c6b7f4ce","594":"9bf4d7b82c9395bd0502","748":"6839dd2a2eb17f25b799","771":"126c1297dea7de76e8c3","807":"a290cb7950a0ef3a8c7d","850":"ae765bf8777e89eb5366","882":"125b6e770d4a83badb62","899":"02afbb5c04045b9649aa"}[U]+".js"})(),(()=>{_.miniCssF=U=>"styles-"+{"151":"4c555390ff983c87e876","179":"6abb608ed7bff9f90804","212":"cae6d88a200818a456b2","329":"cffed5362661d1d49c68","497":"e738542ab6491cf1d167"}[U]+".css"})(),(()=>{_.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(U){if(typeof window=="object")return window}}()})(),(()=>{_.o=(U,O)=>Object.prototype.hasOwnProperty.call(U,O)})(),(()=>{var U={},O="tailchat-web:";_.l=(e,o,c,a)=>{if(U[e]){U[e].push(o);return}var i,N;if(c!==void 0)for(var p=document.getElementsByTagName("script"),A=0;A<p.length;A++){var L=p[A];if(L.getAttribute("src")==e||L.getAttribute("data-webpack")==O+c){i=L;break}}i||(N=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,_.nc&&i.setAttribute("nonce",_.nc),i.setAttribute("data-webpack",O+c),i.src=e),U[e]=[o];var C=(z,j)=>{i.onerror=i.onload=null,clearTimeout(Q);var S=U[e];if(delete U[e],i.parentNode&&i.parentNode.removeChild(i),S&&S.forEach(P=>P(j)),z)return z(j)},Q=setTimeout(C.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=C.bind(null,i.onerror),i.onload=C.bind(null,i.onload),N&&document.head.appendChild(i)}})(),(()=>{_.r=U=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(U,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(U,"__esModule",{value:!0})}})(),(()=>{_.nmd=U=>(U.paths=[],U.children||(U.children=[]),U)})(),(()=>{_.p="/"})(),(()=>{if(typeof _!="undefined"){var U=_.u,O=_.e,e={},o={},c=function(){return 0};_.u=function(a){var i=U(a);return i+(e.hasOwnProperty(a)?"?"+e[a]:"")},_.e=function(a){var i=O(a);return i.catch(function(N){var p=o.hasOwnProperty(a)?o[a]:2;if(p<1){var A=U(a);throw N.message="Loading chunk "+a+` failed after 2 retries.
(`+A+")",N.request=A,N}return new Promise(function(L){var C=2-p+1;setTimeout(function(){var Q="&retry-attempt="+C,z="cache-bust=true"+Q;e[a]=z,o[a]=p-1,L(_.e(a))},c(C))})})}}})(),(()=>{if(typeof document!="undefined"){var U=(c,a,i,N,p)=>{var A=document.createElement("link");A.rel="stylesheet",A.type="text/css";var L=C=>{if(A.onerror=A.onload=null,C.type==="load")N();else{var Q=C&&(C.type==="load"?"missing":C.type),z=C&&C.target&&C.target.href||a,j=new Error("Loading CSS chunk "+c+` failed.
(`+z+")");j.code="CSS_CHUNK_LOAD_FAILED",j.type=Q,j.request=z,A.parentNode.removeChild(A),p(j)}};return A.onerror=A.onload=L,A.href=a,i?i.parentNode.insertBefore(A,i.nextSibling):document.head.appendChild(A),A},O=(c,a)=>{for(var i=document.getElementsByTagName("link"),N=0;N<i.length;N++){var p=i[N],A=p.getAttribute("data-href")||p.getAttribute("href");if(p.rel==="stylesheet"&&(A===c||A===a))return p}for(var L=document.getElementsByTagName("style"),N=0;N<L.length;N++){var p=L[N],A=p.getAttribute("data-href");if(A===c||A===a)return p}},e=c=>new Promise((a,i)=>{var N=_.miniCssF(c),p=_.p+N;if(O(N,p))return a();U(c,p,null,a,i)}),o={143:0};_.f.miniCss=(c,a)=>{var i={"151":1,"179":1,"212":1,"329":1,"497":1};o[c]?a.push(o[c]):o[c]!==0&&i[c]&&a.push(o[c]=e(c).then(()=>{o[c]=0},N=>{throw delete o[c],N}))}}})(),(()=>{var U={143:0};_.f.j=(o,c)=>{var a=_.o(U,o)?U[o]:void 0;if(a!==0)if(a)c.push(a[2]);else{var i=new Promise((L,C)=>a=U[o]=[L,C]);c.push(a[2]=i);var N=_.p+_.u(o),p=new Error,A=L=>{if(_.o(U,o)&&(a=U[o],a!==0&&(U[o]=void 0),a)){var C=L&&(L.type==="load"?"missing":L.type),Q=L&&L.target&&L.target.src;p.message="Loading chunk "+o+` failed.
(`+C+": "+Q+")",p.name="ChunkLoadError",p.type=C,p.request=Q,a[1](p)}};_.l(N,A,"chunk-"+o,o)}},_.O.j=o=>U[o]===0;var O=(o,c)=>{var[a,i,N]=c,p,A,L=0;if(a.some(Q=>U[Q]!==0)){for(p in i)_.o(i,p)&&(_.m[p]=i[p]);if(N)var C=N(_)}for(o&&o(c);L<a.length;L++)A=a[L],_.o(U,A)&&U[A]&&U[A][0](),U[A]=0;return _.O(C)},e=self.webpackChunktailchat_web=self.webpackChunktailchat_web||[];e.forEach(O.bind(null,0)),e.push=O.bind(null,e.push.bind(e))})(),(()=>{_.nc=void 0})();var ar=_.O(void 0,[410,799,342],()=>_(81070));ar=_.O(ar)})();
